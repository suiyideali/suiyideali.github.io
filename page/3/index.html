<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"suiyideali.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Geek小黑板">
<meta property="og:url" content="https://suiyideali.github.io/page/3/index.html">
<meta property="og:site_name" content="Geek小黑板">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="m0ch4z">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://suiyideali.github.io/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Geek小黑板</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Geek小黑板</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/suiyideali" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://suiyideali.github.io/2023/08/24/kali-%E9%85%8D%E7%BD%AEclash/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="m0ch4z">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Geek小黑板">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/08/24/kali-%E9%85%8D%E7%BD%AEclash/" class="post-title-link" itemprop="url">kali 配置clash</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-08-24 17:36:44" itemprop="dateCreated datePublished" datetime="2023-08-24T17:36:44+08:00">2023-08-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-12-14 10:33:19" itemprop="dateModified" datetime="2023-12-14T10:33:19+08:00">2023-12-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">安全工具</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-缘由"><a href="#1-缘由" class="headerlink" title="1. 缘由"></a>1. 缘由</h2><p>因为最近想打一打HTB，但是发现国内访问HTB太慢，因此有了本篇文章并且直接解决kali科学上网。</p>
<h2 id="2-环境准备"><a href="#2-环境准备" class="headerlink" title="2. 环境准备"></a>2. 环境准备</h2><ul>
<li><p>Kali Linux（方便打靶）</p>
</li>
<li><p>Clash （需要自行下载）</p>
</li>
<li><p>openvpn （Kali自带）</p>
</li>
</ul>
<h2 id="3-解决步骤"><a href="#3-解决步骤" class="headerlink" title="3. 解决步骤"></a>3. 解决步骤</h2><h3 id="3-1-配置Clash"><a href="#3-1-配置Clash" class="headerlink" title="3.1 配置Clash"></a>3.1 配置Clash</h3><p>下载clash：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Dreamacro/clash/releases/">https://github.com/Dreamacro/clash/releases/</a></p>
<p><img src="https://ob-typora.oss-cn-shanghai.aliyuncs.com/images/202308241738747.png" alt="image-20230824163539279"></p>
<p>下载对应的版本后，给clash权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x clash</span><br></pre></td></tr></table></figure>



<p><img src="https://ob-typora.oss-cn-shanghai.aliyuncs.com/images/202308241738778.png" alt="image-20230824163744240"></p>
<p>然后启动clash，让clash自动下载和生成文件，文件的路径在 <strong>&#x2F;root&#x2F;.config&#x2F;clash</strong></p>
<p>然后删掉自动下载的配置文件，接着开始下载自己的vpn订阅</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /root/.config/clash</span><br><span class="line"><span class="built_in">rm</span> config.yaml</span><br><span class="line"><span class="built_in">rm</span> Country.mmdb</span><br><span class="line">wget -O config.yaml <span class="string">&quot;此处为你的机场订阅地址&quot;</span></span><br></pre></td></tr></table></figure>



<p>下载完毕后，然后执行clash，如果提示缺少mmdb，系统会自动下载。如果出现以下连接超时，可以自行去cdn节点下载，然后copy到 &#x2F;root&#x2F;.config&#x2F;clash 里面。</p>
<p><img src="https://ob-typora.oss-cn-shanghai.aliyuncs.com/images/202308241738786.png" alt="image-20230824164234421"></p>
<p>最终 clash执行成功，访问<a target="_blank" rel="noopener" href="http://clash.razord.top/">http://clash.razord.top</a> </p>
<p>到UI界面配置相应的节点。<img src="https://ob-typora.oss-cn-shanghai.aliyuncs.com/images/202308241738792.png" alt="image-20230824164428475"></p>
<h3 id="3-2-配置浏览器走clash代理"><a href="#3-2-配置浏览器走clash代理" class="headerlink" title="3.2 配置浏览器走clash代理"></a>3.2 配置浏览器走clash代理</h3><p>很简单，下载个插件SwitchyOmega 或者其他浏览器插件，配置好即可</p>
<p><img src="https://ob-typora.oss-cn-shanghai.aliyuncs.com/images/202308241738811.png" alt="image-20230824164537954"></p>
<p>测试验证：</p>
<p>google</p>
<p><img src="https://ob-typora.oss-cn-shanghai.aliyuncs.com/images/202308241738819.png"></p>
<p>查询当前IP</p>
<p><img src="https://ob-typora.oss-cn-shanghai.aliyuncs.com/images/202308241738170.png" alt="image-20230824164714404"></p>
<h3 id="3-3-让HTB走本地的clash代理"><a href="#3-3-让HTB走本地的clash代理" class="headerlink" title="3.3 让HTB走本地的clash代理"></a>3.3 让HTB走本地的clash代理</h3><p>已经配置好clash后，现在需要让HTB的Openvpn走本地的clash端口，只需要在HTB下载后的ovpn文件添加一条本地代理</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http-proxy 127.0.0.1 7890</span><br></pre></td></tr></table></figure>

<p><img src="https://ob-typora.oss-cn-shanghai.aliyuncs.com/images/202308241738201.png" alt="image-20230824170926608"></p>
<p>未走clash代理的延时</p>
<p><img src="https://ob-typora.oss-cn-shanghai.aliyuncs.com/images/202308241738229.png" alt="image-20230824171111352"></p>
<p>通过clash代理的延时</p>
<p><img src="https://ob-typora.oss-cn-shanghai.aliyuncs.com/images/202308241738272.png" alt="image-20230824171208521"></p>
<p>是否走clash的代理，延迟差别还是挺大的。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://suiyideali.github.io/2023/05/30/Go%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0(%E5%9B%9B)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="m0ch4z">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Geek小黑板">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/05/30/Go%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0(%E5%9B%9B)/" class="post-title-link" itemprop="url">Go语言基础学习(四)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-05-30 12:48:19" itemprop="dateCreated datePublished" datetime="2023-05-30T12:48:19+08:00">2023-05-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-08-23 18:16:41" itemprop="dateModified" datetime="2023-08-23T18:16:41+08:00">2023-08-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/code/" itemprop="url" rel="index"><span itemprop="name">code</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="range"><a href="#range" class="headerlink" title="range"></a>range</h1><p>在线程不安全的 map 中学习了 map 的遍历，里面使用了一个叫 <strong>range</strong> 的关键字来对 map 进行遍历操作。</p>
<h2 id="1-基本用法"><a href="#1-基本用法" class="headerlink" title="1. 基本用法"></a>1. 基本用法</h2><p><strong>range</strong> 可以用来遍历的对象有<strong>数组、切片、map、字符串</strong>以及<strong>通道</strong>。遍历的对象不同，<strong>range</strong> 的返回值也会有所不同。遍历数组、切片和字符串时，它返回的就是数据的<strong>索引和值</strong>。遍历map时返回的就是map的<strong>key和value</strong>。而遍历通道时则只返回<strong>通道中的数据</strong>。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	str := <span class="string">&quot;Codey&quot;</span></span><br><span class="line">	intArray := [<span class="number">5</span>]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">	intSlice := [<span class="number">5</span>]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">	m := <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;<span class="string">&quot;Apple&quot;</span>: <span class="string">&quot;苹果&quot;</span>, <span class="string">&quot;Orange&quot;</span>: <span class="string">&quot;橘子&quot;</span>, <span class="string">&quot;Bannana&quot;</span>: <span class="string">&quot;香蕉&quot;</span>&#125;</span><br><span class="line">	c := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">10</span>)</span><br><span class="line">	c &lt;- <span class="number">10</span></span><br><span class="line">	c &lt;- <span class="number">11</span></span><br><span class="line">	c &lt;- <span class="number">12</span></span><br><span class="line">	c &lt;- <span class="number">13</span></span><br><span class="line">	c &lt;- <span class="number">14</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;---字符串的遍历---&quot;</span>)</span><br><span class="line">	<span class="comment">//遍历字符串</span></span><br><span class="line">	<span class="keyword">for</span> k, v := <span class="keyword">range</span> str &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;索引: %d,值: %c\n&quot;</span>, k, v)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;---数组的遍历---&quot;</span>)</span><br><span class="line">	<span class="comment">//遍历数组</span></span><br><span class="line">	<span class="keyword">for</span> k, v := <span class="keyword">range</span> intArray &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;索引: %d,值: %d\n&quot;</span>, k, v)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;---切片的遍历---&quot;</span>)</span><br><span class="line">	<span class="comment">//遍历切片</span></span><br><span class="line">	<span class="keyword">for</span> k, v := <span class="keyword">range</span> intSlice &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;索引: %d,值: %d\n&quot;</span>, k, v)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;---map的遍历---&quot;</span>)</span><br><span class="line">	<span class="comment">//遍历map</span></span><br><span class="line">	<span class="keyword">for</span> k, v := <span class="keyword">range</span> m &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;key: %s,value: %s\n&quot;</span>, k, v)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;---通道的遍历---&quot;</span>)</span><br><span class="line">	<span class="comment">//遍历通道</span></span><br><span class="line">	<span class="keyword">for</span> v := <span class="keyword">range</span> c &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;值：%d\n&quot;</span>, v)</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(c) == <span class="number">0</span> &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">---字符串的遍历---</span><br><span class="line">索引: 0,值: C</span><br><span class="line">索引: 1,值: o</span><br><span class="line">索引: 2,值: d</span><br><span class="line">索引: 3,值: e</span><br><span class="line">索引: 4,值: y</span><br><span class="line">---数组的遍历---</span><br><span class="line">索引: 0,值: 1</span><br><span class="line">索引: 1,值: 2</span><br><span class="line">索引: 2,值: 3</span><br><span class="line">索引: 3,值: 4</span><br><span class="line">索引: 4,值: 5</span><br><span class="line">---切片的遍历---</span><br><span class="line">索引: 0,值: 1</span><br><span class="line">索引: 1,值: 2</span><br><span class="line">索引: 2,值: 3</span><br><span class="line">索引: 3,值: 4</span><br><span class="line">索引: 4,值: 5</span><br><span class="line">---map的遍历---</span><br><span class="line">key: Apple,value: 苹果</span><br><span class="line">key: Orange,value: 橘子</span><br><span class="line">key: Bannana,value: 香蕉</span><br><span class="line">---通道的遍历---</span><br><span class="line">值：10</span><br><span class="line">值：11</span><br><span class="line">值：12</span><br><span class="line">值：13</span><br><span class="line">值：14</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>若是在开发过程中只想用到遍历对象的索引或者值</strong>。可以使用<code>_</code>来接收不需要使用的值。如果是只想用索引的话，可以直接只用一个参数接收遍历对象传出的值，<strong>默认只会接收索引</strong>。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	m := <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;<span class="string">&quot;Apple&quot;</span>: <span class="string">&quot;苹果&quot;</span>, <span class="string">&quot;Orange&quot;</span>: <span class="string">&quot;橘子&quot;</span>, <span class="string">&quot;Banana&quot;</span>: <span class="string">&quot;香蕉&quot;</span>&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;---map的key值---&quot;</span>)</span><br><span class="line">	<span class="comment">//只取key</span></span><br><span class="line">	<span class="keyword">for</span> k := <span class="keyword">range</span> m &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;key:%s\n&quot;</span>, k)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;---map的value值---&quot;</span>)</span><br><span class="line">	<span class="comment">//只取value</span></span><br><span class="line">	<span class="keyword">for</span> _, v := <span class="keyword">range</span> m &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;value: %s\n&quot;</span>, v)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---map的key值---</span><br><span class="line">key:Apple</span><br><span class="line">key:Orange</span><br><span class="line">key:Banana</span><br><span class="line">---map的value值---</span><br><span class="line">value: 苹果</span><br><span class="line">value: 橘子</span><br><span class="line">value: 香蕉</span><br></pre></td></tr></table></figure>

<h2 id="2-注意事项"><a href="#2-注意事项" class="headerlink" title="2. 注意事项"></a>2. 注意事项</h2><p>在使用 range 的时候需要注意，<strong>我们无法通过range输出的值来修改遍历的对象</strong>，因为range相当于<strong>声明了两个变量</strong>，这两个变量逐一<strong>复制</strong>了遍历对象中的值，归根结底还是因为 <strong>Go 语言只有值传递，没有引用传递</strong>。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	intSlice := [<span class="number">5</span>]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 遍历切片</span></span><br><span class="line">	<span class="keyword">for</span> k, v := <span class="keyword">range</span> intSlice &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;索引: %d,索引地址: %p\n&quot;</span>, k, &amp;k)</span><br><span class="line">		fmt.Printf(<span class="string">&quot;值：%d,值地址：%p\n&quot;</span>, v, &amp;v)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">索引: 0,索引地址: 0x1400001c0a8</span><br><span class="line">值：1,值地址：0x1400001c0b0</span><br><span class="line">索引: 1,索引地址: 0x1400001c0a8</span><br><span class="line">值：2,值地址：0x1400001c0b0</span><br><span class="line">索引: 2,索引地址: 0x1400001c0a8</span><br><span class="line">值：3,值地址：0x1400001c0b0</span><br><span class="line">索引: 3,索引地址: 0x1400001c0a8</span><br><span class="line">值：4,值地址：0x1400001c0b0</span><br><span class="line">索引: 4,索引地址: 0x1400001c0a8</span><br><span class="line">值：5,值地址：0x1400001c0b0</span><br></pre></td></tr></table></figure>



<h1 id="Go-语言拓展已有类型"><a href="#Go-语言拓展已有类型" class="headerlink" title="Go 语言拓展已有类型"></a>Go 语言拓展已有类型</h1><p>在开发中，仅仅使用 Go 语言自带的变量是无法满足我们的业务需求的，就算勉强能满足，但对整个项目代码后期的维护和其可读性，都会带来很大的不便。所以几乎所有语言都支持自定义数据类型。在 Go 语言中可以使用 <strong>type</strong> 关键字自定义数据类型。</p>
<h2 id="1-自定义复杂类型"><a href="#1-自定义复杂类型" class="headerlink" title="1. 自定义复杂类型"></a>1. 自定义复杂类型</h2><p>可以使用<code>type Name Type</code>去自定义一个<strong>全新的数据类型</strong>。这个类型的变量就使用<code>Name</code>来声明。通常<strong>type</strong>用于将一个<strong>复杂的数据类型定义为一个全新的数据类型</strong>，便于后续使用。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> (  </span><br><span class="line"><span class="string">&quot;fmt&quot;</span>  </span><br><span class="line"><span class="string">&quot;reflect&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> stringList []<span class="type">string</span> <span class="comment">//自定义一个数据类型，这个数据类型为字符串切片，命名为 stringList  </span></span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">strList := stringList&#123;<span class="string">&quot;test1&quot;</span>, <span class="string">&quot;test2&quot;</span>&#125; <span class="comment">//给变量 strList 定义为 stringList 类型并赋值  </span></span><br><span class="line">fmt.Println(<span class="string">&quot;strList的数据类型: &quot;</span>, reflect.TypeOf(strList)) <span class="comment">//打印 strList 的数据类型  </span></span><br><span class="line">fmt.Println(<span class="string">&quot;strList的值: &quot;</span>, reflect.TypeOf(strList)) <span class="comment">//打印 strList 的值  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">strList的数据类型:  main.stringList</span><br><span class="line">strList的值:  main.stringList</span><br></pre></td></tr></table></figure>

<h2 id="2-别名"><a href="#2-别名" class="headerlink" title="2. 别名"></a>2. 别名</h2><p><strong>type</strong>关键字还有一种用法，就是以<strong>已经存在的数据类型</strong>进行类型自定义，这种用法就叫做<strong>别名</strong>。顾名思义，就是给已经存在的数据类型起一个新名字。常用于使用常量来开发<strong>枚举</strong>功能时。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> Grade <span class="type">int</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">const</span> (  </span><br><span class="line">FirstGrade Grade = <span class="literal">iota</span>  </span><br><span class="line">SecondGrade  </span><br><span class="line">ThirdGrade  </span><br><span class="line">FourthGrade  </span><br><span class="line">FifthGrade  </span><br><span class="line">SixthGrade  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">fmt.Println(<span class="string">&quot;FirstGrade :&quot;</span>, FirstGrade)  </span><br><span class="line">fmt.Println(<span class="string">&quot;SecondGrade :&quot;</span>, SecondGrade)  </span><br><span class="line">fmt.Println(<span class="string">&quot;ThirdGrade :&quot;</span>, ThirdGrade)  </span><br><span class="line">fmt.Println(<span class="string">&quot;FourthGrade :&quot;</span>, FourthGrade)  </span><br><span class="line">fmt.Println(<span class="string">&quot;FifthGrade :&quot;</span>, FifthGrade)  </span><br><span class="line">fmt.Println(<span class="string">&quot;SixthGrade :&quot;</span>, SixthGrade)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">FirstGrade : 0</span><br><span class="line">SecondGrade : 1</span><br><span class="line">ThirdGrade : 2</span><br><span class="line">FourthGrade : 3</span><br><span class="line">FifthGrade : 4</span><br><span class="line">SixthGrade : 5</span><br></pre></td></tr></table></figure>

<h1 id="Go-语言的结构体和“面向对象”"><a href="#Go-语言的结构体和“面向对象”" class="headerlink" title="Go 语言的结构体和“面向对象”"></a>Go 语言的结构体和“面向对象”</h1><p>Go 语言中没有明确的面向对象的概念，当然也没有明确的面向过程的概念。面向哪一方面编程完全取决于程序员如何使用，如果想要面向对象编程，Go 语言中提供了相对应的解决方案来模拟面向对象。</p>
<h2 id="1-结构体类型"><a href="#1-结构体类型" class="headerlink" title="1.  结构体类型"></a>1.  结构体类型</h2><p>想要模拟面向对象就首先要了解一下 Go 语言中的结构体类型。当需要两个以上的基本数据类型或自定义类型来声明定义函数的时候，就可以使用结构体。结构体变量使用<code>struct&#123;...&#125;</code>的形式来定义。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> (  </span><br><span class="line"><span class="string">&quot;fmt&quot;</span>  </span><br><span class="line"><span class="string">&quot;reflect&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line"><span class="keyword">var</span> student1 <span class="keyword">struct</span> &#123;  </span><br><span class="line">Name <span class="type">string</span>  </span><br><span class="line">Age <span class="type">int</span>  </span><br><span class="line">&#125;  </span><br><span class="line">student1.Name = <span class="string">&quot;Mochazz&quot;</span>  </span><br><span class="line">student1.Age = <span class="number">18</span>  </span><br><span class="line">  </span><br><span class="line">fmt.Println(<span class="string">&quot;student1数据类型: &quot;</span>, reflect.TypeOf(student1))  </span><br><span class="line">fmt.Println(<span class="string">&quot;student1的值：&quot;</span>, reflect.ValueOf(student1))  </span><br><span class="line">  </span><br><span class="line">student2 := <span class="keyword">struct</span> &#123;  </span><br><span class="line">Name <span class="type">string</span>  </span><br><span class="line">Age <span class="type">int</span>  </span><br><span class="line">&#125;&#123;  </span><br><span class="line">Name: <span class="string">&quot;Mochazz&quot;</span>,  </span><br><span class="line">Age: <span class="number">18</span>, <span class="comment">//逗号不能忘记，若是和大括号同行时逗号才能省略  </span></span><br><span class="line">&#125;  </span><br><span class="line">fmt.Println(<span class="string">&quot;student2的数据类型: &quot;</span>, reflect.TypeOf(student2))  </span><br><span class="line">fmt.Println(<span class="string">&quot;student2的值: &quot;</span>, reflect.ValueOf(student2))  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">student1数据类型:  struct &#123; Name string; Age int &#125;</span><br><span class="line">student1的值： &#123;Mochazz 18&#125;</span><br><span class="line">student2的数据类型:  struct &#123; Name string; Age int &#125;</span><br><span class="line">student2的值:  &#123;Mochazz 18&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-使用自定义类型来模拟对象"><a href="#2-使用自定义类型来模拟对象" class="headerlink" title="2. 使用自定义类型来模拟对象"></a>2. 使用自定义类型来模拟对象</h2><p>使用自定义数据类型的方式来自定义一个结构体类型，这样就可以达到定义一个对象的相同效果。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> (  </span><br><span class="line"><span class="string">&quot;fmt&quot;</span>  </span><br><span class="line"><span class="string">&quot;reflect&quot;</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123; <span class="comment">//自定义一个结构体数据类型 Student。也可以解读为，创建一个&quot;Student类&quot;  </span></span><br><span class="line">Name <span class="type">string</span>  </span><br><span class="line">Age <span class="type">int</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line"><span class="keyword">var</span> student1 Student <span class="comment">//声明一个 Student 类型的变量 student1。也可以解读为，创建一个&quot;Student对象&quot;  </span></span><br><span class="line">  </span><br><span class="line">student1.Name = <span class="string">&quot;Mochazz&quot;</span>  </span><br><span class="line">student1.Age = <span class="number">18</span>  </span><br><span class="line">  </span><br><span class="line">fmt.Println(<span class="string">&quot;student1数据类型: &quot;</span>, reflect.TypeOf(student1))  </span><br><span class="line">fmt.Println(<span class="string">&quot;student1的值：&quot;</span>, reflect.ValueOf(student1))  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">student1数据类型:  main.Student</span><br><span class="line">student1的值： &#123;Mochazz 18&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-使用函数来模拟面向对象的方法"><a href="#3-使用函数来模拟面向对象的方法" class="headerlink" title="3. 使用函数来模拟面向对象的方法"></a>3. 使用函数来模拟面向对象的方法</h2><p>Go 语言中的函数为自定义数据类型提供了一种特别的使用方式，形如<br><code>func(变量名 自定义数据类型)函数名(...)&#123;...&#125;</code>。<br>函数名前可以接收一个自定数据类型的参数，参数传递的形式为<code>自定义数据类型变量.函数名()</code>的形式传递，这样外表看起来就和面向对象编程一致了。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;  </span><br><span class="line">Name <span class="type">string</span>  </span><br><span class="line">Age <span class="type">int</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newStudent</span><span class="params">(name <span class="type">string</span>, age <span class="type">int</span>)</span></span> Student &#123;  </span><br><span class="line"><span class="keyword">return</span> Student&#123;Name: name, Age: age&#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s Student)</span></span> PrintAge() &#123; <span class="comment">//打印传入的 Student 自定义类型参数 Age 属性。也可以解读为创建一个打印学生&quot;对象&quot;年龄的&quot;方法&quot;  </span></span><br><span class="line">fmt.Println(s.Age)  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">student1 := newStudent(<span class="string">&quot;Mochazz&quot;</span>, <span class="number">18</span>)  </span><br><span class="line">student2 := newStudent(<span class="string">&quot;Moka&quot;</span>, <span class="number">19</span>)  </span><br><span class="line">fmt.Println(<span class="string">&quot;student1年龄: &quot;</span>)  </span><br><span class="line">student1.PrintAge() <span class="comment">//使用自定义类型变量 student1 为参数调用 PrintAge。也可也解读为 student1 &quot;对象&quot;调用PrintAge “方法”  </span></span><br><span class="line">fmt.Println(<span class="string">&quot;student2年龄：&quot;</span>)  </span><br><span class="line">student2.PrintAge()  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">student1年龄: </span><br><span class="line">18</span><br><span class="line">student2年龄：</span><br><span class="line">19</span><br></pre></td></tr></table></figure>

<h1 id="Go-语言中的接口"><a href="#Go-语言中的接口" class="headerlink" title="Go 语言中的接口"></a>Go 语言中的接口</h1><p>在所有编程语言中，接口都是一些<strong>方法的集合</strong>，通常都是”类”们都需要实现的一些公共方法。使这些”类”在使用过程中多了一层抽象。在使用接口时无需在意这些方法是如何实现的，只需在意这个接口中的方法本身。<br>Go 语言提倡<strong>面向接口编程</strong>，一来增强代码的可读性，二来可以使代码的模块之间的关系变得更加清晰、边界更加明显。</p>
<h2 id="1-接口的定义"><a href="#1-接口的定义" class="headerlink" title="1. 接口的定义"></a>1. 接口的定义</h2><p>在 Go 语言中，接口也是一个数据类型，该类型使用结构 <code>interface&#123;...&#125;</code> 来定义。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> stuInterface <span class="keyword">interface</span>&#123;</span><br><span class="line">    PrintAge()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上代码定义可一个接口类型的变量，其中包含的方法为 PrintAge()。</p>
<h2 id="2-接口实现"><a href="#2-接口实现" class="headerlink" title="2. 接口实现"></a>2. 接口实现</h2><p>在 Go 语言的接口中有两个非常重要的特性：</p>
<ul>
<li>只要有类<strong>实现（模拟）了接口中包含的所有方法，就称这个类型实现了这个接口</strong>；</li>
<li>只要是实现了这个接口的类型，用这个类型定义的变量就可以给这个<strong>接口声明的变量赋值</strong>。</li>
</ul>
<p>所以从以上两个特性也可以推出 <strong>interface{}</strong> 类型的变量，可以接收 <strong>任何变量的赋值</strong>。这两个特性也被称为鸭子类型，即”走起来像鸭子，叫起来像鸭子（类型模拟了接口中包含的所有方法），那么它就是一只鸭子”。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">var</span> stuInterface <span class="keyword">interface</span> &#123;  </span><br><span class="line">PrintAge()  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;  </span><br><span class="line">Name <span class="type">string</span>  </span><br><span class="line">Age <span class="type">int</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s Student)</span></span> PrintAge() &#123;  </span><br><span class="line">fmt.Println(s.Age)  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">stuInterface = Student&#123;  </span><br><span class="line">Name: <span class="string">&quot;Mochazz&quot;</span>,  </span><br><span class="line">Age: <span class="number">18</span>,  </span><br><span class="line">&#125;  </span><br><span class="line">stuInterface.PrintAge()  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">18</span><br></pre></td></tr></table></figure>

<h2 id="3-自定义接口类型"><a href="#3-自定义接口类型" class="headerlink" title="3. 自定义接口类型"></a>3. 自定义接口类型</h2><p>为了方便使用，一般都会使用自定义类型来定义一个接口类型。同时还可以写一个函数来实例化接口。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> StudentInterface <span class="keyword">interface</span> &#123;  </span><br><span class="line">PrintAge()  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;  </span><br><span class="line">Name <span class="type">string</span>  </span><br><span class="line">Age <span class="type">int</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s Student)</span></span> PrintAge() &#123;  </span><br><span class="line">fmt.Println(s.Age)  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newStudent</span><span class="params">(name <span class="type">string</span>, age <span class="type">int</span>)</span></span> StudentInterface &#123;  </span><br><span class="line"><span class="keyword">return</span> Student&#123;  </span><br><span class="line">Name: name,  </span><br><span class="line">Age: age,  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">stuInterface := newStudent(<span class="string">&quot;Mochazz&quot;</span>, <span class="number">18</span>)  </span><br><span class="line">  </span><br><span class="line">stuInterface.PrintAge()  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">18</span><br></pre></td></tr></table></figure>

<h1 id="Go-语言类型的内嵌"><a href="#Go-语言类型的内嵌" class="headerlink" title="Go 语言类型的内嵌"></a>Go 语言类型的内嵌</h1><p>在 Go 语言中的类型是可以直接内嵌到结构体中的，可以看作是一个没有属性名的属性。同时接口中也可以内嵌接口，并且只能内嵌接口。</p>
<h2 id="1-结构体内嵌类型"><a href="#1-结构体内嵌类型" class="headerlink" title="1. 结构体内嵌类型"></a>1. 结构体内嵌类型</h2><p>结构体中内嵌类型在开发中用的并不多，这只是一个延伸特性。意味着结构体在定义属性字段的时候可以只写类型，不写属性名，但是一个类型只能写一个，不然结构体会无法识别你调用的时候使用的是哪个字段，这种只写类型不写属性名的属性被称为匿名字段。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;  </span><br><span class="line">Name <span class="type">string</span>  </span><br><span class="line">Age <span class="type">int</span>  </span><br><span class="line"><span class="type">int</span>  <span class="comment">//结构体中内嵌了一个int类型</span></span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newStudent</span><span class="params">(name <span class="type">string</span>, age <span class="type">int</span>)</span></span> Student &#123;  </span><br><span class="line"><span class="keyword">return</span> Student&#123;  </span><br><span class="line">Name: name,  </span><br><span class="line">Age: age,  </span><br><span class="line"><span class="type">int</span>: <span class="number">10</span>, <span class="comment">//给匿名字段赋值的时候直接使用其字段类型即可  </span></span><br><span class="line">&#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">stu := newStudent(<span class="string">&quot;Mochazz&quot;</span>, <span class="number">18</span>)  </span><br><span class="line">fmt.Println(<span class="string">&quot;匿名字段的值: &quot;</span>, stu.<span class="type">int</span>) <span class="comment">//打印匿名字段的值  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">匿名字段的值:  10</span><br></pre></td></tr></table></figure>

<h2 id="2-结构体内嵌结构体"><a href="#2-结构体内嵌结构体" class="headerlink" title="2. 结构体内嵌结构体"></a>2. 结构体内嵌结构体</h2><p>结构体内嵌结构体是用的最多的一种内嵌方式。它有点类似于面向对向语言中的继承，但是面向对象的设计原则中最好不要有多继承。甚至于 java 这个面向对象语言的老大哥，直接就是不允许多继承的。所以 Go 语言中的内嵌结构体更好理解为组合。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> Callabale <span class="keyword">struct</span>&#123;&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Callabale)</span></span> Call() &#123;  </span><br><span class="line">fmt.Println(<span class="string">&quot;can call&quot;</span>)  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> Photographic <span class="keyword">struct</span>&#123;&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p Photographic)</span></span> Photograph() &#123;  </span><br><span class="line">fmt.Println(<span class="string">&quot;can take photos&quot;</span>)  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> Moblie <span class="keyword">struct</span> &#123;  </span><br><span class="line">Callabale  </span><br><span class="line">Photographic  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> Pad <span class="keyword">struct</span> &#123;  </span><br><span class="line">Photographic  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line"><span class="keyword">var</span> m Moblie  </span><br><span class="line">fmt.Println(<span class="string">&quot;Moble Function:&quot;</span>)  </span><br><span class="line">m.Call()  </span><br><span class="line">m.Photograph()  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">var</span> p Pad  </span><br><span class="line">fmt.Println(<span class="string">&quot;Pad Function:&quot;</span>)  </span><br><span class="line">p.Photograph()  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Moble Function:</span><br><span class="line">can call</span><br><span class="line">can take photos</span><br><span class="line">Pad Function:</span><br><span class="line">can take photos</span><br></pre></td></tr></table></figure>

<h2 id="3-接口内嵌接口"><a href="#3-接口内嵌接口" class="headerlink" title="3. 接口内嵌接口"></a>3. 接口内嵌接口</h2><p>接口内嵌接口也是一个非常实用的特性，可以使用这个功能来使同一个结构体，放在不同的接口中，而能使用的功能不同。常用的权限控制，对一个相同的数据结构，但是能操作的权限可以用接口分开。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> Reader <span class="keyword">interface</span> &#123;  </span><br><span class="line">Read()  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> Writer <span class="keyword">interface</span> &#123;  </span><br><span class="line">Write()  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> OnlyReader <span class="keyword">interface</span> &#123;  </span><br><span class="line">Reader  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> ReaderAndWriter <span class="keyword">interface</span> &#123;  </span><br><span class="line">Reader  </span><br><span class="line">Writer  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> file <span class="keyword">struct</span>&#123;&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f file)</span></span> Read() &#123;  </span><br><span class="line">fmt.Println(<span class="string">&quot;Read something&quot;</span>)  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f file)</span></span> Write() &#123;  </span><br><span class="line">fmt.Println(<span class="string">&quot;Write something&quot;</span>)  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">f := file&#123;&#125;  </span><br><span class="line"><span class="keyword">var</span> rAndW ReaderAndWriter  </span><br><span class="line">rAndW = f  </span><br><span class="line">rAndW.Read()  </span><br><span class="line">rAndW.Write()  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">var</span> onlyR OnlyReader  </span><br><span class="line">onlyR = f  </span><br><span class="line">onlyR.Read()  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Read something</span><br><span class="line">Write something</span><br><span class="line">Read something</span><br></pre></td></tr></table></figure>

<h1 id="Go-语言中的nil"><a href="#Go-语言中的nil" class="headerlink" title="Go 语言中的nil"></a>Go 语言中的nil</h1><p><strong>nil</strong> 是 Go 语言中内置的一个标识符，有人会把它当作其它语言中的NULL，这个是<strong>不准确的</strong>。</p>
<h2 id="1-nil-是特殊的零值"><a href="#1-nil-是特殊的零值" class="headerlink" title="1. nil 是特殊的零值"></a>1. nil 是特殊的零值</h2><p>在 Go 语言中，任何一个变量在声明之后会自动被<strong>赋予一个零值</strong>。数值类型的变量零值为0，字符串为””,而<strong>指针、切片、map、通道、函数和接口</strong>的零值就是nil。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line"><span class="keyword">var</span> m <span class="keyword">map</span>[<span class="type">int</span>]<span class="type">string</span>  </span><br><span class="line"><span class="keyword">var</span> p *<span class="type">int</span>  </span><br><span class="line"><span class="keyword">var</span> c <span class="keyword">chan</span> <span class="type">int</span>  </span><br><span class="line"><span class="keyword">var</span> s []<span class="type">int</span>  </span><br><span class="line"><span class="keyword">var</span> f <span class="function"><span class="keyword">func</span><span class="params">()</span></span>  </span><br><span class="line"><span class="keyword">var</span> i <span class="keyword">interface</span>&#123;&#125;  </span><br><span class="line">fmt.Printf(<span class="string">&quot;map:%#v\n&quot;</span>, m)  </span><br><span class="line">fmt.Printf(<span class="string">&quot;指针:%#v\n&quot;</span>, p)  </span><br><span class="line">fmt.Printf(<span class="string">&quot;通道:%#v\n&quot;</span>, c)  </span><br><span class="line">fmt.Printf(<span class="string">&quot;切片:%#v\n&quot;</span>, s)  </span><br><span class="line">fmt.Printf(<span class="string">&quot;函数:%#v\n&quot;</span>, f)  </span><br><span class="line">fmt.Printf(<span class="string">&quot;接口:%#v\n&quot;</span>, i)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">map:map[int]string(nil)</span><br><span class="line">指针:(*int)(nil)</span><br><span class="line">通道:(chan int)(nil)</span><br><span class="line">切片:[]int(nil)</span><br><span class="line">函数:(func())(nil)</span><br><span class="line">接口:&lt;nil&gt;</span><br></pre></td></tr></table></figure>
<h2 id="2-nil-标识符无法比较"><a href="#2-nil-标识符无法比较" class="headerlink" title="2. nil 标识符无法比较"></a>2. nil 标识符无法比较</h2><p>在 Go 语言中 <strong>nil 和 nil 之间是无法比较的</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="literal">nil</span> == <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>输出结果</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./hello.go:8:21: invalid operation: nil == nil (operator == not defined on untyped nil)</span><br></pre></td></tr></table></figure>

<h2 id="3-不同类型的的-nil-的长度不同"><a href="#3-不同类型的的-nil-的长度不同" class="headerlink" title="3. 不同类型的的 nil 的长度不同"></a>3. 不同类型的的 nil 的长度不同</h2><p>不同类型的变量的<strong>内存分配都是不同的</strong>，即使是 <strong>nil</strong> ，分配的内存也是不同的。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;unsafe&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> m <span class="keyword">map</span>[<span class="type">int</span>]<span class="type">string</span></span><br><span class="line">    <span class="keyword">var</span> p *<span class="type">int</span></span><br><span class="line">    <span class="keyword">var</span> c <span class="keyword">chan</span> <span class="type">int</span></span><br><span class="line">    <span class="keyword">var</span> s []<span class="type">int</span></span><br><span class="line">    <span class="keyword">var</span> f <span class="function"><span class="keyword">func</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">var</span> i <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">    fmt.Println(<span class="string">&quot;map:&quot;</span>, unsafe.Sizeof( m ))</span><br><span class="line">    fmt.Println(<span class="string">&quot;指针:&quot;</span>, unsafe.Sizeof(p))</span><br><span class="line">    fmt.Println(<span class="string">&quot;通道:&quot;</span>, unsafe.Sizeof(c))</span><br><span class="line">    fmt.Println(<span class="string">&quot;切片:&quot;</span>, unsafe.Sizeof(s))</span><br><span class="line">    fmt.Println(<span class="string">&quot;函数:&quot;</span>, unsafe.Sizeof(f))</span><br><span class="line">    fmt.Println(<span class="string">&quot;接口:&quot;</span>, unsafe.Sizeof(i))</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">map: 8</span><br><span class="line">指针: 8</span><br><span class="line">通道: 8</span><br><span class="line">切片: 24</span><br><span class="line">函数: 8</span><br><span class="line">接口: 16</span><br></pre></td></tr></table></figure>

<h1 id="Go-语言的函数式编程"><a href="#Go-语言的函数式编程" class="headerlink" title="Go 语言的函数式编程"></a>Go 语言的函数式编程</h1><p>函数式编程的基础特点为：</p>
<ul>
<li>函数是一等公民，即<strong>函数可以做为变量</strong>。</li>
<li>纯函数，即函数内的操作不可影响到函数外。</li>
</ul>
<p>Go 语言的函数式编程<strong>无需遵循第二点</strong>，这一特性为 Go 语言的函数式编程带来了更大的灵活性。</p>
<h2 id="1-编程示例"><a href="#1-编程示例" class="headerlink" title="1. 编程示例"></a>1. 编程示例</h2><p><strong>普通方式实现 1+2+3+…+100的值</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">a := <span class="number">0</span>  </span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt;= <span class="number">100</span>; i++ &#123;  </span><br><span class="line">a = a + i  </span><br><span class="line">&#125;  </span><br><span class="line">fmt.Println(a)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>函数式编程实现</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> iAdder <span class="function"><span class="keyword">func</span><span class="params">(<span class="type">int</span>)</span></span> <span class="type">int</span>  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">adder</span><span class="params">()</span></span> iAdder &#123;  </span><br><span class="line">sum := <span class="number">0</span>  </span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(v <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;  </span><br><span class="line">sum += v  </span><br><span class="line"><span class="keyword">return</span> sum  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">a := adder()  </span><br><span class="line"><span class="keyword">var</span> s <span class="type">int</span>  </span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt;= <span class="number">100</span>; i++ &#123;  </span><br><span class="line">s = a(i)  </span><br><span class="line">&#125;  </span><br><span class="line">fmt.Println(s)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>两者比较，后者将整个<strong>累加过程作为变量</strong>放置在了循环以外，使得整个累加可以脱离循环之外。看起来就像是不断的对一个传入的常数进行加工，就像是<strong>流水线的一个工具</strong>。所以函数式编程在开发过程中经常会用在对<strong>数据的长流程处理</strong>。例如，录入身份证号时，要从身份证号中获取年龄，籍贯、性别等信息，就可以使用三个函数对身份证号进行顺序处理。这样写的好处就在于可以随时<strong>增删其流程</strong>。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://suiyideali.github.io/2023/04/28/Go%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0(%E4%B8%89)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="m0ch4z">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Geek小黑板">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/04/28/Go%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0(%E4%B8%89)/" class="post-title-link" itemprop="url">Go语言基础学习(三)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-04-28 15:15:14" itemprop="dateCreated datePublished" datetime="2023-04-28T15:15:14+08:00">2023-04-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-05-30 12:50:02" itemprop="dateModified" datetime="2023-05-30T12:50:02+08:00">2023-05-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/code/" itemprop="url" rel="index"><span itemprop="name">code</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h1><p>Go 语言中和 C&#x2F;C++ 一样，直接提供了<strong>指针类型</strong>，但是不同的是 Go 语言的指针<strong>无法进行位移和运算</strong>的，它只是一个存储了<strong>其它变量地址的变量</strong>而已。它在 Go 语言中最大的作用就是在<strong>值传递</strong>的过程中减少内存消耗，毕竟一个地址的存储开销是十分少的。</p>
<h2 id="1-指针的定义和使用"><a href="#1-指针的定义和使用" class="headerlink" title="1. 指针的定义和使用"></a>1. 指针的定义和使用</h2><p>在 Go 语言中指针类型的声明和 C&#x2F;C++ 类似，都是采用 <code>*</code> 符号来区分正常类型变量和指针变量。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	str := <span class="string">&quot;Hello Golang!&quot;</span></span><br><span class="line">	<span class="keyword">var</span> strP *<span class="type">string</span> <span class="comment">// 使用 *+变量类型的形式声明一个 string 类型的指针</span></span><br><span class="line">	strP = &amp;str      <span class="comment">// 将指针 strP 指向变量 str，也就是将变量 str 的地址赋值给指针变量 strP 。&amp; 为取地址符，可以取出变量所在的地址。</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;未修改前变量str的值为&quot;</span>, str)</span><br><span class="line">	fmt.Println(<span class="string">&quot;未修改前变量str的地址为&quot;</span>, &amp;str)</span><br><span class="line">	*strP = <span class="string">&quot;Hello Go!&quot;</span> <span class="comment">// 通过指针修改 str 的值</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;======通过指针修改后======&quot;</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;指针strP的地址为&quot;</span>, strP)</span><br><span class="line">	fmt.Println(<span class="string">&quot;指针strP的指向地址为&quot;</span>, *strP)</span><br><span class="line">	fmt.Println(<span class="string">&quot;变量str的地址为&quot;</span>, &amp;str)</span><br><span class="line">	fmt.Println(<span class="string">&quot;变量str的值为&quot;</span>, str)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">未修改前变量str的值为 Hello Golang!</span><br><span class="line">未修改前变量str的地址为 0x14000096230</span><br><span class="line">======通过指针修改后======</span><br><span class="line">指针strP的地址为 0x14000096230</span><br><span class="line">指针strP的指向地址为 Hello Go!</span><br><span class="line">变量str的地址为 0x14000096230</span><br><span class="line">变量str的值为 Hello Go!</span><br></pre></td></tr></table></figure>

<p>变量 strP 存储的值就是变量 str 的<strong>地址</strong>，可以通过使用 *strP 操作符改变其<strong>存储的地址所存储的值</strong>。但<strong>地址</strong>是没有改变的，都是<code>0x14000096230</code></p>
<h2 id="2-指针作为函数的参数"><a href="#2-指针作为函数的参数" class="headerlink" title="2. 指针作为函数的参数"></a>2. 指针作为函数的参数</h2><p>Go 语言中<strong>只有值传递，没有引用传递</strong>，因为引用传递设计之初是为了解决函数想要有多个返回值的问题，但是 Go 语言的函数自带多返回值的返回方式。所以想要指针作为参数传入函数中，只能传递地址进入函数进行修改，并不能直接引用指针参数，这一特点就大大降低了 Go 语言指针的使用难度。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	a := <span class="number">10</span></span><br><span class="line">	b := <span class="number">20</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;交换前的a=&quot;</span>, a, <span class="string">&quot;b=&quot;</span>, b)</span><br><span class="line">	<span class="comment">// 将变量 a 和 b 的地址作为函数 swap 指针参数的值传入函数；</span></span><br><span class="line">	swap(&amp;a, &amp;b)</span><br><span class="line">	fmt.Println(<span class="string">&quot;交换后的a=&quot;</span>, a, <span class="string">&quot;b=&quot;</span>, b)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swap</span><span class="params">(a, b *<span class="type">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="comment">// 交换这两个指针保存的地址所保存的值。</span></span><br><span class="line">	*a, *b = *b, *a</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">交换前的a= 10 b= 20</span><br><span class="line">交换后的a= 20 b= 10</span><br></pre></td></tr></table></figure>



<h2 id="3-总结"><a href="#3-总结" class="headerlink" title="3. 总结"></a>3. 总结</h2><ul>
<li>Go 语言的指针<strong>不可以做偏移</strong>；</li>
<li>Go 语言的指针可以看作一个<strong>存储地址的特殊变量类型</strong>。</li>
</ul>
<h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><h2 id="1-数组的形式"><a href="#1-数组的形式" class="headerlink" title="1. 数组的形式"></a>1. 数组的形式</h2><p>数组的声明形式形如<code>var 数组名 [数组长度]数组类型</code>，其中数组类型可以是数组本身，也就是数组类型的数组，这样就构成了多维数组。和变量的声明相同，数组在声明时会初始化变量类型的<strong>零值</strong>。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> a [<span class="number">2</span>]<span class="type">int</span>         <span class="comment">// 声明一个长度为2的一维数组，自动初始化为零值</span></span><br><span class="line">	<span class="keyword">var</span> b [<span class="number">2</span>][<span class="number">2</span>]<span class="type">int</span>      <span class="comment">// 声明一个2行2列的二维数组。自动初始化为零值</span></span><br><span class="line">	<span class="keyword">var</span> c = [<span class="number">2</span>]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>&#125; <span class="comment">// 声明并定义一个长度为2，值为[1,2]的数组</span></span><br><span class="line">	<span class="keyword">var</span> d = [...]<span class="type">int</span>&#123;<span class="number">3</span>, <span class="number">4</span>&#125; <span class="comment">// 使用 ... 表示根据数组后值的长度自动初始化长度。因为后面的值是 [3,4] 数组自动初始化长度为 2</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;a的零值&quot;</span>, a)</span><br><span class="line">	fmt.Println(<span class="string">&quot;b的零值&quot;</span>, b)</span><br><span class="line">	fmt.Println(<span class="string">&quot;c的值&quot;</span>, c)</span><br><span class="line">	fmt.Println(<span class="string">&quot;d的值&quot;</span>, d)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a的零值 [0 0]</span><br><span class="line">b的零值 [[0 0] [0 0]]</span><br><span class="line">c的值 [1 2]</span><br><span class="line">d的值 [3 4]</span><br></pre></td></tr></table></figure>

<h2 id="2-数组的比较"><a href="#2-数组的比较" class="headerlink" title="2. 数组的比较"></a>2. 数组的比较</h2><p>在 Go 语言中判断数组是否相等需要比较两个部分。一个是数组的长度是否相等，另一个是数组中存放的值是否顺序和大小完全相同。只要这两个部分相等，则 Go 语言中的两个数组就是相等的。</p>
<p>⚠️：Go 语言中只有类型相同的数组才可以互相比较，且数组没有大小的比较，只能比较是否相等。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> a [<span class="number">2</span>]<span class="type">int</span></span><br><span class="line">    <span class="keyword">var</span> c = [<span class="number">2</span>]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>&#125;</span><br><span class="line">    <span class="keyword">var</span> d = [...]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>&#125;</span><br><span class="line">    fmt.Println(<span class="string">&quot;a == c ? &quot;</span>, a == c)</span><br><span class="line">    fmt.Println(<span class="string">&quot;c == d ?&quot;</span>, c == d)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a == c ?  false</span><br><span class="line">c == d ? true</span><br></pre></td></tr></table></figure>

<h1 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h1><h2 id="1-切片的创建"><a href="#1-切片的创建" class="headerlink" title="1. 切片的创建"></a>1. 切片的创建</h2><p>切片的声明方式和数组类似，写法上看就是声明一个没有长度的数组：<code>var 切片名 []切片类型</code>。其中切片类型可以是切片本身，也就是切片的切片，就构成了<strong>多维</strong>的切片。</p>
<p>切片在使用之前必须要<strong>初始化</strong>，它没有零值。声明后它的值是 <strong>nil</strong>，这是因为它的底层实现是一个指向数组的指针，在你给它存入一个数组的地址之前，它只能是 <strong>nil</strong>。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> a []<span class="type">int</span> <span class="comment">// 声明一个int类型的切片</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;初始化前: &quot;</span>, a)</span><br><span class="line">	a = <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">5</span>, <span class="number">10</span>) <span class="comment">// 声明一个长度为5，切片容量为10的切片。其中容量可以不传，默认会和长度相等。长度为切片真正有值的位置，会初始化零值</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;初始化后：&quot;</span>, a)</span><br><span class="line">	a[<span class="number">4</span>] = <span class="number">5</span> <span class="comment">// 给切片的第 5 个位置赋值</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;赋值后: &quot;</span>, a)</span><br><span class="line">	a[<span class="number">5</span>] = <span class="number">6</span> <span class="comment">// 给切片的第 6 个位置赋值，但是切片的长度为5，所以会报越界的错误</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;赋值后： &quot;</span>, a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>结果如下：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">初始化前:  []</span><br><span class="line">初始化后： [0 0 0 0 0]</span><br><span class="line">赋值后:  [0 0 0 0 5]</span><br><span class="line">panic: runtime error: index out of range [5] with length 5</span><br><span class="line"></span><br><span class="line">goroutine 1 [running]:</span><br><span class="line">main.main()</span><br><span class="line">	/Users/GolandProjects/awesomeProject/hello.go:12 +0x160</span><br></pre></td></tr></table></figure>

<h2 id="2-切片的截取"><a href="#2-切片的截取" class="headerlink" title="2. 切片的截取"></a>2. 切片的截取</h2><p>切片可以从任意长度开始切，切到任意长度为止，然后这一段拿出来就是一个新的切片。切割形式为</p>
<p><code>切片名(s)[起始下标(begin):结束下标(end):最大容量(max)]</code></p>
<p>⚠️：截取到的切片包含起始下标(begin)，不包含结束下标(end)。</p>
<p>切片截取形式表：</p>
<table>
<thead>
<tr>
<th align="left">操作</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">s[begin?max]</td>
<td align="left">截取切片s从begin到end的数据，构成一个容量为max-begin，长度为begin-end的切片。</td>
</tr>
<tr>
<td align="left">s[begin:end]</td>
<td align="left">截取切片s从begin到end的数据，构成一个容量和长度均为begin-end的切片。</td>
</tr>
<tr>
<td align="left">s[begin:]</td>
<td align="left">截取切片s从begin到最后的数据，构成一个容量和长度均为len(s)-end的切片。</td>
</tr>
<tr>
<td align="left">s[:end]</td>
<td align="left">截取切片s从0到最后的数据，构成一个容量和长度均为end-0的切片。</td>
</tr>
</tbody></table>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> a = []<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;a[1:3]=&quot;</span>, a[<span class="number">1</span>:<span class="number">3</span>])</span><br><span class="line">	fmt.Println(<span class="string">&quot;a[1:]=&quot;</span>, a[<span class="number">1</span>:])</span><br><span class="line">	fmt.Println(<span class="string">&quot;a[:3]=&quot;</span>, a[:<span class="number">3</span>])</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a[1:3]= [2 3]</span><br><span class="line">a[1:]= [2 3 4 5]</span><br><span class="line">a[:3]= [1 2 3]</span><br></pre></td></tr></table></figure>

<h2 id="3-切片的追加"><a href="#3-切片的追加" class="headerlink" title="3. 切片的追加"></a>3. 切片的追加</h2><p>切片使用一个 Go 语言的内置函数<code>append(切片，待添加的值)</code>，来进行切片末尾元素的追加。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> a = []<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">	a = <span class="built_in">append</span>(a, <span class="number">6</span>)</span><br><span class="line">	fmt.Println(a)</span><br><span class="line">	a = <span class="built_in">append</span>(a, <span class="number">7</span>, <span class="number">8</span>)</span><br><span class="line">	fmt.Println(a)</span><br><span class="line">	b := []<span class="type">int</span>&#123;<span class="number">9</span>, <span class="number">10</span>&#125;</span><br><span class="line">	a = <span class="built_in">append</span>(a, b...) <span class="comment">// 在切片的末尾追加切片，append中待添加的元素是一个数组或切片的时候，在其后面添加 ... 就可以全部追加到切片末尾</span></span><br><span class="line">	fmt.Println(a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[1 2 3 4 5 6]</span><br><span class="line">[1 2 3 4 5 6 7 8]</span><br><span class="line">[1 2 3 4 5 6 7 8 9 10]</span><br></pre></td></tr></table></figure>

<h2 id="4-切片的长度和容量"><a href="#4-切片的长度和容量" class="headerlink" title="4. 切片的长度和容量"></a>4. 切片的长度和容量</h2><p>在切片中可以使用<code>len()</code>获取切片中<strong>元素的数量</strong>，也就是切片的长度。使用<code>cap()</code>可以获取切片<strong>引用的数组的长度</strong>，也就切片的容量。切片的容量一般大于等于长度，容量会随着长度的增长而增长。</p>
<p>在初始化一个切片的时候其实时给切片引用了一个数组，然后容量就是这个数组的长度，然后如果切片的长度超过了切片的容量，它就会让切片引用一个容量更大数组来存放这些元素。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> a = []<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;a的地址%p, a的长度%d, a的容量%d\n&quot;</span>, a, <span class="built_in">len</span>(a), <span class="built_in">cap</span>(a))</span><br><span class="line">	a = <span class="built_in">append</span>(a, <span class="number">6</span>)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;a的地址%p, a的长度%d, a的容量%d\n&quot;</span>, a, <span class="built_in">len</span>(a), <span class="built_in">cap</span>(a))</span><br><span class="line">	a = <span class="built_in">append</span>(a, <span class="number">7</span>, <span class="number">8</span>)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;a的地址%p, a的长度%d, a的容量%d\n&quot;</span>, a, <span class="built_in">len</span>(a), <span class="built_in">cap</span>(a))</span><br><span class="line">	b := []<span class="type">int</span>&#123;<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>&#125;</span><br><span class="line">	a = <span class="built_in">append</span>(a, b...)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;a的地址%p, a的长度%d, a的容量%d\n&quot;</span>, a, <span class="built_in">len</span>(a), <span class="built_in">cap</span>(a))</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a的地址0x140000161b0, a的长度5, a的容量5</span><br><span class="line">a的地址0x140000181e0, a的长度6, a的容量10</span><br><span class="line">a的地址0x140000181e0, a的长度8, a的容量10</span><br><span class="line">a的地址0x14000102000, a的长度11, a的容量20</span><br></pre></td></tr></table></figure>

<p>在切片a每次添加的元素要<strong>超过它的容量</strong>时，它的地址就会发生<strong>改变</strong>，其实就是让它引用了一个新的容量更大的数组。</p>
<h1 id="Go语言中的Map"><a href="#Go语言中的Map" class="headerlink" title="Go语言中的Map"></a>Go语言中的Map</h1><p>一种元素对的无序集合，每一个**索引(key)对应一个值(value)**，这种数据结构在 Go 语言中被称之为 <strong>map</strong>。</p>
<p><strong>map</strong> 是一种能够通过<strong>索引(key)迅速找到值(value)<strong>的数据结构，所以也被称为</strong>字典</strong>。在 Go 语言中因为线程安全问题，一共实现了两种类型的 map</p>
<h2 id="1-无锁的map"><a href="#1-无锁的map" class="headerlink" title="1. 无锁的map"></a>1. 无锁的map</h2><p>这种类型的 map 是线程不安全的 map，多个线程同时访问这个类型的 map 的同一个变量时，会有读写冲突，会导致系统奔溃。所以一般在单线程程序中使用的较多。</p>
<h3 id="1-1-map的创建"><a href="#1-1-map的创建" class="headerlink" title="1.1 map的创建"></a>1.1 map的创建</h3><p>map 的底层结构也是一个指针，所以和变量不同，并不是声明后立刻能够使用。和切片相同，需要使用make()函数进行初始化。在初始化之前为空，没有零值。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> m <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>     <span class="comment">// 声明一个key为string类型，value为string类型的map变量</span></span><br><span class="line">	fmt.Println(m == <span class="literal">nil</span>)       <span class="comment">// 此时m未初始化，值为 nil</span></span><br><span class="line">	m = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>) <span class="comment">// 初始化m</span></span><br><span class="line">	fmt.Println(m == <span class="literal">nil</span>)       <span class="comment">//此时m 是一个没有存放数据的map，值不为nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">true</span><br><span class="line">false</span><br></pre></td></tr></table></figure>



<h3 id="1-2-map的赋值"><a href="#1-2-map的赋值" class="headerlink" title="1.2 map的赋值"></a>1.2 map的赋值</h3><p>map 的赋值有两种方式：</p>
<ul>
<li>使用<code>:=</code>使map在定义的时候直接赋值；</li>
<li>使用<code>map[key]=value</code>的形式对map进行赋值。</li>
</ul>
<p>在明确知道 map 的值的时候就可以使用第一种方式进行赋值，比如说在建立中英文对应关系的时候。在未知 map 的取值时，一般建议使用后者进行赋值。</p>
<p>代码示例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	m1 := <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;<span class="string">&quot;Apple&quot;</span>: <span class="string">&quot;苹果&quot;</span>, <span class="string">&quot;Orange&quot;</span>: <span class="string">&quot;橘子&quot;</span>, <span class="string">&quot;Bannana&quot;</span>: <span class="string">&quot;香蕉&quot;</span>&#125; <span class="comment">// 在m1被定义的时候直接赋值</span></span><br><span class="line">	fmt.Println(m1[<span class="string">&quot;Apple&quot;</span>])                                                <span class="comment">// 输出m1中key为&quot;Apple&quot;时对应的值</span></span><br><span class="line">	m2 := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>)                                           <span class="comment">//使用:=进行免声明make</span></span><br><span class="line">	m2[<span class="string">&quot;Apple&quot;</span>] = <span class="string">&quot;苹果&quot;</span></span><br><span class="line">	m2[<span class="string">&quot;Orange&quot;</span>] = <span class="string">&quot;橘子&quot;</span></span><br><span class="line">	m2[<span class="string">&quot;Banana&quot;</span>] = <span class="string">&quot;香蕉&quot;</span></span><br><span class="line">	fmt.Println(m2[<span class="string">&quot;Apple&quot;</span>]) <span class="comment">//输出m2中key为&quot;Apple&quot;时对应的值</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">苹果</span><br><span class="line">苹果</span><br></pre></td></tr></table></figure>

<h3 id="1-3-map的遍历"><a href="#1-3-map的遍历" class="headerlink" title="1.3 map的遍历"></a>1.3 map的遍历</h3><p>map 是字典结构，如果不清楚所有 key 的值，是无法对 map 进行遍历的，所以 Go 语言中使用了一个叫做<strong>range</strong>的关键字，配合<strong>for循环结构</strong>来对map结构进行遍历。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	m := <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;<span class="string">&quot;Apple&quot;</span>: <span class="string">&quot;苹果&quot;</span>, <span class="string">&quot;Orange&quot;</span>: <span class="string">&quot;橘子&quot;</span>, <span class="string">&quot;Bannana&quot;</span>: <span class="string">&quot;香蕉&quot;</span>&#125;</span><br><span class="line">	<span class="keyword">for</span> k, v := <span class="keyword">range</span> m &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;key:&quot;</span>, k, <span class="string">&quot;, value:&quot;</span>, v)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>⚠️：map 是无序的，所以每次输出的顺序可能会不一样。</p>
<p>输出结果</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">key: Apple , value: 苹果</span><br><span class="line">key: Orange , value: 橘子</span><br><span class="line">key: Bannana , value: 香蕉</span><br></pre></td></tr></table></figure>

<h3 id="1-4-map的删除"><a href="#1-4-map的删除" class="headerlink" title="1.4 map的删除"></a>1.4 map的删除</h3><p>map 在普通的用法中是无法移除只可以增加 key 和 value 的，所以 Go 语言中使用了一个内置函数<code>delete(map,key)</code>来移除 map 中的 key 和 value。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    m := <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;<span class="string">&quot;Apple&quot;</span>: <span class="string">&quot;苹果&quot;</span>, <span class="string">&quot;Orange&quot;</span>: <span class="string">&quot;橘子&quot;</span>, <span class="string">&quot;Banana&quot;</span>: <span class="string">&quot;香蕉&quot;</span>&#125;</span><br><span class="line">    fmt.Println(m)</span><br><span class="line">    <span class="built_in">delete</span>(m, <span class="string">&quot;Apple&quot;</span>) <span class="comment">// 删除 m 中的 “Apple” 和其对应的 value。</span></span><br><span class="line">    fmt.Println(m)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">map[Apple:苹果 Banana:香蕉 Orange:橘子]</span><br><span class="line">map[Banana:香蕉 Orange:橘子]</span><br></pre></td></tr></table></figure>

<h2 id="2-自带锁的-sync-Map"><a href="#2-自带锁的-sync-Map" class="headerlink" title="2. 自带锁的 sync.Map"></a>2. 自带锁的 sync.Map</h2><p>这种类型的 map 是线程安全的 map，多个线程同时访问这个类型的 map 的同一个变量时，不会有读写冲突，因为它自带原子锁，保障了多线程的数据安全。</p>
<h3 id="2-1-sync-Map-的创建"><a href="#2-1-sync-Map-的创建" class="headerlink" title="2.1 sync.Map 的创建"></a>2.1 sync.Map 的创建</h3><p>这种类型的 map 创建<strong>不需要make</strong>，直接声明就可以使用，而且不需要声明 map 的 key 和 value 的类型。因为它底层的实现并不是指针，是一种多个变量的聚合类型，叫做<strong>结构体</strong>。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> m sync.Map <span class="comment">//声明一个 sync.Map</span></span><br><span class="line">	fmt.Println(m) <span class="comment">//输出 m 的零值</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;0 0&#125; &#123;[] &#123;&#125; &lt;nil&gt;&#125; map[] 0&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-2-sync-Map-的操作"><a href="#2-2-sync-Map-的操作" class="headerlink" title="2.2 sync.Map 的操作"></a>2.2 sync.Map 的操作</h3><p>这个类型关于 map 的所有操作都是使用它自带的方法来实现的。<strong>包括range</strong>。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> m sync.Map         <span class="comment">//声明一个 sync.Map</span></span><br><span class="line">	m.Store(<span class="string">&quot;Apple&quot;</span>, <span class="string">&quot;苹果&quot;</span>) <span class="comment">// 使用Store 方法给m赋值</span></span><br><span class="line">	m.Store(<span class="string">&quot;Orange&quot;</span>, <span class="string">&quot;橘子&quot;</span>)</span><br><span class="line">	m.Store(<span class="string">&quot;Banana&quot;</span>, <span class="string">&quot;香蕉&quot;</span>)</span><br><span class="line">	tmp, exist := m.Load(<span class="string">&quot;Orange&quot;</span>) <span class="comment">//使用Load取出&quot;Orange&quot;对应的值，如果不存在&quot;Orange&quot;这个key，exist的值为false</span></span><br><span class="line">	fmt.Println(tmp, exist)        <span class="comment">//删除m中的&quot;Banana&quot;和其对应的value</span></span><br><span class="line"></span><br><span class="line">	m.Delete(<span class="string">&quot;Banana&quot;</span>)</span><br><span class="line">	m.Range(<span class="function"><span class="keyword">func</span><span class="params">(k, v <span class="keyword">interface</span>&#123;&#125;)</span></span> <span class="type">bool</span> &#123; <span class="comment">// 使用Range方法遍历m</span></span><br><span class="line">		fmt.Println(<span class="string">&quot;key:&quot;</span>, k, <span class="string">&quot;, value:&quot;</span>, v)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">橘子 true</span><br><span class="line">key: Apple , value: 苹果</span><br><span class="line">key: Orange , value: 橘子</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://suiyideali.github.io/2023/04/26/DNS%E5%92%8CCDN%E5%8F%8A%E5%85%B6%E7%9B%B8%E5%85%B3%E5%8E%9F%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="m0ch4z">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Geek小黑板">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/04/26/DNS%E5%92%8CCDN%E5%8F%8A%E5%85%B6%E7%9B%B8%E5%85%B3%E5%8E%9F%E7%90%86/" class="post-title-link" itemprop="url">DNS和CDN及其相关原理</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-04-26 16:53:29" itemprop="dateCreated datePublished" datetime="2023-04-26T16:53:29+08:00">2023-04-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-05-22 11:41:29" itemprop="dateModified" datetime="2023-05-22T11:41:29+08:00">2023-05-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" itemprop="url" rel="index"><span itemprop="name">计算机网络</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h2><h3 id="1-什么是DNS"><a href="#1-什么是DNS" class="headerlink" title="1. 什么是DNS"></a>1. 什么是DNS</h3><p>DNS （Domain Name System 的缩写）是一个分布式数据库，它将域名映射到与之关联的IP地址。DNS使得人们可以使用易于记忆的域名访问网站或其他网络服务，而不是使用长长的IP地址。例如，通过DNS，您可以使用”<a target="_blank" rel="noopener" href="https://cyberzone.cloud/">cyberzone.cloud</a>“而不是“185.199.111.153”来访问本博客。</p>
<p>DNS通常由域名注册商或Internet服务提供商提供。</p>
<h3 id="2-DNS查询过程"><a href="#2-DNS查询过程" class="headerlink" title="2. DNS查询过程"></a>2. DNS查询过程</h3><p>使用 <strong>dig</strong> 显示整个域名的查询过程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig mochazz.cloud</span><br></pre></td></tr></table></figure>

<p><img src="/../img/DNS%E5%92%8CCDN%E5%8F%8A%E5%85%B6%E7%9B%B8%E5%85%B3%E5%8E%9F%E7%90%86/image-20230427205517356.png" alt="ding mochazz.cloud"></p>
<p>其中：</p>
<ul>
<li><p>查询参数和统计</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; mochazz.cloud</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- <span class="string">opcode: QUERY, status: NOERROR, id: 7631</span></span><br><span class="line"><span class="string">;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 2, ADDITIONAL: 16</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>查询内容</p>
<p>查询域名 **mochazz.cloud **的A记录，即address的记录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">;; QUESTION SECTION:</span><br><span class="line">;mochazz.cloud.			IN	A</span><br></pre></td></tr></table></figure>
</li>
<li><p>DNS服务器的回答</p>
<p>询问DNS服务器后，会告诉你 <strong>mochazz.cloud</strong> 有哪些 A 记录，即哪些地址， 其中返回的600室TTL值（Time to live 的缩写），表示缓存时间，即600秒之内不用重新查询。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">;; ANSWER SECTION:</span><br><span class="line">mochazz.cloud.		600	IN	A	76.76.21.21</span><br></pre></td></tr></table></figure>
</li>
<li><p>NS记录（Name Server的缩写）</p>
<p>即返回哪些服务器负责管理 <strong>mochazz.cloud</strong>的DNS记录，显示结果有2条，向其中任一台查询就知道域名的地址了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">;; AUTHORITY SECTION:</span><br><span class="line">mochazz.cloud.		3600	IN	NS	ns4.dnsv2.com.</span><br><span class="line">mochazz.cloud.		3600	IN	NS	ns3.dnsv2.com.</span><br></pre></td></tr></table></figure>
</li>
<li><p>域名服务器地址</p>
<p>回复了两个域名服务器的地址</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">;; ADDITIONAL SECTION:</span><br><span class="line">ns3.dnsv2.com.		169800	IN	A	129.211.176.248</span><br><span class="line">ns3.dnsv2.com.		169800	IN	A	183.47.126.189</span><br><span class="line">ns3.dnsv2.com.		169800	IN	A	183.192.164.118</span><br><span class="line">ns3.dnsv2.com.		169800	IN	A	223.166.151.17</span><br><span class="line">ns3.dnsv2.com.		169800	IN	A	1.12.0.29</span><br><span class="line">ns3.dnsv2.com.		169800	IN	A	117.89.178.226</span><br><span class="line">ns4.dnsv2.com.		169658	IN	A	36.155.149.242</span><br><span class="line">ns4.dnsv2.com.		169658	IN	A	61.151.180.45</span><br><span class="line">ns4.dnsv2.com.		169658	IN	A	112.80.181.103</span><br><span class="line">ns4.dnsv2.com.		169658	IN	A	117.89.178.204</span><br><span class="line">ns4.dnsv2.com.		169658	IN	A	120.241.130.40</span><br><span class="line">ns4.dnsv2.com.		169658	IN	A	223.166.151.18</span><br><span class="line">ns4.dnsv2.com.		169658	IN	A	1.12.0.30</span><br><span class="line">ns3.dnsv2.com.		158515	IN	AAAA	2402:4e00:1430:1102:0:9136:2b2f:bf6b</span><br><span class="line">ns4.dnsv2.com.		151805	IN	AAAA	2402:4e00:1020:1264:0:9136:29bb:2f5e</span><br></pre></td></tr></table></figure>
</li>
<li><p>DNS服务器传输的信息</p>
<p>本机的DNS服务器是192.168.1.1，查询端口是53（DNS服务器的默认端口），以及回应长度是367字节。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">;; Query time: 63 msec</span><br><span class="line">;; SERVER: 192.168.1.1<span class="comment">#53(192.168.1.1)</span></span><br><span class="line">;; WHEN: Thu Apr 27 20:51:49 CST 2023</span><br><span class="line">;; MSG SIZE  rcvd: 367</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="3-域名的层级"><a href="#3-域名的层级" class="headerlink" title="3. 域名的层级"></a>3. 域名的层级</h3><p>通过查询内容可以知道</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">;; QUESTION SECTION:</span><br><span class="line">;mochazz.cloud.			IN	A</span><br></pre></td></tr></table></figure>

<p>查询的是 <strong>mochazz.cloud.</strong> 而不是 <strong>mochazz.cloud</strong> </p>
<p>根本原因是所有域名的尾部，实际上都有一个根域名，对于所有域名都是一样的，所以平时是省略的。</p>
<p>带上根域名就是 <strong>mochazz.cloud.root</strong> 和 <strong>cyberzone.cloud.root</strong></p>
<p>然后根域名的下一级为顶级域名（top-level domain，TLD）这里顶级域名为.cloud。 .com .cn都是顶级域名。</p>
<p>顶级域名的下一级就是次域名（second-level domain，缩写为SLD），这里的次域名为 .mochazz 和 .cyberzone。平时注册域名就是S LD</p>
<p>次域名的下一级就是主机名（host），比如<a target="_blank" rel="noopener" href="http://www.mochazz.cloud/">www.mochazz.cloud</a> 中主机名就是www。是用户在自己的域里面为服务器分配的名称，是用户可以任意分配的。</p>
<p>域名的层级结构为</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">主机名.次级域名.顶级域名.根域名</span><br><span class="line">host.SLD.TLD.root</span><br></pre></td></tr></table></figure>



<h3 id="4-根域名服务器"><a href="#4-根域名服务器" class="headerlink" title="4. 根域名服务器"></a>4. 根域名服务器</h3><p>DNS服务器根据域名的层级，进行分级查询。</p>
<p>需要明确的是，每一级域名都有自己的NS记录，NS记录指向该级域名的域名服务器。这些服务器知道下一级域名的各种记录。</p>
<p>所谓”分级查询”，就是从根域名开始，依次查询每一级域名的NS记录，直到查到最终的IP地址，过程大致如下</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">从&quot;根域名服务器&quot;查到&quot;顶级域名服务器&quot;的NS记录和A记录（IP地址）</span><br><span class="line">从&quot;顶级域名服务器&quot;查到&quot;次级域名服务器&quot;的NS记录和A记录（IP地址）</span><br><span class="line">从&quot;次级域名服务器&quot;查出&quot;主机名&quot;的IP地址</span><br></pre></td></tr></table></figure>



<p><img src="/../img/DNS%E5%92%8CCDN%E5%8F%8A%E5%85%B6%E7%9B%B8%E5%85%B3%E5%8E%9F%E7%90%86/image-20230427213515688.png" alt="分级查询"></p>
<p><code>dig</code>命令的<code>+trace</code>参数可以显示DNS的整个分级查询过程。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig +trace www.mochazz.cloud</span><br></pre></td></tr></table></figure>

<p><img src="/../img/DNS%E5%92%8CCDN%E5%8F%8A%E5%85%B6%E7%9B%B8%E5%85%B3%E5%8E%9F%E7%90%86/image-20230427214910938.png" alt="dig +trace www.mochazz.cloud"></p>
<ul>
<li><p>列出根域名<code>.</code>的所有NS记录，即所有根域名服务器</p>
<p>根据内置的根域名服务器IP地址，DNS服务器向所有这些IP地址发出查询请求，询问<code>mochazz.cloud</code>的顶级域名服务器<code>cloud.</code>的NS记录。最先回复的根域名服务器将被缓存，以后只向这台服务器发请求。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; +trace www.mochazz.cloud</span><br><span class="line">;; global options: +cmd</span><br><span class="line">.			21219	IN	NS	i.root-servers.net.</span><br><span class="line">.			21219	IN	NS	h.root-servers.net.</span><br><span class="line">.			21219	IN	NS	d.root-servers.net.</span><br><span class="line">.			21219	IN	NS	g.root-servers.net.</span><br><span class="line">.			21219	IN	NS	e.root-servers.net.</span><br><span class="line">.			21219	IN	NS	f.root-servers.net.</span><br><span class="line">.			21219	IN	NS	l.root-servers.net.</span><br><span class="line">.			21219	IN	NS	a.root-servers.net.</span><br><span class="line">.			21219	IN	NS	b.root-servers.net.</span><br><span class="line">.			21219	IN	NS	c.root-servers.net.</span><br><span class="line">.			21219	IN	NS	k.root-servers.net.</span><br><span class="line">.			21219	IN	NS	m.root-servers.net.</span><br><span class="line">.			21219	IN	NS	j.root-servers.net.</span><br><span class="line">;; Received 512 bytes from 192.168.1.1<span class="comment">#53(192.168.1.1) in 58 ms</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>显示<code>.cloud</code>域名的13条NS记录，同时返回的还有每一条记录对应的IP地址。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cloud.			172800	IN	NS	a.nic.cloud.</span><br><span class="line">cloud.			172800	IN	NS	b.nic.cloud.</span><br><span class="line">cloud.			172800	IN	NS	c.nic.cloud.</span><br><span class="line">cloud.			172800	IN	NS	x.nic.cloud.</span><br><span class="line">cloud.			172800	IN	NS	y.nic.cloud.</span><br><span class="line">cloud.			172800	IN	NS	z.nic.cloud.</span><br></pre></td></tr></table></figure>
</li>
<li><p>DNS服务器向这些顶级域名服务器发出查询请求，询问<code>www.mochazz.cloud</code>的次级域名<code>mochazz.cloud.</code>的NS记录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mochazz.cloud.		3600	IN	NS	ns3.dnsv2.com.</span><br><span class="line">mochazz.cloud.		3600	IN	NS	ns4.dnsv2.com.</span><br></pre></td></tr></table></figure>

<p>上面结果显示<code>mochazz.cloud.</code>有2条NS记录，同时返回的还有每一条NS记录对应的IP地址。</p>
</li>
<li><p>DNS服务器向上面这4台NS服务器查询<code>mochazz.cloud.</code>的主机名。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">www.mochazz.cloud.	600	IN	CNAME	cname.vercel-dns.com.</span><br><span class="line">mochazz.cloud.		86400	IN	NS	ns3.dnsv2.com.</span><br><span class="line">mochazz.cloud.		86400	IN	NS	ns4.dnsv2.com.</span><br><span class="line">;; Received 134 bytes from 223.166.151.18<span class="comment">#53(ns4.dnsv2.com) in 12 ms</span></span><br></pre></td></tr></table></figure>

<p>结果显示，<code>www.mochazz.cloud</code>有1条<code>CNAME</code>记录，即这CNAME 都可以访问到网站。最先返回结果的NS服务器是<code>ns4.dnsv2.com</code>，IP地址为<code>223.166.151.18</code>。</p>
</li>
</ul>
<h3 id="5-NS-记录的查询"><a href="#5-NS-记录的查询" class="headerlink" title="5. NS 记录的查询"></a>5. NS 记录的查询</h3><p><code>dig</code>命令可以单独查看每一级域名的NS记录。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig ns cloud</span><br></pre></td></tr></table></figure>

<p><code>+short</code>参数可以显示简化的结果。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig +short www.mochazz.cloud</span><br></pre></td></tr></table></figure>

<h3 id="6-DNS的记录类型"><a href="#6-DNS的记录类型" class="headerlink" title="6. DNS的记录类型"></a>6. DNS的记录类型</h3><p>域名与IP之间的对应关系，称为”记录”（record）。根据使用场景，”记录”可以分成不同的类型（type）。</p>
<p>常见的DNS记录类型如下：</p>
<ol>
<li><code>A</code>：地址记录（Address），返回域名指向的IP地址。</li>
<li><code>CNAME</code>：规范名称记录（Canonical Name），返回另一个域名，即当前查询的域名是另一个域名的跳转。</li>
<li><code>NS</code>：域名服务器记录（Name Server），返回保存下一级域名信息的服务器地址。该记录只能设置为域名，不能设置为IP地址。</li>
<li><code>MX</code>：邮件记录（Mail eXchange），返回接收电子邮件的服务器地址。</li>
<li><code>PTR</code>：逆向查询记录（Pointer Record），只用于从IP地址查询域名</li>
</ol>
<p><code>CNAME</code>记录主要用于域名的内部跳转，为服务器配置提供灵活性，用户感知不到。</p>
<p>比如:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">╰─$ dig www.mochazz.cloud</span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; www.mochazz.cloud</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- <span class="string">opcode: QUERY, status: NOERROR, id: 28264</span></span><br><span class="line"><span class="string">;; flags: qr rd ra; QUERY: 1, ANSWER: 3, AUTHORITY: 0, ADDITIONAL: 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; OPT PSEUDOSECTION:</span></span><br><span class="line"><span class="string">; EDNS: version: 0, flags:; udp: 4096</span></span><br><span class="line"><span class="string">;; QUESTION SECTION:</span></span><br><span class="line"><span class="string">;www.mochazz.cloud.		IN	A</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; ANSWER SECTION:</span></span><br><span class="line"><span class="string">www.mochazz.cloud.	600	IN	CNAME	cname.vercel-dns.com.</span></span><br><span class="line"><span class="string">cname.vercel-dns.com.	600	IN	A	76.76.21.98</span></span><br><span class="line"><span class="string">cname.vercel-dns.com.	600	IN	A	76.76.21.61</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<p>结果显示，<code>www.mochazz.cloud</code>的CNAME记录指向<code>cname.vercel-dns.com</code>。也就是说，用户查询<code>www.mochazz.cloud</code>的时候，实际上返回的是<code>cname.vercel-dns.com</code>的IP地址。这样的好处是，变更服务器IP地址的时候，只要修改<code>cname.vercel-dns.com</code>这个域名就可以了，用户的<code>www.mochazz.cloud</code>域名不用修改。</p>
<p>由于<code>CNAME</code>记录就是一个替换，所以域名一旦设置<code>CNAME</code>记录以后，就不能再设置其他记录了（比如<code>A</code>记录和<code>MX</code>记录），这是为了防止产生冲突。举例来说，<code>foo.com</code>指向<code>bar.com</code>，而两个域名各有自己的<code>MX</code>记录，如果两者不一致，就会产生问题。由于顶级域名通常要设置<code>MX</code>记录，所以一般不允许用户对顶级域名设置<code>CNAME</code>记录。</p>
<p><code>PTR</code>记录用于从IP地址反查域名。<code>dig</code>命令的<code>-x</code>参数用于查询<code>PTR</code>记录。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">╰─$ dig -x 185.199.111.153</span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; -x 185.199.111.153</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- <span class="string">opcode: QUERY, status: NOERROR, id: 38751</span></span><br><span class="line"><span class="string">;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; QUESTION SECTION:</span></span><br><span class="line"><span class="string">;153.111.199.185.in-addr.arpa.	IN	PTR</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; ANSWER SECTION:</span></span><br><span class="line"><span class="string">153.111.199.185.in-addr.arpa. 3497 IN	PTR	cdn-185-199-111-153.github.com.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; Query time: 54 msec</span></span><br><span class="line"><span class="string">;; SERVER: 192.168.1.1#53(192.168.1.1)</span></span><br><span class="line"><span class="string">;; WHEN: Thu Apr 27 22:02:13 CST 2023</span></span><br><span class="line"><span class="string">;; MSG SIZE  rcvd: 90</span></span><br></pre></td></tr></table></figure>

<p>上面结果显示，<code>153.111.199.185</code>这台服务器的域名是<code>cdn-185-199-111-153.github.com</code>。</p>
<h3 id="7-其他DNS工具"><a href="#7-其他DNS工具" class="headerlink" title="7. 其他DNS工具"></a>7. 其他DNS工具</h3><ul>
<li><p><strong>host 命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">╰─$ host baidu.com</span><br><span class="line">baidu.com has address 110.242.68.66</span><br><span class="line">baidu.com has address 39.156.66.10</span><br><span class="line">baidu.com mail is handled by 20 usmx01.baidu.com.</span><br><span class="line">baidu.com mail is handled by 20 mx1.baidu.com.</span><br><span class="line">baidu.com mail is handled by 15 mx.n.shifen.com.</span><br><span class="line">baidu.com mail is handled by 20 jpmx.baidu.com.</span><br><span class="line">baidu.com mail is handled by 10 mx.maillb.baidu.com.</span><br><span class="line">baidu.com mail is handled by 20 mx50.baidu.com.</span><br></pre></td></tr></table></figure>

<p><code>host</code>命令也可以用于逆向查询，即从IP地址查询域名，等同于<code>dig -x &lt;ip&gt;</code>。</p>
</li>
<li><p><code>nslookup</code></p>
<p>用于互动式地查询域名记录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">╰─$ nslookup cyberzone.cloud                                                                                                1 ↵</span><br><span class="line">Server:		192.168.1.1</span><br><span class="line">Address:	192.168.1.1<span class="comment">#53</span></span><br><span class="line"></span><br><span class="line">Non-authoritative answer:</span><br><span class="line">Name:	cyberzone.cloud</span><br><span class="line">Address: 185.199.110.153</span><br><span class="line">Name:	cyberzone.cloud</span><br><span class="line">Address: 185.199.111.153</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>whois</code></p>
<p>用来查看域名的注册情况</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whois cyberzone.cloud</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="CND"><a href="#CND" class="headerlink" title="CND"></a>CND</h2><h3 id="1-什么是CND"><a href="#1-什么是CND" class="headerlink" title="1. 什么是CND"></a>1. 什么是CND</h3><p>CDN全称叫做“Content Delivery Network”，中文叫<strong>内容分发网络</strong>。</p>
<p>将源站内容分发至最接近用户的节点，使用户可就近取得所需内容，提高用户访问的响应速度和成功率。解决因分布、带宽、服务器性能带来的访问延迟问题，适用于站点加速、点播、直播等场景。</p>
<h3 id="2-原理分析"><a href="#2-原理分析" class="headerlink" title="2. 原理分析"></a>2. 原理分析</h3><p>如图</p>
<p><img src="/../img/DNS%E5%92%8CCDN%E5%8F%8A%E5%85%B6%E7%9B%B8%E5%85%B3%E5%8E%9F%E7%90%86/image-20230505222258753.png" alt="CDN简单原理图"></p>
<p>通过域名解析IP分析</p>
<ol>
<li>当用户点击网站页面上的内容URL，经过本地DNS系统解析，DNS 系统会最终将域名的解析权交给 <a href="https://link.zhihu.com/?target=https://en.wikipedia.org/wiki/CNAME_record">CNAME</a> 指向的 CDN 专用 DNS 服务器。</li>
<li>CDN 的 DNS 服务器将 CDN 的全局负载均衡设备 IP 地址返回用户。</li>
<li>用户向 CDN 的全局负载均衡设备发起内容 URL 访问请求。</li>
<li>CDN 全局负载均衡设备根据用户 IP 地址，以及用户请求的内容URL，选择一台用户所属区域的区域负载均衡设备，告诉用户向这台设备发起请求。</li>
<li>基于以下这些条件的综合分析之后，区域负载均衡设备会向全局负载均衡设备返回一台缓存服务器的IP地址：</li>
<li>根据用户 IP 地址，判断哪一台服务器距用户最近；</li>
<li>根据用户所请求的 URL 中携带的内容名称，判断哪一台服务器上有用户所需内容；</li>
<li>查询各个服务器当前的负载情况，判断哪一台服务器尚有服务能力。</li>
<li>全局负载均衡设备把服务器的 IP 地址返回给用户。</li>
<li>用户向缓存服务器发起请求，缓存服务器响应用户请求，将用户所需内容传送到用户终端。如果这台缓存服务器上并没有用户想要的内容，而区域均衡设备依然将它分配给了用户，那么这台服务器就要向它的上一级缓存服务器请求内容，直至追溯到网站的源服务器将内容拉到本地。</li>
</ol>
<p>DNS 服务器根据用户 IP 地址，将域名解析成相应节点的缓存服务器IP地址，实现用户就近访问。使用 CDN 服务的网站，只需将其域名解析权交给 CDN 的全局负载均衡（GSLB）设备，将需要分发的内容注入 CDN，就可以实现内容加速了。</p>
<h2 id="rDNS"><a href="#rDNS" class="headerlink" title="rDNS"></a>rDNS</h2><h3 id="1-反向DNS"><a href="#1-反向DNS" class="headerlink" title="1. 反向DNS"></a>1. 反向DNS</h3><p>在<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C">计算机网络</a>中，<strong>反向DNS查找</strong>或<strong>反向DNS解析</strong>（rDNS）是查询域名系统（DNS）来确定IP地址关联的域名的技术——通常的“转发”的反向DNS查找域名的IP地址。反向DNS查询的过程使用<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/w/index.php?title=PTR%E8%AE%B0%E5%BD%95&action=edit&redlink=1">PTR记录</a>。互联网的反向DNS数据库植根于 .arpa 顶级域名。</p>
<p>反向DNS（rDNS或RDNS）是从IP地址查找域名的域名服务（DNS）。 常规的DNS请求将解析给定域名的IP地址； 因此名称为“reverse”。</p>
<h3 id="2-rDNS的作用"><a href="#2-rDNS的作用" class="headerlink" title="2. rDNS的作用"></a>2. rDNS的作用</h3><p>rDNS主要用于确保邮件交换记录的有效性，用于拦截邮件服务系统中的垃圾邮件。</p>
<p>一般情况下，垃圾邮件发送者使用动态分配的 IP 地址或者没有注册域名的 IP 地址来发送垃圾邮件，通过反向解析可以判断邮件的合法性。当邮件服务器收到邮件时，邮件服务器会查看邮件由哪个 IP 地址发出，然后根据这个 IP 地址进行反向解析，如果反向解析得到的域名与发送方邮件的域名不一致则认为邮件发送者不是从真正的邮件服务器发出，则可以拒绝接收此邮件。</p>
<p>比如当 <code>me@qq.com</code> 收到一份来自 <code>fake@163.com</code> 的邮件时，qq邮件服务器会查看邮件来源的 IP，根据 IP 进行反向解析，如果解析到的域名和 <code>163.com</code> 一致，则接收邮件，否则认为邮件来源 IP 伪造成了163服务器 IP ，则拒绝这封邮件。</p>
<h3 id="3-rDNS过程"><a href="#3-rDNS过程" class="headerlink" title="3. rDNS过程"></a>3. rDNS过程</h3><p>由于正向 DNS 将主机名映射到 IP 地址，因此 rDNS 将服务器 IP 地址映射回主机名。使用 rDNS，可以将 IP 地址反转，然后将<code>in-addr.arpa</code>添加到末尾。这种 IP 地址进行反向 DNS 解析的方法用到的是 PTR 记录。</p>
<p>使用dig 执行<code>rDNS</code>查找</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig  -x 185.199.110.153</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; -x 185.199.110.153</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- <span class="string">opcode: QUERY, status: NOERROR, id: 19917</span></span><br><span class="line"><span class="string">;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; QUESTION SECTION:</span></span><br><span class="line"><span class="string">;153.110.199.185.in-addr.arpa.	IN	PTR</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; ANSWER SECTION:</span></span><br><span class="line"><span class="string">153.110.199.185.in-addr.arpa. 3330 IN	PTR	cdn-185-199-110-153.github.com.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; Query time: 101 msec</span></span><br><span class="line"><span class="string">;; SERVER: 192.168.1.1#53(192.168.1.1)</span></span><br><span class="line"><span class="string">;; WHEN: Sat May 13 21:57:19 CST 2023</span></span><br><span class="line"><span class="string">;; MSG SIZE  rcvd: 90</span></span><br></pre></td></tr></table></figure>

<p>可以在<strong>ANSWER SECTION</strong>看到完整的rDNS PTR记录的IP，返回子域名<code>cdn-185-199-110-153.github.com.</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">153.110.199.185.in-addr.arpa. 3330 IN	PTR	cdn-185-199-110-153.github.com.</span><br></pre></td></tr></table></figure>



<h2 id="相关的安全攻击"><a href="#相关的安全攻击" class="headerlink" title="相关的安全攻击"></a>相关的安全攻击</h2><h3 id="1-域前置（Domain-Fronting）"><a href="#1-域前置（Domain-Fronting）" class="headerlink" title="1. 域前置（Domain Fronting）"></a>1. 域前置（Domain Fronting）</h3><h4 id="1-1-什么是域前置"><a href="#1-1-什么是域前置" class="headerlink" title="1.1 什么是域前置"></a>1.1 什么是域前置</h4><p>Domain Fronting，中文译名 “域前置” 或 “域名前置”，是一种用于隐藏真实C2服务器IP且同时能伪装为与高信誉域名通信的技术，多用于木马受控端和控制端之间的隐蔽通信。</p>
<p>这种举动在被封锁的站点与无害站点为同一个大型服务提供商时较为可行，例如由<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/CDN">内容分发网络</a>提供的服务。此时审查者通常很难区分被伪装流量与合法流量的特点，迫使审查者选择放行所有看似无害的流量，或者选择彻底封锁此域的流量。而彻底封锁可能带来显著的附加损害。</p>
<p>简言之，利用该技术，可以让受控端以为程序是在和一个高信誉域名通信，但实际上却是在和C2服务器进行通信。</p>
<h4 id="1-2-技术原理"><a href="#1-2-技术原理" class="headerlink" title="1.2 技术原理"></a>1.2 技术原理</h4><p>Domain Fronting 的技术原理图如下</p>
<p><img src="/../img/DNS%E5%92%8CCDN%E5%8F%8A%E5%85%B6%E7%9B%B8%E5%85%B3%E5%8E%9F%E7%90%86/image-20230513221125910.png" alt="域前置技术原理"></p>
<p>Domain Fronting 的核心技术是 <code>CDN</code>。</p>
<p>一般情况下，1台 CDN 会同时负责多个网站的加速服务。</p>
<p>如果访问的两个网站（a.com 和 b.com）都是由同1台 CDN 服务器（1.1.1.1）进行加速服务，那么当使用浏览器访问这两个域名时，浏览器实际上访问的都是 1.1.1.1 这台 CDN 服务器，但是在浏览器访问的域名有可能是 a.com 也可能是 b.com，所以必须要在和 1.1.1.1 这台 CDN 服务器通信时，在 HTTP 请求包的 Host 头中填入需要访问的域名，CDN 才会知道访问的是哪一个域名后才能返回对应域名的内容。</p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/113037678">https://zhuanlan.zhihu.com/p/113037678</a></p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/195011">https://www.anquanke.com/post/id/195011</a></p>
<p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-sg/%E5%9F%9F%E5%89%8D%E7%BD%AE">https://zh.wikipedia.org/zh-sg/域前置</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ConfusedChenSir/articles/16201785.html">https://www.cnblogs.com/ConfusedChenSir/articles/16201785.html</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://suiyideali.github.io/2023/04/25/Python%E5%B8%B8%E7%94%A8%E6%A0%87%E5%87%86%E5%BA%93%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="m0ch4z">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Geek小黑板">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/04/25/Python%E5%B8%B8%E7%94%A8%E6%A0%87%E5%87%86%E5%BA%93%E5%AD%A6%E4%B9%A0/" class="post-title-link" itemprop="url">Python常用标准库学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-04-25 20:59:03" itemprop="dateCreated datePublished" datetime="2023-04-25T20:59:03+08:00">2023-04-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-04-27 22:41:10" itemprop="dateModified" datetime="2023-04-27T22:41:10+08:00">2023-04-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/code/" itemprop="url" rel="index"><span itemprop="name">code</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Python常用标准库的学习，随手做下笔记</p>
<h2 id="sys-模块"><a href="#sys-模块" class="headerlink" title="sys 模块"></a>sys 模块</h2><h3 id="1-sys-exit-code"><a href="#1-sys-exit-code" class="headerlink" title="1. sys.exit(code)"></a>1. sys.exit(code)</h3><p>sys.exit(code) 的功能是退出程序。</p>
<ul>
<li>参数 code，退出代码，通常 0 代表正常退出，其它值代码异常退出</li>
<li>返回值，无</li>
</ul>
<p>演示 sys.exit(code) 的例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">sys.exit(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;world&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>程序打印 hello 后即退出了，不会执行下一条语句 print(‘world’)。</p>
<h3 id="2-sys-argv"><a href="#2-sys-argv" class="headerlink" title="2. sys.argv"></a>2. sys.argv</h3><h4 id="2-1-命令行参数"><a href="#2-1-命令行参数" class="headerlink" title="2.1 命令行参数"></a>2.1 命令行参数</h4><p>在 windows 和 linux 中，操作系统提供了命令行的控制方式，用户输入命令完成任务。例如，建立一个目录，输入如下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\&gt; <span class="built_in">mkdir</span> <span class="built_in">test</span></span><br></pre></td></tr></table></figure>

<p>这条命令创建了一个名称为 test 的目录，字符串 ‘mkdir’ 和字符串 ‘test’ 被称为命令行参数。</p>
<h4 id="2-2-Python-程序的命令行参数"><a href="#2-2-Python-程序的命令行参数" class="headerlink" title="2.2  Python 程序的命令行参数"></a>2.2  Python 程序的命令行参数</h4><p>Python 将命令行参数保存在 sys 模块中的 argv 变量中：</p>
<ul>
<li>sys.argv 是一个数组</li>
<li>数组中存储的是字符串</li>
</ul>
<p>在命令行模式下，使用 python 解释器执行程序 <a target="_blank" rel="noopener" href="http://program.py/">program.py</a>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\&gt; python program.py argument</span><br></pre></td></tr></table></figure>

<p>则命令行参数 sys.argv 等于 [‘<a target="_blank" rel="noopener" href="http://program.py/">program.py</a>’, ‘argument’]，注意：</p>
<ul>
<li>输入的命令行由 3 个单词构成，但是命令行参数不包括 ‘python’</li>
<li>命令行参数包括 python 程序文件名，即 ‘<a target="_blank" rel="noopener" href="http://program.py/">program.py</a>’</li>
</ul>
<h5 id="sys-argv"><a href="#sys-argv" class="headerlink" title="sys.argv"></a>sys.argv</h5><p>以列表的方式获取运行 python 程序的命令行参数，其中， sys.argv[0] 通常指该 python程序本身， sys.argv[1] 代表第一个参数， sys.argv[2] 代表第二个参数，以此类推</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start</span>(<span class="params">argv</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(argv) &lt; <span class="number">4</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;请提供三个参数&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;程序名:<span class="subst">&#123;argv[<span class="number">0</span>]&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;第一个参数:<span class="subst">&#123;argv[<span class="number">1</span>]&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;第二个参数:<span class="subst">&#123;argv[<span class="number">2</span>]&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;第三个参数:<span class="subst">&#123;argv[<span class="number">3</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        start(sys.argv[<span class="number">0</span>:])</span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;interrupted by user, killing all threads&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="3-标准输入、标准输出、标准出错"><a href="#3-标准输入、标准输出、标准出错" class="headerlink" title="3. 标准输入、标准输出、标准出错"></a>3. 标准输入、标准输出、标准出错</h3><h4 id="3-1-概述"><a href="#3-1-概述" class="headerlink" title="3.1 概述"></a>3.1 概述</h4><p>Python 程序将键盘抽象成一个可读的文件，从键盘读取用户输入，类似于从文件中读取数据；Python 程序将屏幕抽象成一个可写的文件，向屏幕输出数据，类似于向文件中写数据。</p>
<p>Python 程序执行时会自动打开三个文件：</p>
<ul>
<li>标准输入文件（stdin），通常对应终端的键盘</li>
<li>标准输出文件（stdout），对应终端的屏幕</li>
<li>标准错误输出文件（stderr），对应终端的屏幕</li>
</ul>
<p>程序将从标准输入文件读取用户输入，将正常输出数据输出到标准输出文件，而将错误信息输出到标准错误文件。</p>
<h4 id="3-2-sys-stdin"><a href="#3-2-sys-stdin" class="headerlink" title="3.2 sys.stdin"></a>3.2 sys.stdin</h4><p>sys.stdin 是 python 程序的标准输入</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">line = sys.stdin.readline()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;你输入的为<span class="subst">&#123;line&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/../img/Python%E5%B8%B8%E7%94%A8%E6%A0%87%E5%87%86%E5%BA%93%E5%AD%A6%E4%B9%A0/image-20230425211722586.png" alt="sys.stdin"></p>
<h4 id="3-3-sys-stdout"><a href="#3-3-sys-stdout" class="headerlink" title="3.3 sys.stdout"></a>3.3 sys.stdout</h4><p>sys.stdout 是 python 程序的标准输出</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">sys.stdout.write(<span class="string">&#x27;这是&#x27;</span>)</span><br><span class="line">sys.stdout.write(<span class="string">&#x27;python标准库的&#x27;</span>)</span><br><span class="line">sys.stdout.write(<span class="string">&#x27;sys模块&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果为</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这是python标准库的sys模块</span><br></pre></td></tr></table></figure>

<p>从输出可以看出，sys.stdout.write(text) 和 print(text) 的区别：</p>
<ul>
<li>print(text) 输出 text 后会自动换行</li>
<li><strong>sys.stdout.write(text) 输出 text 后不会自动换行</strong></li>
</ul>
<h4 id="3-4-sys-stderr"><a href="#3-4-sys-stderr" class="headerlink" title="3.4 sys.stderr"></a>3.4 sys.stderr</h4><p>sys.stderr 是 python 程序的标准出错，与 sys.stdout 相比：</p>
<ul>
<li>两者都是将数据输出到屏幕</li>
<li>将正常的信息输出到 sys.stdout</li>
<li>将错误的信息输出到 sys.stderr</li>
</ul>
<h4 id="3-5-打印下载速度"><a href="#3-5-打印下载速度" class="headerlink" title="3.5 打印下载速度"></a>3.5 打印下载速度</h4><p>Python 中的内置函数 print(text) 会自动的加入换行，而在某些场景下，不希望输出换行</p>
<p>程序在运行的过程中，断断续续的输出如下文本：</p>
<ul>
<li>Downloading 1%</li>
<li>Downloading 2%</li>
<li>…</li>
<li>Downloading 100%</li>
</ul>
<p>如果使用 print(text)，就会输出 100 行，无法达到上图的效果。</p>
<p>使用 sys.stdout.write(text) 可以控制程序输出在同一行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> rate <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>): <span class="comment"># 使用for循环模拟下载的过程，总共输出100行文本</span></span><br><span class="line">    text = <span class="string">&#x27;Downloading %d%%&#x27;</span> % rate</span><br><span class="line">    sys.stdout.write(text)  <span class="comment"># 打印当前下载的速度</span></span><br><span class="line">    sys.stdout.write(<span class="string">&#x27;\r&#x27;</span>)  <span class="comment"># 输出&#x27;\r&#x27;， 将光标移动到行首， 仅仅输出一个字符&#x27;\r&#x27;，不会在额外输出换行</span></span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h3 id="4-sys-path"><a href="#4-sys-path" class="headerlink" title="4. sys.path"></a>4. sys.path</h3><p>Python 的模块是一个普通的 Python 文件，例如 os 模块对应的文件是 os.py。os 模块是 Python 自带的模块，如果 Python 安装到 C:\Python3 目录下，在 C:\Python3\Lib 目录下能找到 os.py，即 os.py 的完整路径是 C:\Python3\Lib\os.py</p>
<p><strong>sys.path 是一个列表，列表保存了多个路径名</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(sys.path)</span><br></pre></td></tr></table></figure>

<p>Python 使用 ‘import os’ 引入 os 模块，注意：<strong>Python 使用模块名而不是模块的完整路径引入模块</strong>。</p>
<p>Python 查找模块 os 的过程如下：</p>
<ul>
<li>在 sys.path[0] 指向的目录 C:\Python3\DLLs 下查找文件 <a target="_blank" rel="noopener" href="http://os.py/">os.py</a></li>
<li>在 sys.path[1] 指向的目录 C:\Python3\lib 下查找文件 <a target="_blank" rel="noopener" href="http://os.py/">os.py</a></li>
<li>…</li>
</ul>
<h3 id="5-sys-version"><a href="#5-sys-version" class="headerlink" title="5. sys.version"></a>5. sys.version</h3><p>sys.version 记录了 Python 的版本</p>
<h3 id="6-sys-platform"><a href="#6-sys-platform" class="headerlink" title="6. sys.platform"></a>6. sys.platform</h3><p>sys.version 记录了操作系统的型号。</p>
<h2 id="getopt模块"><a href="#getopt模块" class="headerlink" title="getopt模块"></a>getopt模块</h2><h3 id="1-命令行参数"><a href="#1-命令行参数" class="headerlink" title="1. 命令行参数"></a>1. 命令行参数</h3><p>Python 提供了 <strong>getopt</strong> 模块来获取命令行参数。</p>
<p>getopt 语法格式如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getopt.getopt(args, options[, long_options])</span><br></pre></td></tr></table></figure>

<p>getopt 是对 sys.argv获取的命令行参数进行二次处理。在运行程序的时候，可能需要根据不同的条件，输入不同的命令行选项来实现不同的功能，比如-u代表后面是用户，-p代表后面是密码。调用getopt.getopt()会返回两个列表，第一个列表复制给opts，第二个列表复制给args。</p>
<ul>
<li><p><strong>args</strong>: 要解析的命令行参数列表。</p>
</li>
<li><p><strong>options</strong>: 以字符串的格式定义，<strong>options</strong> 后的冒号 <strong>:</strong> 表示该选项必须有附加的参数，不带冒号表示该选项不附加参数。</p>
</li>
<li><p><strong>long_options</strong>: 以列表的格式定义，<strong>long_options</strong> 后的等号 <strong>&#x3D;</strong> 表示如果设置该选项，必须有附加的参数，否则就不附加参数。</p>
<p>该方法返回值由两个元素组成: 第一个是 <strong>(option, value)</strong> 元组的列表。 第二个是参数列表，包含那些没有 <strong>-</strong> 或 <strong>–</strong> 的参数。</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> getopt</span><br><span class="line"></span><br><span class="line">opts, args = getopt.getopt(sys.argv[<span class="number">1</span>:], <span class="string">&quot;u:p:&quot;</span>, [<span class="string">&quot;file=&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;opts输出结果为<span class="subst">&#123;opts&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;args输出结果为<span class="subst">&#123;args&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 demo.py -u user -p password  --file=demo.txt hello,python</span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">opts输出结果为[(&#x27;-u&#x27;, &#x27;user&#x27;), (&#x27;-p&#x27;, &#x27;password&#x27;), (&#x27;--file&#x27;, &#x27;demo.txt&#x27;)]</span><br><span class="line">args输出结果为[&#x27;hello,python&#x27;]</span><br></pre></td></tr></table></figure>



<p>➡ 使用<strong>sys.gray[1:]</strong> 是为过滤第一个参数（第一个参数为python本身）</p>
<p>➡ “-u:-h” 为定义短格式选项 （ - ）。这里的h 和 u 为两个选项。 “h” 后面没有 “:” 表示h这个选项没有选项值， “u”后面有”:” 就必须有选项值</p>
<p>➡ [“help”, “file&#x3D;”] 为定义长格式选项 （–）。这里的 “&#x3D;” 和短格式选项中的 “:” 一样，后面必须跟选项值</p>
<h3 id="2-示例"><a href="#2-示例" class="headerlink" title="2. 示例"></a>2. 示例</h3><h4 id="2-1-短选项模式"><a href="#2-1-短选项模式" class="headerlink" title="2.1 短选项模式"></a>2.1 短选项模式</h4><p>定义一个 site() 函数，然后通过命令行输入站点名称 <strong>name</strong> 和网址 <strong>url</strong>，可以用缩写 <strong>n</strong> 和 <strong>u</strong>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> getopt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">site</span>():</span><br><span class="line">    name = <span class="literal">None</span></span><br><span class="line">    url = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    argv = sys.argv[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 短选项模式</span></span><br><span class="line">        opts, args = getopt.getopt(argv, <span class="string">&quot;n:u:&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Error&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> opt, arg <span class="keyword">in</span> opts:</span><br><span class="line">        <span class="keyword">if</span> opt <span class="keyword">in</span> [<span class="string">&#x27;-n&#x27;</span>]:</span><br><span class="line">            name = arg</span><br><span class="line">        <span class="keyword">elif</span> opt <span class="keyword">in</span> [<span class="string">&#x27;-u&#x27;</span>]:</span><br><span class="line">            url = arg</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>( name + <span class="string">&quot; &quot;</span> + url)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">site()</span><br></pre></td></tr></table></figure>

<p>测试代码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 demo.py -n mochazz -u cyberzone.cloud</span><br></pre></td></tr></table></figure>

<p>输出结果为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mochazz cyberzone.cloud</span><br></pre></td></tr></table></figure>

<h4 id="2-2-长选项模式"><a href="#2-2-长选项模式" class="headerlink" title="2.2 长选项模式"></a>2.2 长选项模式</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> getopt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">site</span>():</span><br><span class="line">    name = <span class="literal">None</span></span><br><span class="line">    url = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    argv = sys.argv[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 长选项模式</span></span><br><span class="line">        opts, args = getopt.getopt(argv, <span class="string">&quot;n:u:&quot;</span>, [<span class="string">&quot;name=&quot;</span>, <span class="string">&quot;url=&quot;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Error&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> opt, arg <span class="keyword">in</span> opts:</span><br><span class="line">        <span class="keyword">if</span> opt <span class="keyword">in</span> [<span class="string">&#x27;-n&#x27;</span>, <span class="string">&#x27;--name&#x27;</span>]:</span><br><span class="line">            name = arg</span><br><span class="line">        <span class="keyword">elif</span> opt <span class="keyword">in</span> [<span class="string">&#x27;-u&#x27;</span>, <span class="string">&#x27;--url&#x27;</span>]:</span><br><span class="line">            url = arg</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>( name + <span class="string">&quot; &quot;</span> + url)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">site()</span><br></pre></td></tr></table></figure>

<p>测试代码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 demo.py --name mochazz --url cyberzone.cloud</span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mochazz cyberzone.cloud</span><br></pre></td></tr></table></figure>

<h3 id="3-Exception-getopt-GetoptError"><a href="#3-Exception-getopt-GetoptError" class="headerlink" title="3. Exception getopt.GetoptError"></a>3. Exception getopt.GetoptError</h3><p>在没有找到参数列表，或选项的需要的参数为空时会触发该异常。</p>
<p>异常的参数是一个字符串，表示错误的原因。属性 <strong>msg</strong> 和 <strong>opt</strong> 为相关选项的错误信息。</p>
<h4 id="3-1-示例"><a href="#3-1-示例" class="headerlink" title="3.1 示例"></a>3.1 示例</h4><p>假定创建这样一个脚本，可以通过命令行向脚本文件传递两个文件名，同时通过另外一个选项查看脚本的使用。脚本使用方法如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">demo.py -i &lt;inputfile&gt; -o &lt;outputfile&gt;</span><br></pre></td></tr></table></figure>

<p>demo.py 脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> getopt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">argv</span>):</span><br><span class="line">    inputfile = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    outputfile = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        opts, args = getopt.getopt(argv, <span class="string">&#x27;hi:o:&#x27;</span>, [<span class="string">&#x27;ifile=&#x27;</span>, <span class="string">&#x27;ofile=&#x27;</span>])</span><br><span class="line">    <span class="keyword">except</span> getopt.GetoptError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;demo.py -i &lt;inputfile&gt; -o &lt;outputfile&gt;&#x27;</span>)</span><br><span class="line">        sys.exit(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> opt, arg <span class="keyword">in</span> opts:</span><br><span class="line">        <span class="keyword">if</span> opt == <span class="string">&#x27;-h&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;demo.py -i &lt;inputfile&gt; -o &lt;outputfile&gt;&#x27;</span>)</span><br><span class="line">            sys.exit()</span><br><span class="line">        <span class="keyword">elif</span> opt <span class="keyword">in</span> (<span class="string">&#x27;-i&#x27;</span>, <span class="string">&#x27;--ifile&#x27;</span>):</span><br><span class="line">            inputfile = arg</span><br><span class="line">        <span class="keyword">elif</span> opt <span class="keyword">in</span> (<span class="string">&#x27;-i&#x27;</span>, <span class="string">&#x27;--ofile&#x27;</span>):</span><br><span class="line">            outputfile = arg</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;输出的文件为: <span class="subst">&#123;inputfile&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;输出的文件为: <span class="subst">&#123;outputfile&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main(sys.argv[<span class="number">1</span>:])</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>测试代码</p>
<p><img src="/../img/Python%E5%B8%B8%E7%94%A8%E6%A0%87%E5%87%86%E5%BA%93%E5%AD%A6%E4%B9%A0/image-20230427223651698.png" alt="测试代码"></p>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a target="_blank" rel="noopener" href="https://www.runoob.com/python3/python3-command-line-arguments.html">https://www.runoob.com/python3/python3-command-line-arguments.html</a></p>
<p><a target="_blank" rel="noopener" href="http://www.imooc.com/wiki/pythonlesson2/sysmodule.html">http://www.imooc.com/wiki/pythonlesson2/sysmodule.html</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://suiyideali.github.io/2023/04/23/Go%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0(%E4%BA%8C)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="m0ch4z">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Geek小黑板">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/04/23/Go%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0(%E4%BA%8C)/" class="post-title-link" itemprop="url">Go语言基础学习(二)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-04-23 17:01:54" itemprop="dateCreated datePublished" datetime="2023-04-23T17:01:54+08:00">2023-04-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-04-28 15:02:54" itemprop="dateModified" datetime="2023-04-28T15:02:54+08:00">2023-04-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/code/" itemprop="url" rel="index"><span itemprop="name">code</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Go语言中代替枚举的办法"><a href="#Go语言中代替枚举的办法" class="headerlink" title="Go语言中代替枚举的办法"></a>Go语言中代替枚举的办法</h2><p><strong>枚举类型</strong>用于声明一组命名的常量，当一个变量有几种可能的取值时，可以将它定义为<strong>枚举类型</strong>。在 Go 语言中，并没有提供<strong>枚举类型</strong>，但是枚举类型又是开发过程中非常重要的数据类型。因为它可以事先定义一组<strong>有效的值</strong>，可以有效地防止用户提交无效数据，抽象到业务场景中就是我们平时网页上遇到的<strong>下拉框</strong>，或者我们选择快递地址时的<strong>省市信息</strong>，均为枚举类型的用武之地。所以在 Go 语言中对常量进行了一定的<strong>扩展</strong>，使其可以完美地替代枚举类型。</p>
<h3 id="1-常量中的iota"><a href="#1-常量中的iota" class="headerlink" title="1. 常量中的iota"></a>1. 常量中的iota</h3><p>为了使常量可以更好地替代枚举类型，Go 语言提供了一个<code>iota</code>关键字。使用<code>iota</code>初始化常量，可以生成一组规则类似的常量，但是不用每个常量都写一遍表达式。在一个<code>const()</code>表达式中，从<code>iota</code>开始的常量会被<strong>置为0</strong>，向后每个常量的值为<strong>前一个</strong>常量的值<strong>加一</strong>。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Weekday <span class="type">int</span> <span class="comment">//自定义一个星期类型，作为枚举类型</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	Sun Weekday = <span class="literal">iota</span></span><br><span class="line">	Mon</span><br><span class="line">	Tues</span><br><span class="line">	Wed</span><br><span class="line">	Thur</span><br><span class="line">	Fri</span><br><span class="line">	Sat</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;Sun :&quot;</span>, Sun)</span><br><span class="line">	fmt.Println(<span class="string">&quot;Mon :&quot;</span>, Mon)</span><br><span class="line">	fmt.Println(<span class="string">&quot;Tues:&quot;</span>, Tues)</span><br><span class="line">	fmt.Println(<span class="string">&quot;Wed :&quot;</span>, Wed)</span><br><span class="line">	fmt.Println(<span class="string">&quot;Thur:&quot;</span>, Thur)</span><br><span class="line">	fmt.Println(<span class="string">&quot;Fri :&quot;</span>, Fri)</span><br><span class="line">	fmt.Println(<span class="string">&quot;Sat :&quot;</span>, Sat)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>执行结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Sun : 0</span><br><span class="line">Mon : 1</span><br><span class="line">Tues: 2</span><br><span class="line">Wed : 3</span><br><span class="line">Thur: 4</span><br><span class="line">Fri : 5</span><br><span class="line">Sat : 6</span><br></pre></td></tr></table></figure>

<h3 id="2-将枚举值转换为字符串"><a href="#2-将枚举值转换为字符串" class="headerlink" title="2. 将枚举值转换为字符串"></a>2. 将枚举值转换为字符串</h3><p>使用<code>iota</code>是可以使用 Go 语言的常量代替枚举类型，但是由于输出值均为阿拉伯数字，给调试和辨识造成了一定的困难。为了解决这一问题，Go 语言还提供了使常量枚举值输出为字符串的办法。需要我们手动构造一个使用枚举类型输出字符串的方法。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Weekday <span class="type">int</span> <span class="comment">//自定义一个星期类型，作为枚举类型</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">    Sun Weekday = <span class="literal">iota</span></span><br><span class="line">    Mon</span><br><span class="line">    Tues</span><br><span class="line">    Wed</span><br><span class="line">    Thur</span><br><span class="line">    Fri</span><br><span class="line">    Sat</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(w Weekday)</span></span> String() <span class="type">string</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> w &#123;</span><br><span class="line">    <span class="keyword">case</span> Sun:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Sun&quot;</span></span><br><span class="line">    <span class="keyword">case</span> Mon:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Mon&quot;</span></span><br><span class="line">    <span class="keyword">case</span> Tues:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Tues&quot;</span></span><br><span class="line">    <span class="keyword">case</span> Wed:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Wed&quot;</span></span><br><span class="line">    <span class="keyword">case</span> Thur:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Thur&quot;</span></span><br><span class="line">    <span class="keyword">case</span> Fri:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Fri&quot;</span></span><br><span class="line">    <span class="keyword">case</span> Sat:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Sat&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//不存在的枚举类型就返回&quot;N/A&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;N/A&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;Sun :&quot;</span>, Sun)</span><br><span class="line">    fmt.Println(<span class="string">&quot;Mon :&quot;</span>, Mon)</span><br><span class="line">    fmt.Println(<span class="string">&quot;Tues:&quot;</span>, Tues)</span><br><span class="line">    fmt.Println(<span class="string">&quot;Wed :&quot;</span>, Wed)</span><br><span class="line">    fmt.Println(<span class="string">&quot;Thur:&quot;</span>, Thur)</span><br><span class="line">    fmt.Println(<span class="string">&quot;Fri :&quot;</span>, Fri)</span><br><span class="line">    fmt.Println(<span class="string">&quot;Sat :&quot;</span>, Sat)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Go语言中的运算符"><a href="#Go语言中的运算符" class="headerlink" title="Go语言中的运算符"></a>Go语言中的运算符</h2><h3 id="1-语言的赋值运算符"><a href="#1-语言的赋值运算符" class="headerlink" title="1. 语言的赋值运算符"></a>1. 语言的赋值运算符</h3><p>Go语言赋值运算符如下表所示：</p>
<table>
<thead>
<tr>
<th align="left">运算符</th>
<th align="left">结合性</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">&#x3D;</td>
<td align="left"><strong>从右到左</strong></td>
<td align="left">将左边的实体赋值给右边的变量</td>
</tr>
<tr>
<td align="left">+&#x3D;</td>
<td align="left"><strong>从右到左</strong></td>
<td align="left">将右边的变量与左边的实体进行<strong>加运算之后</strong>赋值给右边的变量</td>
</tr>
<tr>
<td align="left">-&#x3D;</td>
<td align="left"><strong>从右到左</strong></td>
<td align="left">将右边的变量与左边的实体进行<strong>减运算之后</strong>赋值给右边的变量</td>
</tr>
<tr>
<td align="left">*&#x3D;</td>
<td align="left"><strong>从右到左</strong></td>
<td align="left">将右边的变量与左边的实体进行<strong>乘运算之后</strong>赋值给右边的变量</td>
</tr>
<tr>
<td align="left">&#x2F;&#x3D;</td>
<td align="left"><strong>从右到左</strong></td>
<td align="left">将右边的变量与左边的实体进行<strong>除运算之后</strong>赋值给右边的变量</td>
</tr>
<tr>
<td align="left">%&#x3D;</td>
<td align="left"><strong>从右到左</strong></td>
<td align="left">将右边的变量与左边的实体进行<strong>取余运算之后</strong>赋值给右边的变量</td>
</tr>
<tr>
<td align="left">&gt;&gt;&#x3D;</td>
<td align="left"><strong>从右到左</strong></td>
<td align="left">将右边的变量与左边的实体进行<strong>右位移运算之后</strong>赋值给右边的变量</td>
</tr>
<tr>
<td align="left">&lt;&lt;&#x3D;</td>
<td align="left"><strong>从右到左</strong></td>
<td align="left">将右边的变量与左边的实体进行<strong>左位移运算之后</strong>赋值给右边的变量</td>
</tr>
<tr>
<td align="left">&amp;&#x3D;</td>
<td align="left"><strong>从右到左</strong></td>
<td align="left">将右边的变量与左边的实体进行<strong>与运算之后</strong>赋值给右边的变量</td>
</tr>
<tr>
<td align="left">|&#x3D;</td>
<td align="left"><strong>从右到左</strong></td>
<td align="left">将右边的变量与左边的实体进行<strong>或运算之后</strong>赋值给右边的变量</td>
</tr>
<tr>
<td align="left">^&#x3D;</td>
<td align="left"><strong>从右到左</strong></td>
<td align="left">将右边的变量与左边的实体进行<strong>异或运算之后</strong>赋值给右边的变量</td>
</tr>
</tbody></table>
<p>代码示例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">28</span></span><br><span class="line">    <span class="keyword">var</span> b = <span class="number">99</span></span><br><span class="line">    a = b</span><br><span class="line">    fmt.Println(<span class="string">&quot;  a = b :&quot;</span>, a)</span><br><span class="line">    a = <span class="number">28</span></span><br><span class="line">    a += b</span><br><span class="line">    fmt.Println(<span class="string">&quot; a += b :&quot;</span>, a)</span><br><span class="line">    a = <span class="number">28</span></span><br><span class="line">    a -= b</span><br><span class="line">    fmt.Println(<span class="string">&quot; a -= b :&quot;</span>, a)</span><br><span class="line">    a = <span class="number">28</span></span><br><span class="line">    a *= b</span><br><span class="line">    fmt.Println(<span class="string">&quot; a *= b :&quot;</span>, a)</span><br><span class="line">    a = <span class="number">28</span></span><br><span class="line">    a /= <span class="number">2</span></span><br><span class="line">    fmt.Println(<span class="string">&quot; a /= 2 :&quot;</span>, a)</span><br><span class="line">    a = <span class="number">28</span></span><br><span class="line">    b %= <span class="number">1</span></span><br><span class="line">    fmt.Println(<span class="string">&quot; b %= 1 :&quot;</span>, a)</span><br><span class="line">    a = <span class="number">28</span></span><br><span class="line">    a &amp;= b</span><br><span class="line">    fmt.Println(<span class="string">&quot; a &amp;= b :&quot;</span>, a)</span><br><span class="line">    a = <span class="number">28</span></span><br><span class="line">    a |= b</span><br><span class="line">    fmt.Println(<span class="string">&quot; a |= b :&quot;</span>, a)</span><br><span class="line">    a = <span class="number">28</span></span><br><span class="line">    a ^= b</span><br><span class="line">    fmt.Println(<span class="string">&quot; a ^= b :&quot;</span>, a)</span><br><span class="line">    a = <span class="number">28</span></span><br><span class="line">    a &gt;&gt;= <span class="number">2</span></span><br><span class="line">    fmt.Println(<span class="string">&quot;a &gt;&gt;= 2 :&quot;</span>, a)</span><br><span class="line">    a = <span class="number">28</span></span><br><span class="line">    b &lt;&lt;= <span class="number">1</span></span><br><span class="line">    fmt.Println(<span class="string">&quot;b &lt;&lt;= 1 :&quot;</span>, a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-优先级"><a href="#2-优先级" class="headerlink" title="2. 优先级"></a>2. 优先级</h3><p>下表为各运算符的优先级示图，优先级<strong>从高到低</strong>：</p>
<table>
<thead>
<tr>
<th align="left">优先级</th>
<th align="left">类别</th>
<th align="left">运算符</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left">括号运算符</td>
<td align="left">()</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">单目运算符</td>
<td align="left">！、++、–</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">算数运算符</td>
<td align="left">*、&#x2F;、%</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">+、-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">位移运算符</td>
<td align="left">&gt;&gt;、&lt;&lt;</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left">关系运算符</td>
<td align="left">&lt;、&lt;&#x3D;、&gt;、&gt;&#x3D;</td>
</tr>
<tr>
<td align="left">7</td>
<td align="left">&#x3D;&#x3D;、!&#x3D;</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">8</td>
<td align="left">按位与</td>
<td align="left">&amp;</td>
</tr>
<tr>
<td align="left">9</td>
<td align="left">按位异或</td>
<td align="left">^</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left">按位或</td>
<td align="left">|</td>
</tr>
<tr>
<td align="left">11</td>
<td align="left">逻辑与</td>
<td align="left">&amp;&amp;</td>
</tr>
<tr>
<td align="left">12</td>
<td align="left">逻辑或</td>
<td align="left">||</td>
</tr>
<tr>
<td align="left">13</td>
<td align="left">赋值运算符</td>
<td align="left">&#x3D;、+&#x3D;、-&#x3D;、*&#x3D;、&#x2F;&#x3D;、 %&#x3D;、 &gt;&#x3D;、 &lt;&lt;&#x3D;、&amp;&#x3D;、^&#x3D;、|&#x3D;</td>
</tr>
</tbody></table>
<h2 id="Go语言的分支语句"><a href="#Go语言的分支语句" class="headerlink" title="Go语言的分支语句"></a>Go语言的分支语句</h2><h3 id="1-If…else"><a href="#1-If…else" class="headerlink" title="1. If…else"></a>1. If…else</h3><p>在 Go 语言中 <strong>if</strong> 关键字的作用和其它大部分语言相同，是用于测试某个布尔表达式或布尔值是否为真的。若为真则执行 if 之后 <code>&#123;&#125;</code> 中的语句，否则跳过这些语句。如果存在第二个分支，则需要使用 <strong>else</strong> 关键字，还需要增加分支的话就需要使用 <strong>else if</strong> 关键字了。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	a := <span class="number">10</span></span><br><span class="line">	<span class="keyword">if</span> a &gt; <span class="number">10</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;a大于10&quot;</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> a &lt; <span class="number">0</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;a小于0&quot;</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;a的值是&quot;</span>, a)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在 Go 语言中，<strong>if</strong> 后的条件表达式，还有一种特别的写法，可以在条件表达式之前写一个赋值表达式。</p>
<p><strong>if…else</strong> 的特殊用法：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> a := <span class="number">10</span>; a &gt; <span class="number">10</span> &#123; <span class="comment">//赋值表达式和条件表达式之间用;隔开</span></span><br><span class="line">		fmt.Println(<span class="string">&quot;a大于10&quot;</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;a的值是&quot;</span>, a)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-switch…case"><a href="#2-switch…case" class="headerlink" title="2. switch…case"></a>2. switch…case</h3><p>Go 语言对 <strong>switch…case</strong> 的功能进行了扩展，它变得更加的通用。<strong>switch</strong> 之后可以什么都不带。<strong>case</strong>也无需是一个固定值，也可以是一个布尔表达式，而且每一个 case 都是一个 <strong>独立的代码块</strong>，执行完了之后<strong>立刻跳出</strong> switch，不需要使用 <strong>break</strong>。所以可以把 <strong>if…else</strong> 完美的改写成 <strong>switch…case</strong> 的形式。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	a := <span class="string">&quot;A&quot;</span></span><br><span class="line">	<span class="keyword">switch</span> a &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">&quot;A&quot;</span>, <span class="string">&quot;a&quot;</span>:</span><br><span class="line">		fmt.Println(<span class="string">&quot;分数区间为90~100&quot;</span>)</span><br><span class="line">	<span class="keyword">case</span> <span class="string">&quot;B&quot;</span>, <span class="string">&quot;b&quot;</span>:</span><br><span class="line">		fmt.Println(<span class="string">&quot;分数区间为70～89&quot;</span>)</span><br><span class="line">	<span class="keyword">case</span> <span class="string">&quot;C&quot;</span>, <span class="string">&quot;c&quot;</span>:</span><br><span class="line">		fmt.Println(<span class="string">&quot;分数区间为0~70&quot;</span>)</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Println(<span class="string">&quot;错误的评分&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>switch…case</strong> Go 语言中的新用法：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	a := <span class="number">50</span></span><br><span class="line">	<span class="keyword">switch</span> &#123;</span><br><span class="line">	<span class="keyword">case</span> a &lt; <span class="number">60</span>:</span><br><span class="line">		fmt.Println(<span class="string">&quot;不及格&quot;</span>)</span><br><span class="line">	<span class="keyword">case</span> a &lt; <span class="number">80</span>:</span><br><span class="line">		fmt.Println(<span class="string">&quot;良好&quot;</span>)</span><br><span class="line">	<span class="keyword">case</span> a &lt;= <span class="number">100</span>:</span><br><span class="line">		fmt.Println(<span class="string">&quot;优秀&quot;</span>)</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Println(<span class="string">&quot;分数最多为100分&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Go语言的循环语句"><a href="#Go语言的循环语句" class="headerlink" title="Go语言的循环语句"></a>Go语言的循环语句</h2><p>在 Go 语言中减少了循环语句的关键字，仅有一个 <strong>for</strong> 关键字。但是并没有减少其功能，而且它更是兼容了其它语言中的<strong>while</strong>关键字的用法，甚至更强大。</p>
<h3 id="1-for循环语句"><a href="#1-for循环语句" class="headerlink" title="1. for循环语句"></a>1. for循环语句</h3><h4 id="1-1-普通用法"><a href="#1-1-普通用法" class="headerlink" title="1.1 普通用法"></a>1.1 普通用法</h4><p>在 Go 语言中，for 循环之后一样可以跟三个语句</p>
<p><strong>单次表达式；条件表达式；末尾循环体</strong></p>
<p>但是它不需要使用<code>()</code>来包裹这三个表达式，写法上更加的简洁。同时它也和其它语言一样，可以任意省略这三个表达式。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> a := <span class="number">0</span>; a &lt; <span class="number">10</span>; a++ &#123;</span><br><span class="line">		fmt.Println(a)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>省略<strong>单次表达式</strong>代码</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   a := <span class="number">0</span></span><br><span class="line">   <span class="keyword">for</span> ; a &lt; <span class="number">10</span>; a++ &#123; <span class="comment">//表达式可以省略，但是;不能省略</span></span><br><span class="line">      fmt.Println(a)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-代替-while-的用法"><a href="#1-2-代替-while-的用法" class="headerlink" title="1.2 代替 while 的用法"></a>1.2 代替 while 的用法</h4><p>在其它大部分语言中 <strong>for</strong> 循环中省略<strong>单次表达式</strong>和<strong>末尾循环体</strong>其实就和其它语句中的 <strong>while</strong> 用法一致了。所以在 Go 语言中，直接使用省去<strong>单次表达式</strong>和<strong>末尾循环体</strong>的 <strong>for</strong> 循环语句来代替 <strong>while</strong> 的用法，为了简便代码书写，Go 语言中 for 循环语句在省去<strong>单次表达式</strong>和<strong>末尾循环体</strong>时，可以不写分号。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	a := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> a &lt; <span class="number">10</span> &#123; <span class="comment">//和其他语言中的while(a&lt;10)一致</span></span><br><span class="line">		fmt.Println(a)</span><br><span class="line">		a++</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-for-语言中的break-和-continue"><a href="#2-for-语言中的break-和-continue" class="headerlink" title="2. for 语言中的break 和 continue"></a>2. for 语言中的break 和 continue</h3><p>在我们的生产环境中，经常需要用到死循环的场景。所以在 Go 语言中新增了一个 <strong>for</strong> 关键字死循环的用法，让程序员不用写无聊的 <code>for(;;)&#123;&#125;</code>和<code>do&#123;&#125; while(1)</code>。同时可以使用 <strong>break</strong> 和 <strong>continue</strong> 来控制循环。</p>
<p><strong>break</strong> 和 <strong>continue</strong> 的逻辑和语法类似</p>
<h4 id="2-1-break跳出单层死循环"><a href="#2-1-break跳出单层死循环" class="headerlink" title="2.1  break跳出单层死循环"></a>2.1  break跳出单层死循环</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   a := <span class="number">0</span></span><br><span class="line">   <span class="keyword">for</span> &#123; <span class="comment">//死循环的写法就是省略 单次表达式; 条件表达式; 末尾循环体</span></span><br><span class="line">      fmt.Println(a)</span><br><span class="line">      a++</span><br><span class="line">      <span class="keyword">if</span> a &gt;= <span class="number">10</span> &#123;</span><br><span class="line">         <span class="keyword">break</span> <span class="comment">//跳出死循环</span></span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-break跳出多层死循环"><a href="#2-2-break跳出多层死循环" class="headerlink" title="2.2 break跳出多层死循环"></a>2.2 break跳出多层死循环</h4><p>在其它语言中，你很难去控制跳出循环的层数，在 Go 语言中提供了一种<code>break LOOP</code>的写法，可以使循环跳出到 LOOP 所在的位置。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   a := <span class="number">0</span></span><br><span class="line">LOOP:</span><br><span class="line">   <span class="keyword">for</span> &#123;</span><br><span class="line">      <span class="keyword">for</span> &#123;</span><br><span class="line">         fmt.Println(a)</span><br><span class="line">         a++</span><br><span class="line">         <span class="keyword">if</span> a &gt;= <span class="number">10</span> &#123;</span><br><span class="line">            <span class="keyword">break</span> LOOP <span class="comment">//跳出循环至LOOP所在的层级</span></span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Go语言的通道"><a href="#Go语言的通道" class="headerlink" title="Go语言的通道"></a>Go语言的通道</h2><p>Go 语言中有一个特殊的类型 <code>chan</code>，这是在 Go 语言的多线程操作中非常重要的一个数据类型。它的一般用于<strong>线程之间的数据传输</strong>，所以这个操作类型叫做 “ <strong>通道 (channel)</strong>“。</p>
<h3 id="1-通道的声明和定义"><a href="#1-通道的声明和定义" class="headerlink" title="1. 通道的声明和定义"></a>1. 通道的声明和定义</h3><p>通道可以理解为一种特殊的<strong>变量</strong>，所以它的声明和其它变量的声明并没有太大的区别，声明通道变量的写法如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> c <span class="keyword">chan</span> <span class="type">int</span> <span class="comment">//声明一个存放int类型数据的通道</span></span><br></pre></td></tr></table></figure>

<p>但是它声明之后并<strong>不能直接使用</strong>，需要使用内置函数 <code>make()</code> 来创建一下通道变量才可以使用：</p>
<blockquote>
<p>由于 chan 的底层是一个指针，在 Go 语言中指针初始值为空，是需要实例化的。make 就是实例化了 chan。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> c <span class="keyword">chan</span> <span class="type">int</span> <span class="comment">//声明一个存放int类型数据的通道</span></span><br><span class="line">c = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">1</span>) <span class="comment">//创建一个长度为1的通道</span></span><br></pre></td></tr></table></figure>

<p>在这种情况下最好使用<code>:=</code> 来同时声明和创建：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">1</span>) <span class="comment">//声明并创建一个存放int类型数据的通道</span></span><br></pre></td></tr></table></figure>

<h3 id="2-通道的使用"><a href="#2-通道的使用" class="headerlink" title="2. 通道的使用"></a>2. 通道的使用</h3><p>在 Go 语言中，使用 <code>&lt;-</code> 符号来向通道中塞取数据。放在通道右边 <code>chan &lt;-</code>，就是塞数据，放在通道左边 <code>&lt;- chan</code> ，就是取数据。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   c := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">1</span>)</span><br><span class="line">   c &lt;- <span class="number">10</span>  <span class="comment">//将10塞入通道中</span></span><br><span class="line">   i := &lt;-c <span class="comment">//将10从通道中取出，并赋值给变量i</span></span><br><span class="line">   fmt.Println(i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-通道结合-select-流程控制"><a href="#3-通道结合-select-流程控制" class="headerlink" title="3. 通道结合 select 流程控制"></a>3. 通道结合 select 流程控制</h3><p>在 Go 语言中为了更方便的利用通道的功能，提供了一个仅用于通道的流程控制语句：<code>select...case</code>。使用这个语句可以同时监听数个通道，非常适合用于并发时的进程调度，或者模块之间的解耦合。下面通过一个简单的例子来了解一下 <code>select...case</code> 语句。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   c := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">   <span class="keyword">for</span> a := <span class="number">0</span>; a &lt; <span class="number">2</span>; a++ &#123;</span><br><span class="line">      <span class="keyword">select</span> &#123;</span><br><span class="line">      <span class="keyword">case</span> i := &lt;-c:</span><br><span class="line">         fmt.Println(<span class="string">&quot;从通道中取出&quot;</span>, i)</span><br><span class="line">      <span class="keyword">case</span> c &lt;- <span class="number">10</span>:</span><br><span class="line">         fmt.Println(<span class="string">&quot;将 10 塞入通道中&quot;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>select 语句和 switch 语句一样，case 都只会执行一个，然后立刻跳出语句。</p>
<h2 id="Go语言函数的返回值"><a href="#Go语言函数的返回值" class="headerlink" title="Go语言函数的返回值"></a>Go语言函数的返回值</h2><p>Go 语言的函数的返回值也有些特殊，它可以一次返回<strong>多个返回值，</strong>Go 语言中如果是单返回值，可以直接在函数声明的括号后面增加数据类型，代码示例如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Sum</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span> <span class="comment">//声明并定义一个返回值为int数据类型的函数</span></span><br></pre></td></tr></table></figure>

<p>如果要返回多个返回值，则需要用括号包裹返回值，并使用<code>,</code>隔开所有返回值，代码示例如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Sum</span><span class="params">(a, b <span class="type">int</span>)</span></span> (<span class="type">int</span>,<span class="type">string</span>) <span class="comment">//声明并定义一个返回值为int和string数据类型的函数</span></span><br></pre></td></tr></table></figure>

<p>返回的方式有两种。一种是用 <strong>return</strong> 关键字加返回值直接返回，一种是<strong>声明返回值变量</strong>，使用返回值变量直接返回。</p>
<h3 id="1-使用-return-返回值返回"><a href="#1-使用-return-返回值返回" class="headerlink" title="1. 使用 return+ 返回值返回"></a>1. 使用 return+ 返回值返回</h3><p>Go 语言可以一次返回多个值，多个值直接跟在 <strong>return</strong> 关键字之后，使用<code>,</code>隔开即可。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SumAndProduct</span><span class="params">(a, b <span class="type">int</span>)</span></span> (<span class="type">int</span>, <span class="type">int</span>) &#123;</span><br><span class="line">	c := a + b</span><br><span class="line">	d := a * b</span><br><span class="line">	<span class="keyword">return</span> c, d <span class="comment">// 同时返回c和d两个变量</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	sum, product := SumAndProduct(<span class="number">1</span>, <span class="number">2</span>) <span class="comment">//接受多返回的函数时，也需要用逗号隔开变量</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;a + b =&quot;</span>, sum)</span><br><span class="line">	fmt.Println(<span class="string">&quot;a * b =&quot;</span>, product)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-使用返回值变量返回"><a href="#2-使用返回值变量返回" class="headerlink" title="2. 使用返回值变量返回"></a>2. 使用返回值变量返回</h3><p>Go 语言还能直接在返回值处声明变量，这个变量的作用域是整个函数，并且会在 <strong>return</strong> 的时候直接返回。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SumAndProduct</span><span class="params">(a, b <span class="type">int</span>)</span></span> (c <span class="type">int</span>, d <span class="type">int</span>) &#123;</span><br><span class="line">	c = a + b <span class="comment">//因为c和d函数返回值处已经定义了，可以直接使用</span></span><br><span class="line">	d = a * b</span><br><span class="line">	<span class="keyword">return</span> <span class="comment">// 直接返回，c和d自动传出去</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	sum, product := SumAndProduct(<span class="number">1</span>, <span class="number">2</span>) <span class="comment">//接受多返回的函数时，也需要用逗号隔开变量</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;a + b =&quot;</span>, sum)</span><br><span class="line">	fmt.Println(<span class="string">&quot;a * b =&quot;</span>, product)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Go语言函数的-defer"><a href="#Go语言函数的-defer" class="headerlink" title="Go语言函数的 defer"></a>Go语言函数的 defer</h2><p>在 Go 语言中的 <strong>defer</strong> 关键字就是 Go 语言中延迟语句的标志。Go 语言会在函数<strong>即将返回时</strong>按<strong>逆序</strong>执行 <strong>defer</strong> 后的语句。也就是说先被 <strong>defer</strong> 的语句后执行，最先执行最后被 <strong>defer</strong> 的语句。<strong>defer</strong> 和有些语言中的 finally 语句块的用法类似，一般都用于释放一些资源，最常用的地方就是进程锁的释放。</p>
<h3 id="1-defer-的逆序执行"><a href="#1-defer-的逆序执行" class="headerlink" title="1. defer 的逆序执行"></a>1. defer 的逆序执行</h3><p><strong>defer</strong> 会在函数即将结束的时候执行，而且是按照 <strong>defer</strong> 的顺序<strong>逆序</strong>执行。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="string">&quot;第一个defer的语句&quot;</span>)</span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="string">&quot;第二个defer的语句&quot;</span>)</span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="string">&quot;第三个defer的语句&quot;</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;Hello Go&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>结果输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Hello Go</span><br><span class="line">第三个defer的语句</span><br><span class="line">第二个defer的语句</span><br><span class="line">第一个defer的语句</span><br></pre></td></tr></table></figure>

<h3 id="2-defer-中的变量"><a href="#2-defer-中的变量" class="headerlink" title="2. defer 中的变量"></a>2. defer 中的变量</h3><p><strong>defer</strong> 关键字之后若有变量，则 <strong>defer</strong> 记录的是在 <strong>defer</strong> <strong>时的变量值</strong>，而不是最后函数结束时的变量值。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	a := <span class="number">10</span></span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="string">&quot;defer时a的值为&quot;</span>, a)</span><br><span class="line">	a = <span class="number">100</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;print是a的值为&quot;</span>, a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print是a的值为 100</span><br><span class="line">defer时a的值为 10</span><br></pre></td></tr></table></figure>

<h3 id="3-总结"><a href="#3-总结" class="headerlink" title="3. 总结"></a>3. 总结</h3><ul>
<li><p><strong>defer</strong> 是<strong>先声明后执行</strong>的语句模式；</p>
</li>
<li><p><strong>defer</strong> 会在函数<strong>即将结束</strong>的时候统一执行；</p>
</li>
<li><p><strong>defer</strong> 中的变量值<strong>不会</strong>被 <strong>defer</strong> 之后的语句改变。</p>
</li>
</ul>
<h2 id="Go语言中的闭包"><a href="#Go语言中的闭包" class="headerlink" title="Go语言中的闭包"></a>Go语言中的闭包</h2><p> Go 语言的闭包就是一个引用了<strong>外部自由变量</strong>的<strong>匿名函数</strong>，被引用的自由变量和该匿名函数共同存在，不会因为离开了外部环境就被<strong>释放或者删除</strong>，还可以在这个匿名函数中继续使用。</p>
<h3 id="1-Go语言的匿名函数"><a href="#1-Go语言的匿名函数" class="headerlink" title="1. Go语言的匿名函数"></a>1. Go语言的匿名函数</h3><p><strong>匿名函数</strong>，顾名思义，就是隐藏函数名的函数。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个函数类型，值为一个匿名函数的变量；</span></span><br><span class="line"><span class="keyword">var</span> f = <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;匿名函数作为变量来使用&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	f() <span class="comment">// 使用这个匿名函数</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 定义一个匿名函数。在这个函数后加上()，就可以直接使用这个匿名函数。</span></span><br><span class="line">	<span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;匿名函数直接使用&quot;</span>) </span><br><span class="line">	&#125;()</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">匿名函数作为变量来使用</span><br><span class="line">匿名函数直接使用</span><br></pre></td></tr></table></figure>

<h3 id="2-匿名函数引用外部变量"><a href="#2-匿名函数引用外部变量" class="headerlink" title="2. 匿名函数引用外部变量"></a>2. 匿名函数引用外部变量</h3><p>如果在匿名函数内，使用了<strong>外部环境的变量</strong>，就构成了一个闭包。即一个函数内，使用匿名函数来操作函数内声明的变量。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	str := <span class="string">&quot;Hello Golang!&quot;</span></span><br><span class="line">	<span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		str = <span class="string">&quot;Hello Go!&quot;</span> <span class="comment">// 匿名函数直接操作了main函数之中的变量str</span></span><br><span class="line">	&#125;()</span><br><span class="line">	fmt.Println(str)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello Go!</span><br></pre></td></tr></table></figure>

<p>上述例子简单的构造了一个闭包，在匿名函数中并没有声明或者定义str这个变量，但是可以直接操作，引用可main函数中的自由变量。</p>
<p>使用defer和闭包相结合，深入了解一下闭包中的引用外部变量。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	str := <span class="string">&quot;Hello Golang!&quot;</span></span><br><span class="line">	<span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;defer str=&quot;</span>, str)</span><br><span class="line">	&#125;()</span><br><span class="line">	str = <span class="string">&quot;Hello Go!&quot;</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;main str=&quot;</span>, str)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">main str= Hello Go!</span><br><span class="line">defer str= Hello Go!</span><br></pre></td></tr></table></figure>

<p>学习defer的时候有了解到 defer 后变量是保留它在 defer 时的值，而不会被 defer 之后的代码改变，但是在这闭包的情况下，看起来defer的值已经被改变了，其实原因是闭包是 <strong>引用</strong>了这个变量，即 defer 时被保留下来的是这个 <strong>变量的地址</strong> ，后续代码改变的不是地址，而是这个地址存储的值，所以后续代码对这个变量的操作，都会反应到defer中。</p>
<h3 id="3-总结-1"><a href="#3-总结-1" class="headerlink" title="3. 总结"></a>3. 总结</h3><ul>
<li>闭包就是匿名函数<strong>引用外部变量</strong></li>
<li>闭包中引用的变量会<strong>被外部环境改变</strong>，同时闭包内对变量的改变<strong>也会影响到外部环境</strong>的使用</li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a target="_blank" rel="noopener" href="http://www.imooc.com/wiki/golesson/">http://www.imooc.com/wiki/golesson/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">m0ch4z</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">24</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">m0ch4z</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
